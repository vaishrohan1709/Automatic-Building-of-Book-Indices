 Given a free group of finite rank a emp hfree splitting  over is a minimal  simplicial action of the group on a simplicial tree such that the stabilizer of each edge of is the trivial subgroup of  A free splitting is denoted or just when the group and its action are understood  Although the tree is allowed to have vertices of valence there is a unique natural cell structure on the vertices of which are the points of valence  We say that is a -edge free splitting if is the number of natural edge orbits  a number which can take on any value from to  The equivalence relation amongst free splittings is emp hconjugacy   where two free splittings of are conjugate if there exists an -equivariant homeomorphism between them  See the beginning of Section SectionFreeSplittingComplex for the details of these definitions  The free splitting complex of denoted is a simplicial complex of dimension having a simplex of dimension for each conjugacy class of -edge free splittings  Given another free splitting the simplex is a face of if and only if there is a collapse map  map collapse  which collapses to a point each edge in some -invariant set of edges of  We write for the relation    collapses to     and for the inverse relation    expands to     There is a natural left action of the outer automorphism group on where acts on the conjugacy class of a free splitting by precomposing the action by an automorphism of representing  The free splitting complex was introduced by Hatcher in Hatcher HomStability in its role as the sphere complex of a connected sum of copies of the 3-manifold  A careful construction of an isomorphism between the  n b1 skeletons of and Hatcher s sphere complex can be found in AramayonSouto FreeSplittings and that proof extends with little trouble to the entire complexes  In Section SectionFSInTermsOfCollapsing we shall give a rigorous construction of the free splitting complex given purely in tree language  The complex is regarded as one of several analogues of the curve complex of a surface --- another competing analogue is the free factor complex of introduced by Hatcher and Vogtmann in HatcherVogtmann FreeFactors  The analogies are imperfect in each case  Hatcher and Vogtmann showed that the free factor complex  like the curve complex  has the homotopy type of a wedge of spheres of constant dimension HatcherVogtmann FreeFactors   by contrast  Hatcher showed that is contractible Hatcher HomStability  On the other hand we showed in HandelMosher distortion that simplex stabilizers of are all undistorted subgroups of just as simplex stabilizers of the curve complex of a surface are undistorted subgroups of its mapping class group  by constrast  we also showed that the simplex stabilizers of the free factor complex of are  most of them  distorted in  skip Here is our main result  an analogue to the theorem of Masur and Minsky MasurMinsky complex1 on the hyperbolicity of the curve complex  The free splitting complex with its geodesic simplicial metric  is Gromov hyperbolic  By comparison Bestvina and Feighn have proved that the free factor complex is Gromov hyperbolic BestvinaFeighn FFCHyp  In rank the Main Theorem is well known  because the simplicial complex contains the Farey graph as a coarsely dense subcomplex  and the Farey graph is quasi-isometric to an -tree and is therefore Gromov hyperbolic  see e g   Example 5 2 of Manning pseudocharacters  One should contrast the Main Theorem with the result of Sabalka and Savchuk SabalkaSavchuk NotHyperbolic which says that the   edge splitting graph   of is not hyperbolic --- this is the  n b1 dimensional subcomplex of spanned by the -simplices corresponding to those -edge free splittings that have vertex orbits  Their result has an analogue in a theorem of Schleimer Schleimer CurveComplexNotes that on a closed  oriented surface of genus the subcomplex of the curve complex spanned by separating curves is not hyperbolic  skip In Part II of this work we shall determine the dynamics of the action of elements of on showing in particular that acts loxodromically on if and only if  in the terminology and notation of  BookOne  there exists an element of the set of attracting laminations such that the free factor support of is the whole group  skip
Outline of the proof
 Outside of applying the hyperbolicity axioms of Masur and Minsky our methods of proof  although intricate  are mostly self contained  depending on basic tools from the theory of group actions on trees including Bass-Serre theory and Stallings folds  Beyond the methods there are important motivations coming from the proof of Masur and Minsky  in particular the definition of the projection maps that play a role in verifying the Masur--Minsky axioms   subparagrap hSection SectionFreeSplittingComplex   We give the basic concepts underlying the construction of the free splitting complex including definitions of collapse maps  and Lemma LemmaFSSimplices which contains the technical results about free splittings that are needed to verify that is  indeed  a simplicial complex  The proof of that lemma is given in Section SectionFSSimplicesProof  Collapse maps are also needed to understand the first barycentric subdivision which is what we actually use in our proof of hyperbolicity  In brief  has a vertex for each conjugacy class of free splitting and an oriented edge for each collapse relation  Since the composition of two collapse maps is a collapse map  the collapse relation is transitive  from which it follows that each geodesic in the  n b1 skeleton of is a   zig-zag path   that alternates between collapses and expansions   subparagrap hSections SectionFoldPaths and SectionMasurMinsky   Following Stallings method Stallings folding as extended by Bestvina and Feighn BestvinaFeighn bounding we define a system of paths in called fold paths  We also review the criterion for hyperbolicity due to Masur and Minsky MasurMinsky complex1 which is concerned with familes of paths and projection maps to those paths that satisfy certain axioms  which we refer to as the Coarse Retraction Coarse Lipschitz and Strong Projection axioms  The first step of progress on the Main Theorem is the statement of Proposition PropFoldContractions which asserts the existence of a system of projection maps  one such map from the ambient space to each fold path  that satisfy the Masur-Minsky axioms   subparagrap hSection SectionCombing   We introduce the concept of combing of fold paths  The combing process has as input a fold path plus a single edge in with one endpoint and opposite endpoint denoted which can be either a collapse or an expand  The output is a fold path  roughly speaking  from some to which stays a uniformly bounded distance from the input path  and which has the following rather strong asynchronous fellow traveller property  every free splitting along the input fold path from to is connected by a single edge to some free splitting along the output path from to  The result of the combing process is a combing rectangle the general form of which is depicted in Figure FigureCombingRectangle  These rectangles are certain commutative diagrams of fold maps and collapse maps that can be viewed as living in the  n b1 skeleton of  We use many such diagrams throughout the paper  both as formal tools and as visualization aids  Section SectionCombingRectangles contains basic definitions and properties regarding combing rectangles  In this section we also take the next step of progress in the proof of the Main Theorem  by using combing to define the system of projections maps to fold paths  and we state Proposition PropProjToFoldPath which asserts that these particular projection maps satisfy the Mazur Minsky axioms  Section SectionCombingConstructions contains the statements and proofs of various useful constructions of combing rectangles   subparagrap hSection SectionFSU   We introduce free splitting units as a way of subdividing a fold path into subpaths each of which has uniformly bounded diameter in  see Proposition LemmaUnitsLipschitz  but which nevertheless measure progress through  as stated later in Proposition PropFoldPathQuasis  Section SectionDiamBounds contains important diameter bounds for subsegments of fold paths  Section SectionFSUDefsPropsApps uses these diameter bounds to formulate the definition of free splitting units  Once they are defined  we are able to use the diameter bounds to quickly verify the Coarse Retraction axiom  see Proposition PropCoarseRetract   subparagrap hSection SectionMainProof   We verify the Coarse Lipschitz and Strong Projection axioms  completing the proof of the Main Theorem  In this section we also verify that when a fold path is parameterized by free splitting units it becomes a quasigeodesic in   see Proposition PropFoldPathQuasis  See the beginning of Section SectionMainProof for a sketch of the proof of the Main Theorem 
The free splitting complex
 We begin with some basic notations used throughout the paper  For the rest of the paper we shall fix a free group of finite rank  A graph is a 1-dimensional simplicial complex equipped with the CW topology  A tree is a contractible graph  Simplicial maps between graphs and trees are maps taking each vertex to a vertex  and taking each edge to a vertex or to another edge preserving barycentric coordinates  We use to denote an action of a group on which by definition is a homomorphism from to the group of simplicial automorphisms of  The action associates to each a simplicial automorphism of denoted a notation that extends to subsets of by  The stabilizer of a subset is the subgroup  Given two actions a function is said to be equivariant if for all  Given a set and a subset we denote the set theoretic complement as  Given a graph and a subgraph we denote the graph theoretic complement as whose topological description is the closure of
Free splittings  maps  natural vertices and edges  edgelets
 Recall from the introduction that a free splitting of  free splitting  is an action where is a tree that is not a point  the action is minimal meaning that there is no proper -invariant subtree  and for every edge the subgroup is trivial  We use without comment the basic fact that every homeomorphism of a tree either fixes a point or translates along a properly embedded copy of called its axis and that minimality of an action is equivalent to the statement that is the union of the axes of the elements of that have no fixed point in  We also use without comment the fact that every free splitting is cocompact  that is  there is a finite number of orbits of vertices and of edges  this follows from Bass-Serre theory ScottWall combined with the fact that the rank of is finite  Given a free splitting from Bass-Serre theory ScottWall it follows that the set of conjugacy classes in of nontrivial vertex stabilizers of forms a free factor system in the sense of  BookOne  which means that by appropriate choice of representatives of each conjugacy class --- where are the corresponding vertex orbit representatives --- there exists a free factorization of the form with possibly trivial  We refer to this free factor system as the vertex group system of and denote it  Notice that a free splitting is properly discontinuous if and only if if and only if every vertex has finite valence   Maps between free splittings  Given free splittings a emp hmap  from to is defined to be an -equivariant simplicial map  We will encounter several different kinds of maps  most commonly   collapse maps   defined in Section SectionCollapseMaps   foldable maps   defined in Section SectionFoldableMaps and   folds   defined in Section SectionFoldFactorizations  The category of maps will usually suffice for much of this paper  but we will occasionally have to consider more general equivariant continuous functions between free splittings  for example conjugacies  We will sometimes emphasize the role of the action of by referring to a   free splitting over    or a   map over     and we shall use similar terminology for more complicated objects introduced later on that are built out of free splittings and maps over  Recall from the introduction that a emp hconjugacy  between free splittings is an equivariant homeomorphism between and  A conjugacy need not be a map as just defined  i e   it need not take vertices to vertices or edges to edges  and even if it does it need not preserve barycentric coordinates  Notice that if one is given a map as just defined --- an equivariant simplicial map --- then is a conjugacy if and only if it is locally injective  for if is locally injective then it is evidently injective  and it is surjective by minimality of the action and so is a simplicial isomorphism and hence a homeomorphism  Given a free splitting recall also from the introduction the emp hnatural cell structure  on a CW structure whose -skeleton is the set of natural vertices which are the vertices of valence  Implicit in the definition of the natural cell structure is the fact that each point of which is not a natural vertex is contained in the interior of a unique natural edge which is an arc of each of whose endpoints is a natural vertex and none of whose interior points is a natural vertex  If this fact were not true then would contain a valence vertex  violating minimality  or would contain arbitrarily long simplicial arcs with no natural vertices  In the latter case  by cocompactness it would follow that is homeomorphic to a line  but then either the action would be properly discontinuous implying that has rank which is a contradiction  or the kernel of the action would be a free factor of corank contradicting that edge stabilizers are trivial  We have also defined the notion of a -edge free splitting meaning that has orbits of natural edges  this notion is invariant under conjugacy  In terms of Bass-Serre theory ScottWall the number of orbits of natural vertices of a free splitting equals the number of points in the quotient graph of groups which either have a nontrivial group or have valence  The word   natural   in this context refers to naturality in the category of free splittings and conjugacies  every conjugacy is an automorphism of the natural cell structure  and in particular preserves the numbers of orbits of natural vertices and edges  On this basis one might have wished to refer to a valence vertex as   natural    were it not for the fact that has no vertices of valence by virtue of minimality of the action
Remark on terminology 
 Outside of discussions involving natural cell structures and nonsimplicial conjugacies  we work primarily in the simplicial category  a free splitting comes equipped with a simplicial structure on the tree which is invariant under the action of   maps between free splittings are -equivariant simplicial maps  This will be particularly convenient when we encounter subcomplexes of the simplicial structure which are not subcomplexes of the natural cell structure  for example in the results of Sections SectionPushingDownPeaks and SectionProofFSUContraction where the heart of the proof of the Main Theorem resides  For any free splitting in order to distinguish between the natural edges of and the edges of the given simplicial structure on we shall refer to the latter as the edgelets  edgelet  of  This word is meant to evoke the phenomenon that  fairly often  there are many  many  many edgelets in a single natural edge  and we often visualize the edgelets as being very  very  very tiny 
Collapse maps 
 In order to define the free splitting complex of rigorously we need some preliminaries regarding collapse maps  Given two free splittings a map is called a collapse map  map collapse   collapse  if is injective over the interior of each edgelet of  The collapsed subgraph is the -equivariant subgraph which is the union of those edgelets of which are collapsed to a vertex by the map  We put into the notation by writing the square brackets highlighting that is the name of the collapsed graph  whereas the notation tells us the name of the collapse map itself  Note that is a proper subgraph  meaning that  Here are some basic facts about collapse maps  Items  pre fItemCollapseComponents  and  pre fItemNondegIsComponent  will be used without mention throughout the paper  Item  pre fItemCollapseFrontierHull  will be needed for the proof of Proposition PropCBE  For any free splittings any collapse map and any vertex the following hold  em The subgraph is connected  em does not degenerate to a point if and only if it is a component of  em is the convex hull of its frontier in  Denote  Given vertices if the segment does not map to then is a nondegenerate finite tree and there must exist two edgelets in with the same image in that tree  contradicting the definition of a collapse map  this proves that is connected  If is nondegenerate  i e   if it contains an edgelet  then each of its edgelets being in it follows by connectivity that is a subset of  It is moreover a maximal connected subset of --- a component of --- because any edgelet of incident to a vertex of but not in does not have constant image under and so is not contained in  This proves  pre fItemCollapseComponents  and  pre fItemNondegIsComponent   To prove  pre fItemCollapseFrontierHull   let be the frontier of in and let be the convex hull of  By connectivity we have  If the opposite conclusion did not hold then there would be an edgelet  Only one of its two complementary components can contain a point of and so up to interchanging indices we have  Since is disjoint from but contains the point it follows that  The point is the unique frontier point of  Choose having an axis contained in  Let be the point of closest to  For each is also the point of closest to and so is the point of closest to  But and so implying that and contradicting properness of  From Lemma LemmaCollapseProps  pre fItemCollapseComponents   given a collapse map it follows that determines up to simplicial conjugacy  in that the map induces a simplicial isomorphism between and the quotient tree obtained from by collapsing each component of to a point  and furthermore this simplicial isomorphism is -equivariant  In this situation we often say that is obtained by collapsing  Furthermore  any choice of collapsed subgraph may be used  in the sense that for any free splitting and any -equivariant  proper subgraph there exists a free splitting and a collapse map  The tree is defined as the quotient of obtained by collapsing to a point each component of  Since is proper  is not a point  Since is equivariant  the action descends to an action  This action is minimal because is a union of axes of elements of   for each edge there exists a unique pre-image edge such that maps to and there exists whose axis in contains so the axis of in contains  The stabilizer of an edge equals the stabilizer of the pre-image edge and so is trivial  This shows that is a free splitting  and by construction the quotient map is a collapse map  The  nonsimplicial  conjugacy type of the collapsed tree actually depends only on the   natural core   of the collapsed subgraph  To be precise  given a free splitting and a proper  -equivariant subgraph define the natural core  natural core  of to be the largest natural subcomplex of contained in whose components are all nondegenerate  For any collapse maps if have the same natural core then there exists a conjugacy although this conjugacy need not be a simplicial map with respect to the given simplicial structures of  skip Given free splittings we say that collapses to  collapse  or that expands to  expansion  denoted or if there exists a function which is a collapse map with respect to some simplicial subdivisions of the natural cell structures on and  These relations are well-defined on the conjugacy classes of indeed if and only if there exist a function which is a collapse map with respect to the natural cell structures themselves  Even when it is known that notice that there might not exist a collapse map without first changing the simplicial structures on and or for example if is subdivided so finely that it has more edgelet orbits than  The collapse and expand relations are transitive  e g   if then for if are collapse maps of natural cell structures then the composition is a collapse map of natural cell structures  In several places throughout the paper we use without comment the fact that every free splitting has a properly discontinuous expansion meaning that the free splitting is properly discontinuous  see HandelMosher distortion Section 3 2 for a proof  under the heading   How to construct trees in     Steps 1 and 2  When a properly discontinuous expansion is chosen  with collapse map the vertex group system of is represented in as the conjugacy classes of the stabilizers of the infinite components of
The free splitting complex in terms of collapse maps 
 The following result contains the technical facts needed to justify the construction of the simplicial complex  For any free splitting and any proper -invariant natural subgraph let be the corresponding collapse map  the quotient map obtained by collapsing to a point each component of  If is a -edge free splitting then for each let be the set of conjugacy classes of -edge free splittings of the form indexed by those natural subgraphs that contain exactly natural edge orbits of  There are exactly choices of such although a priori one does not know where the cardinality of the set lies in the interval from to because one does not know whether collapsing two distinct -invariant natural subgraphs results in nonconjugate free splittings  Furthermore one does not know a priori how the conjugacy class of depends on  say  the set of conjugacy classes of 1-edge collapses of  The following lemma resolves these issues as one might hope  the lemma will be proved in Section SectionFSSimplicesProof  For any free splittings the following hold  em For any two -equivariant natural subgraphs we have if and only if are conjugate  em if and only if are conjugate  By applying item  pre fItemSimplexExists  of this lemma we may define a collapse to be proper  collapse proper and improper  if it satisfies any of the following equivalent conditions  are not conjugate  for any map which is a collapse map with respect to some subdivision of the natural cell structures  the natural core of is nonempty  We also refer to the collapse maps of the latter type as proper collapse maps  Notice that properness of a collapse relation is also equivalent to the statement that there exists a map which is a collapse map with respect to some subdivision of the natural structures  such that the natural core of is nonempty  A collapse relation which is not proper is improper  Before proving this lemma we apply it to the construction of  From item  1  it follows that we can associate an abstract -simplex denoted to the conjugacy class of each -edge free splitting where the -dimensional faces of are labelled by the conjugacy classes of those free splittings of the form such that contains exactly natural edge orbits of and where is a face of if and only if  We can then glue these simplices together  where for each collapse relation the simplex is glued to the unique face of the simplex that is labelled by the conjugacy class of and where the gluing preserves the labelling of subfaces  From item  2  it follows that the result of these gluings is a simplicial complex  We have proved  There exists a simplicial complex whose -simplices are in one-to-one correspondence with the conjugacy classes of -edge free splittings such that for any pair of simplices we have if and only if  The alternate and more well known approach to this corollary is to appeal to Hatcher s construction of the sphere complex Hatcher HomStability   see for example Aramayona--Souto AramayonSouto FreeSplittings which constructs the 1-skeleton of in this manner  The dimension of equals the number being the maximum number of natural edge orbits of a free splitting the maximum occuring if and only if every natural vertex of has valence  which implies that the action is properly discontinuous   We usually work with the first barycentric subdivision of denoted  Gromov hyperbolicity of and are equivalent because  as with any connected simplicial complex  the identity map is a quasi-isometry between their geodesic simplicial metrics  connectivity follows from Hatcher s proof of contractibility Hatcher HomStability or from the construction of Stallings fold paths reviewed in Section SectionFoldPaths  The simplicial complex has one -simplex associated to each conjugacy class of free splittings  and it has a -simplex associated to each sequence of conjugacy classes of free splittings obtained from any chain of proper expansions  In particular  an edge in oriented from to can be written uniquely as either an expand or a collapse   uniqueness follows from asymmetry of the collapse relation  which is a consequence of Lemma LemmaFSSimplices  pre fItemSimplexExists   As mentioned earlier  the relations of collapse and expand are transitive  It follows that every geodesic in the one-skeleton of can be written as an alternating sequence of expands and collapses  for example starting with an expand or starting with a collapse  Any edge path in that alternates between expands and collapses is called a zig-zag path  zig-zag  in  Throughout the paper  given free splittings we use the notation to denote the length of the shortest edge path in the simplicial complex between the vertices represented by and  We must prove that this metric is Gromov hyperbolic   subsectio nProof of Lemma LemmaFSSimplices   While the proof is surely standard  we are not aware of any proof in the literature  so we provide the details  To each free splitting and each oriented natural edge we associate a clopen decomposition as follows  Choose a proper expansion with collapse map  Let be the unique oriented natural edge that maps to under the collapse  The subgraph has two components  incident to initial and terminal vertices of whose end spaces are respectively  If one chooses any other proper expansion with oriented natural edge mapping to then as shown in HandelMosher distortion Lemma 17 there exists a sequence of collapses and expansions and oriented natural edges such that for each the edges correspond to each other under the collapse map between and  whichever direction that map goes   It immediately follows that are each constant along this sequence  This shows that are both well-defined independent of the choice of  Denote the unordered pair by  Note that for each and we have  Also  given natural edges we have   for the proof we may assume is proper  so has three components  each infinite  choosing a ray in each we see that three of the four sets          are nonempty  and so  Also  for any collapse and any edges such that we have for in defining we can choose any proper expansion with collapse in defining we can choose the same with collapse and one sees that the same edge of maps to and to under these collapse maps  Consider now and as in  pre fItemSimplexExists  and suppose there exists a conjugacy inducing a bijection of natural edges  If correspond under this bijection  pull back under the collapse maps to obtain natural edges  From the previous paragraph it follows that which implies that  Thus  a natural edge of is collapsed by if and only if it is collapsed by which implies that  This proves  pre fItemSimplexExists   skip To prove  pre fItemSimplexUnique   given a free splitting let taken over all oriented natural edges  The set is an -invariant set of clopens in depending only on the conjugacy class of  Since it follows that determines and so it suffices to show that determines the conjugacy class of  The set does determine the oriented edges of which are in bijective  -equivariant correspondence with itself via  Also  the unoriented edges of are in bijective  -equivariant correspondence with subsets of of cardinality which are partitions of  It remains to show that also determines the vertices of and the   initial vertex   relation between oriented edges and vertices  Associated to each natural vertex there is a subset consisting of all such that is the initial vertex of  If we can show that determines the collection v T then we will be done  because the initial vertex relation is then also determined  is an initial vertex of if and only if  Noting that the valence of equals the cardinality of we show first that determines the finite cardinality sets  Define a relation on the set of subsets of   given two subsets we write if for every there exists such that  If is a natural vertex of finite valence then is a partition of of finite cardinality  Furthermore  for every cardinality 2 subset which is a partition of --- i e   every subset of the form for some oriented natural edge --- if then there exists and such that  We claim that the converse holds  suppose is a partition of of finite cardinality and suppose that satisfies the property that for every of cardinality which is a partition of if then there exists and such that   then it follows that there exists a natural vertex such that  To prove this claim  write for some finite set  Note that if then have disjoint interiors  because otherwise they are opposite orientations of the same edge and contradicting that has cardinality  Also  if then the shortest path in intersecting both of intersects them in their respective initial vertices  because  It follows that has a component that intersects each in its initial endpoint  If is any oriented natural edge such that is the initial vertex of then for otherwise contradicting that is a partition of  It follows that is precisely the set of oriented edges not in but with initial vertex in  Suppose that is a nondegenerate tree  If has finite diameter  pick any natural edge and note that but there does not exist any and for which a contradiction  If has infinite diameter  any ray in determines an element of contradicting that partitions  It follows that is a degenerate tree  a natural vertex of cardinality and that proving the claim  To summarize  the natural  finite valence vertices of are determined by in the following manner  they are in -equivariant bijective correspondence  via the correspondence with the subsets which are partitions of of finite cardinality having the property that for every every two-element subset which is a partition of if then there exists and such that  It remains to describe a similar scheme by which determines the infinite valence vertices of  If is a natural vertex of infinite valence then is an infinite partition of it is invariant under the action of the free factor on and it has the property that for any cardinality subset which is a partition of if then there exists and such that  Conversely  let be an infinite subset for which there exists a proper  nontrivial free factor such that is a clopen partition of and is invariant under the action of on and for any cardinality subset which is a partition of if then there exists and such that  Under these conditions we must prove that there exists a vertex such that and  Just as in the finite valence case  writing where the index set is now infinite  there is a component of that intersects each in its initial endpoint  Since is -invariant  the collection is also -invariant  and so is -invariant  The set is precisely the set of oriented natural edges not in but with initial vertex in for if is an oriented natural edge such that is the initial vertex of then and if then contradicting that is a partition of  If is nondegenerate and of finite diameter then we obtain the same contradiction as in the case where is finite  Suppose is nondegenerate and of infinite diameter  The action of the free factor on has a unique  minimal invariant subtree and so  If is nondegenerate then for any edge we have but no equals any a contradiction  The tree is therefore degenerate  where is the unique vertex for which  Any ray in therefore defines an element of but the element defined is not in a contradiction  It follows that must be degenerate  and for some natural vertex and the proof of Lemma LemmaFSSimplices is complete   subparagrap hRemark   For any free splitting any self-conjugacy restricts to the identity map on the vertex set of because maps each natural edge to itself preserving orientation  This is true because  as shown at the beginning of the proof of the corollary  if are natural edges then and
Fold paths
 We define the class of fold paths between vertices of using a method pioneered by Stallings Stallings folding for factoring maps of graphs into products of folds  This method was extended to the category of group actions on trees by Bestvina and Feighn BestvinaFeighn bounding  We refer to the latter paper for some details  although these details are considerably simplified in the category of free splittings 
Directions  gates  and foldable maps
 First we set up some of the basic definitions which are used throughout the paper  We will also prove a tree-theoretic version of the First Derivative Test  Lemma LemmaFDT  Given any graph and a vertex the set of directions of at  direction  denoted is defined to be the set of germs of oriented arcs in with initial vertex  Each direction at is uniquely represented by an oriented edgelet with initial vertex  The union of the sets over all vertices is denoted  Given a subgraph the subset of represented by oriented edgelets having initial vertex in is denoted  Given two free splittings and a map the derivative  derivative  of is a partially defined map whose domain is the set of directions of oriented edgelets on which is nonconstant  and whose value on the direction of is the direction of the oriented edgelet  Given a subgraph if is nonconstant on each edgelet representing a direction in the set then we obtain by restriction a map   as a special case  when is a vertex we obtain a map  Suppose now that the map is nonconstant on all edgelets of so has full domain of definition  For each vertex the set partitions into gates  gate  which are the nonempty subsets of the form for  Every gate is a finite set  indeed we have  For any free splittings for any map which is nonconstant on each edgelet of and for any vertex the cardinality of each gate of is  Let be oriented edgelets with initial vertex representing a gate of  These oriented edgelets are all in distinct orbits under the action of for otherwise their common image in would have a nontrivial stabilizer  It follows that in the quotient graph of groups the quotients of represent distinct directions at the quotient of  It therefore suffices to bound the valence of each vertex in the quotient graph of groups of a free splitting  Without decreasing the valence at the quotient of one can blow up all other vertex orbits so that the only vertex orbit with nontrivial stabilizers is the orbit of  Then  still without decreasing quotient valence  one can inductively collapse natural edges whose endpoints are in different vertex orbits  When this process stops  the quotient graph of groups is a rose with one natural vertex  possibly having nontrivial vertex group  and with edges  whose natural vertex has valence   Foldable maps and edgelets  A map is foldable  map foldable   foldable map  if it satisfies either of the following two equivalent statements  em Natural edge definition of foldable   is injective on each natural edge of and has gates at each natural vertex of  em Edgelet definition of foldable   is injective on every edgelet  has gates at every vertex  and has gates at every natural vertex  We will without warning switch between these two definitions whenever it is convenient  Notice that the restrictions on the number of gates are significant only at vertices of finite valence  because every gate is a finite set  for example  if every natural vertex of has nontrivial stabilizer then every map defined on which is injective on natural edges is foldable  Notice also that foldability of depends only on the natural cell structures on and not on the given simplicial structures  to put it more formally  foldability is an invariant of in the category of equivariant continuous functions between free splittings of  Given free splittings a foldable map and an edgelet an -edgelet of  edgelet of a foldable map  is an edgelet of that is mapped to by  In Lemma LemmaFoldableExistence below we shall prove the existence of foldable maps in the appropriate context   subparagrap hRemark   In other treatments of Stallings folds we have not seen any analogue of our gate condition on natural vertices  This condition is crucial to the diameter bound obtained in Lemma LemmaBROneB as well as in the heart of the proof of the Main Theorem  particularly in the proof of Proposition PropPushdownInToto Step 3   subparagrap hThe First Derivative Test   The first derivative test of calculus implies that if the derivative of a function has no zeroes then local extreme values occur only at endpoints of the domain   The First Derivative Test  Suppose that is a foldable map of free splittings  Given a connected subgraph and a vertex if has valence 1 in the subgraph then is a frontier point of W  If is an interior point of then and since has gates at it follows that has cardinality implying that has valence in
Construction of foldable maps
 Given free splittings a fold path from to will be defined by factoring a foldable map  Although a foldable map does not always exist  one will exist after moving a distance at most 2 in  For any free splittings there exist free splittings and a foldable map such that  Fix the free splitting  Given a free splitting let denote the set of all equivariant continuous functions that take each natural vertex of to a vertex of and whose restriction to each natural edge of is either injective or constant  It follows that is a map with respect to the pullback simplicial structure on whose vertex set consists of all points that map to vertices of and that are not in the interior of a natural edge of that is collapsed by  The edges of this simplicial structure on will be referred to as pullback edgelets of  Choose any expansion so that is properly discontinuous  which implies that the set is nonempty  Amongst all elements of choose to maximize the number of orbits of natural edges of on which is constant  By collapsing each such natural edge we define a collapse map and an induced function which is an element of the set  By maximality of it follows that any element of is injective on each natural edge of for otherwise by composing the collapse map with an element of that collapses some natural edge of we obtain an element of that collapses a larger number of natural edge orbits than does  a contradiction  We find a foldable element of by solving optimization problems  First we prove that if minimizes the number of orbits of pullback edgelets then has gates at each vertex of  Suppose there is a vertex at which has only gate  Let be the valence of   note that because is injective on natural edges  Let be the oriented natural edges of with initial vertex  Let be the initial pullback edgelets of and let be the terminal endpoints of respectively  We have for some oriented edge with initial vertex and opposite vertex  Consider first the case that for each and so we can isotope each restricted map by pushing across to by an isotopy supported in a neighborhood of and we can extend these isotopies to an equivariant homotopy of to produce an element of that has fewer orbits of pullback edgelets than has  a contradiction  Consider next the case that for certain values of  If are in distinct -orbits for each such then we can equivariantly homotope pushing across to so as to collapse each for which to produce an element of that collapses each of the natural edges such that a contradiction  In the remaining case there exists some such that and for some and it follows that  The edges and are therefore fundamental domains for the actions of on its axes in respectively  It follows that the direction of at maps to the direction of at which is not equal to the direction of at contradicting that has a single gate at  Next we prove that among all that minimize the number of orbits of pullback edges  there is at least one which is foldable  having gates at each natural vertex  This is achieved  mostly  by solving another optimization problem  Define the edgelet vector of to be the vector of positive integers indexed by the natural edge orbits of whose entry corresponding to a natural edge is the number of pullback edgelets in  Define to be the sum of its entries  which equals the number of pullback edgelet orbits of a number which has already been minimized so as to guarantee gates at each vertex  Define to be the sum of the squares of its entries  We have the inequality  Amongst all with minimal value of choose so as to maximize  We claim that with energy maximized as above  one of the following holds  em has gates at each natural vertex  and so is foldable  em has exactly one natural vertex orbit  has two gates at every natural vertex  and each natural edge of has its two directions lying in distinct gate orbits  To prove this dichotomy  suppose that has exactly two gates at some natural vertex  The gates must have the same cardinality  otherwise  by doing a valence 2 homotopy  pushing across one edge of in the image direction of the larger of the two gates at one reduces the total number of pullback edgelets  Now consider defined by the two possible valence 2 homotopies at pushing across the two edges of in the two image directions of the two gates at  Note that the average of the two vectors is the vector  It follows that for otherwise  by convexity of energy  one of or would be larger than  It also follows that has exactly one natural vertex orbit  for otherwise would be connected across a natural edge to some natural vertex in a different orbit  implying that one of equals and the other equals  It also follows that each natural edge has one end in the orbit of one gate at and opposite end in the orbit of the other gate at for otherwise one of would equal and the other equals  This shows that satisfies item  pre fItemHoop    medskip To finish up we show that if satisfies  pre fItemHoop  then there exists which satisfies  pre fItemNotHoop   Item  pre fItemHoop  implies that there is an orientation of the natural edges of such that at each natural vertex the directions with initial vertex form one gate of at denoted and the directions with terminal vertex form the other gate denoted  Pick a natural vertex  Let be the subtree of consisting of the union of all oriented rays in with initial vertex  The restriction of to each such ray is injective and proper  and their initial directions all map to the same direction in so it follows that the subtree has a valence vertex at and no other valence vertex  Also  if we orient each edge of to point away from the vertex then the map preserves orientation  Furthermore is not itself just a ray  for if it were then would be just a line  an impossibility for a free splitting of a free group of rank  Let be the vertex of of valence which is closest to  Define by mapping to extending equivariantly to the orbit of and extending equivariantly to an embedding on each edge of  We claim that has one gate at corresponding to each direction of at which implies that is foldable  To see why  first note that the set is mapped by to the unique direction of the segment at  Next note that each direction in the set is mapped by to one of the directions of at distinct from the direction of   furthermore each such direction is in the image of because maps onto by an orientation preserving map  This completes the proof of Lemma LemmaFoldableExistence
Folds
 Given free splittings and a foldable map we say that is a fold  map fold   fold   fold map  if there exist oriented natural edges with the same initial vertex and there exist nondegenerate initial segments which are subcomplexes of with the same positive number of edgelets  such that if we let denote the unique orientation preserving simplicial isomorphism  then for all we have if and only if there exists such that  up to interchanging  and  We also say that the map folds the segments and  The pair of segments determines the free splitting up to simplicial conjugacy  namely is conjugate to the equivariant quotient complex of obtained by equivariantly identifying and via  In this context we shall say that the free splitting is determined by folding the segments  Letting denote the initial directions of respectively  we also say that folds the directions although do not determine the segments and they need not determine up to conjugacy  Notice that are in different orbits under the action  equivalently under the action   for otherwise the segment would have nontrivial stabilizer  Folds are classified according to the properness of the inclusions as follows  If are both proper initial segments of then we say that is a partial fold  otherwise is a full fold   fold full  If is a full fold and exactly one of is proper then we say that is a proper full fold   fold full proper  otherwise  when and we say that is an improper full fold   fold full improper  For later purposes we note that if is a full fold then every natural vertex of is the image of a natural vertex of   and even when is a partial fold  every natural vertex of which is not in the orbit of the image of the terminal endpoints of the folded edges is the image of a natural vertex of  In the terminology of BestvinaFeighn bounding folds between free splittings can also be classified into two types as follows  If the opposite vertices of are in different -orbits one gets a type IA fold   fold type IA  in this case the stabilizer of the vertex is the subgroup generated by the stabilizers of which  if nontrivial  is a free factor whose rank is the sum of the ranks of the stabilizers of and  If are in the same -orbit then one gets a type IIIA fold   fold type IIIA  and the stabilizer of the vertex is the subgroup generated by the stabilizer of and an element such that which is a free factor whose rank is plus the rank of the stabilizer of  Notice that a type IIIA fold is only possible if is a partial fold or an improper full fold  because a natural and an unnatural vertex can never be in the same orbit  We refer to BestvinaFeighn bounding for an understanding of the map on quotient graphs of groups which is induced by a fold  The following lemma and its proof are well known in the narrower context of the first barycentric subdivision of the spine of outer space  For any fold the distance in from to equals or  Let fold oriented segments with common initial endpoint and opposite endpoints  After possibly subdividing and so that each contain edgelets  the map can be factored into two maps as where folds the initial edgelets and folds the -images of the terminal segments  Letting and resubdividing there is an expansion defined by a collapse map  Also  letting after resubdividing there is a collapse defined by a collapse map  It follows that in  It remains to show that that is  are not conjugate free splittings  Since each fold map is foldable  the natural vertex has gates with respect to  It therefore has gates with respect to and so is natural  It follows that is a natural edge of having one endpoint at and opposite endpoint of valence in  The subgraph is therefore natural  and it follows from Lemma LemmaFSSimplices that is not conjugate to  The free splittings may or may not be conjugate  depending on whether at least one of is a natural edge  If neither of is natural then is conjugate to and so is not conjugate to  If one or both of is natural then  after resubdividing  the collapse may also defined by collapsing the natural subgraph which is the union of the orbits of whichever of is natural  but and so by Lemma LemmaFSSimplices we conclude that are not conjugate 
Fold sequences and fold paths
 Consider free splittings and a sequence of maps of the form  Letting we say that is a maximal fold factor of if the following hold  is a fold map that folds oriented initial segments of oriented natural edges respectively  and are the maximal initial subsegments of such that in we have  Recall from the definition of a fold that are edgelet paths with the same number of edgelets   subparagrap hFold sequences   Consider a sequence of free splittings and maps of the form  In this context we will always denote We say that this is a fold sequence  fold sequence  if the following holds  em is a foldable map  em Each map is a maximal fold factor of the map for  It follows from  pre fItemOuterFoldable  and  pre fItemConjOrMaxFold  that em is a foldable map for each  To prove  pre fItemEachFoldable   starting from the base assumption  pre fItemOuterFoldable   and assuming by induction that is foldable  we prove that is foldable  By  pre fItemConjOrMaxFold  the map is a maximal fold factor of  The map is injective on each edgelet of and each edgelet of is the image of some edgelet of so is injective on each edgelet  Consider a vertex and a vertex for which  The number of -gates at is greater than or equal to the number of gates at which is and furthermore if is natural then this number is  This covers all cases except for when is natural and each such has valence  Since is a maximal fold factor of this is only possible if is a partial fold that folds segments such that if denote the terminal endpoints of then  If is a type IA fold  that is if are in different orbits  then has valence and by maximality of the fold it follows that the three directions at are all in different gates with respect to  If is a type IIIA fold  that is if are in the same orbit  say for a nontrivial then contains and so is nontrivial  and hence has infinitely many gates with respect to  This proves by induction that each is foldable  Next  to prove that is foldable  given a vertex we simply note that the decomposition of into -gates is a refinement of the decomposition into gates  of which there are and if is natural  This completes the proof that  pre fItemOuterFoldable  and  pre fItemConjOrMaxFold  imply  pre fItemEachFoldable   In this proof we have shown the following fact which will be useful in Lemma LemmaFoldSequenceConstruction below when we construct fold sequences  For any foldable map and any factorization of into two maps of the form if is a maximal fold factor of then the map is also foldable  The implication of this lemma is false if one allows to be a partial fold which is not a maximal fold factor of for in that case the map will have only 2 gates at the valence vertex which is the -image of the terminal endpoints of oriented segments that are folded by   subparagrap hFold paths   A fold path  fold path  in is any sequence of vertices represented by free splittings for which there exists a fold sequence   we also say that this fold path has -steps  Strictly speaking a fold path need not be the sequence of vertices along an actual edge path in the simplicial complex because the size of the step from to is either or   see Lemma LemmaFoldDistance  If one so desires one can easily interpolate the gap between and by an edge path of length or to get an actual edge path from to  We define two fold sequences to be equivalent  fold sequence equivalence  if they have the same length and there is a commutative diagram of the form where the top and bottom rows are the two given fold sequences and each vertical arrow is a conjugacy  Note that the vertical arrows are not required to be   maps   as we have defined them  in that they need not be simplicial  For example  if the bottom row is obtained by taking the barycentric subdivision of each 1-simplex in the top row then the two fold sequences are equivalent  Equivalent fold sequences determine the same fold path  but the converse is false  A counterexample consisting of a -step fold path is given at the end of this section   subparagrap hConstruction of fold factorizations   Having constructed many foldable maps in Lemma LemmaFoldableExistence to construct many fold paths it suffices to factor each foldable map as a fold sequence  Given free splittings and a foldable map a fold factorization  fold factorization  of is any fold sequence which factors as shown in the following commutative diagram  A fold factorization of any foldable map can be constructed by an inductive process described in BestvinaFeighn bounding with considerable simplification arising from the fact that all edgelet stabilizers are trivial in  We give this simplified argument here  For any free splittings every foldable map has a fold factorization  If is a simplicial isomorphism then we are done  with a fold factorization of length  Otherwise  we use the following obvious but key fact  em Local to global principle   Any simplicial map between trees which is locally injective is globally injective  If furthermore it is surjective then it is a simplicial isomorphism  For the inductive step we show that every foldable map which is not a homeomorphism factors into maps as where is a maximal fold factor of  By the Local to global principle plus the fact that is minimal  it follows that is surjective and so is not locally injective  We may therefore find a vertex and two directions such that  Let be the oriented natural edges with initial vertex and initial directions  Let be the maximal initial segments such that  Noting that are subcomplexes with the same number of edgelets  let be the unique orientation preserving simplicial homeomorphism  Define to be the quotient map obtained by equivariantly identifying and and let be the induced map  As indicated in BestvinaFeighn bounding is a tree and the induced action is minimal  The map is simplicial by construction  from which it follows that is simplicial as well  The stabilizer of each edgelet of is trivial because it is contained in the stabilizer of its image in under which is trivial  and so is a free splitting  By construction the map is a maximal fold factor of the foldable map  To support the inductive step we must prove that has fewer edgelet orbits than which follows from the fact that the initial edgelets of and are in different orbits of the action because they have the same image edgelet in and its stabilizer is trivial  The fold factorization of may now be constructed as follows  Assuming is not locally injective  factor into maps as where is a maximal fold factor of  The induced map is foldable by Lemma LemmaMaxFactor and the number of edgelet orbits of is smaller than the number of edgelet orbits of  The process therefore continues by induction on the number of edgelet orbits  stopping at when is locally injective and therefore a simplicial conjugacy  and we identify
Remark 
 The Local to global principle may be used to construct fold factorizations with various special properties  In particular  if is a subtree on which is not locally injective then we may choose the folded edges to lie in  This is used in the proof of Lemma LemmaBRNatural
Counterexample  inequivalent folds 
  qquad qquad We describe two inequivalent folds that determine the same step fold path in  Both of the actions are properly discontinuous  We first describe the quotient marked graphs and the induced homotopy equivalences  The marked graph has a valence vertex with the following incident directions  directed natural edges with initial vertex and a directed natural edge with initial and terminal vertex   subject to this description  is then filled out to be a marked graph in an arbitrary manner  The marked graph is defined to have the same underlying unmarked graph as  The homotopy equivalences are defined so that and are the identity elsewhere  Clearly are homotopic  by a homotopy which spins the loop once around itself and is stationary on  The marking on is defined by pushing forward the marking on via either of and so each of preserves marking  Consider the universal covering maps  We may choose -equivariant lifts which are the two fold maps at issue  If they were equivalent then  since any self-conjugacy of or of fixes each vertex and each oriented natural edge  see the Remark at the end of Section SectionFreeSplittingComplex   each direction in would have the same image in under and  However  fixing a lift and lifts of with initial vertex and a lift of with terminal vertex we have but
The Masur-Minsky axioms
 Our proof that is hyperbolic uses the axioms introduced by Masur and Minsky MasurMinsky complex1 for their proof that the curve complex of a finite type surface is hyperbolic  The axioms require existence of a family of paths which satisfy a strong projection property  For this purpose we shall use fold paths  Proposition PropFoldContractions stated at the end of this section says  roughly speaking  that fold paths in satisfy the Masur-Minsky axioms  First we give an intuitive explanation of the content of Proposition PropFoldContractions by giving an outline of the Masur-Minsky axioms as they would apply to fold paths  The axioms require that a map be defined which is a kind of projection from to each fold path  To make things work the range of the projection is taken to be the parameter interval of the fold path  giving the projection map the form  When one projects two vertices of to two parameters one is interested in the   diameter  of the subpath  between these two parameters    which means the diameter of the set in  There are three axioms  The Coarse Retraction bounds the diameter between each and its projection  The Coarse Lipschitz axiom bounds the diameter between the projections of two nearby vertices  The Strong Contraction axiom says roughly that  for each metric ball in that stays a bounded distance away from the fold path  if one takes the sub-ball having a certain proportion of the total radius  the diameter between the projections of any two vertices in the subball is bounded  All the bounds occurring in this discussion must be uniform  depending only on the rank of  In fact rather than using fold paths themselves  we use fold sequences  As we have seen in the counterexample at the end of Section SectionFoldPaths the same fold path can be represented by inequivalent fold sequences  and the projection maps of these two fold sequences may be different  This kind of situation is handled formally be expressing the Masur-Minsky axioms in terms of   families   of paths which allow a path to occur repeatedly in the family  skip Given integers we adopt interval notation for the set of all integers between and inclusive  regardless of the order of  Consider a connected simplicial complex with the simplicial metric  A path in is just a finite sequence of -simplices which we write in function notation as  A family of paths in is an indexed collection of paths in   we allow repetition in the family  A family of paths in is said to be almost transitive if there exists a constant such that for any -simplices there is a path in the family such that all of the distances are  Given a path and a function called the   projection map   to the path and given constants consider the following three axioms  em Coarse retraction   For all the set has diameter  em Coarse Lipschitz   For all vertices if then the set has diameter  em Strong contraction   For all vertices if and if then the set has diameter   MasurMinsky complex1 Theorem 2 3  Given a connected simplicial complex if there exists an almost transitive family of paths in and for each a projection map to the path such that the Coarse retraction the Coarse Lipschitz and the Strong contraction axioms all hold with uniform constants for all then is hyperbolic   subparagrap hRemarks   Our notion of   almost transitivity   is not quite the same as   coarse transitivity   used in MasurMinsky complex1 which requires that the paths in the set be continuous and that there is a constant such that any two points at distance are connected by a path in the set  However  the proof of equivalence of the two forms of the axioms  one with   almost transitive   and the other with   coarse transitive    is very simple  and is left to the reader  The set of fold paths in is almost transitive with constant   for any free splittings by moving a distance one obtains a naturally foldable morphism to  Lemma LemmaFoldableExistence   which has a fold factorization  Section SectionFoldFactorizations   and consecutive free splittings in such a factorization have distance  Lemma LemmaFoldDistance  The concept of a   family of paths   is left undefined in MasurMinsky complex1 but the proof of the above theorem and the application to curve complexes given in MasurMinsky complex1 clearly indicate that an indexed family with repetition is allowed  On top of that  given any indexed family satisfying the hypothesis of the theorem  if we removed repetition by kicking out all but one copy of each path then the resulting family would still satisfy the hypotheses of the theorem  In our situation  although we use fold paths in our application of the above theorem  we shall index them by  equivalence classes of  fold sequences  thus  we allow for the possibility that two inequivalent fold sequences representing the same fold path might have somewhat different projection maps  skip Notice that the Strong contraction axiom  unlike the Coarse Lipschitz axiom  is not symmetric in the variables  For our proof we shall need to extend the applicability of the Strong contraction axiom by further desymmetrizing it  em Desymmetrized strong contraction   For all vertices if in the interval if and if then the set has diameter  For all constants there exist constants such that the desymmetrized strong contraction axiom with constants and implies the strong contraction axiom with constants and  Set and  We need only show that if in if and if then and  We have d w  mma 0 K   	 d v  mma 0 K   - d w v 
 	 d v  mma 0 K   -  fra c1  4   cdot d v  mma 0 K  
 	  fra c3  4   cdot d v  mma 0 K   3a a
  intertex tand  d v w  	  fra c3  4   cdot b  cdot d v  mma 0 K  
 	  fra c3  4   cdot b  cdot  fra c4  3  d w  mma 0 K     b  cdot d w  mma 0 K   We now define the path family in that we use to prove the Main Theorem  Having associated to each fold sequence a fold path  which clearly depends only on the equivalence class of that fold sequence  the index set is defined to be the set of equivalence classes of fold sequences  To prove the Main Theorem  by combining the Masur--Minsky theorem  almost transitivity of fold paths  and Lemma LemmaDesymmetrization it therefore suffices to prove  Associated to each fold sequence in there is a projection map depending only on the equivalence class of the fold sequence  such that the Coarse retraction the Coarse Lipschitz and the Desymmetrized strong contraction axioms all hold  with constants depending only on  The next step in the proof of the Main Theorem will be taken with the formulation of Proposition PropProjToFoldPath where the projection maps are defined   subparagrap hRemark   Theorem 2 3 of MasurMinsky complex1 contains an additional conclusion  which in our context says that fold paths may be reparameterized to become uniform quasigeodesics in although the reparameterization does not fall out explicitly from their proof  Our method of proof will actually yield an explicit quasigeodesic reparameterization of fold paths  in terms of the   free splitting units   introduced in Section SectionFSU  See Proposition PropFoldPathQuasis for the statement and proof regarding this reparameterization 
Combing
 In this section we define a combing method for fold sequences  Roughly speaking  given a fold sequence and a free splitting which differs from by a single edge in we want a construction which combs backwards to produce a fold sequence in which each differs from the corresponding by at most a single edge in  We would like to give this construction in two cases  depending on whether the oriented edge from to is a collapse or an expansion  In the case of a collapse there is indeed a process of   combing by collapse   which produces a fold sequence as stated  see Proposition PropCBC  In the case of an expansion although there is a process of   combing by expansion    the sequence produced need not be a fold sequence  instead it belongs to a broader class of map sequences that we refer to as   foldable sequences    see Proposition PropCBE  It is an important part of our theory that both combing processes are closed on the collection of foldable sequences  combing by collapse is closed as well on the smaller collection of fold sequences  In Section SectionCombingRectangles we define the collection of foldable sequences on which combing will be defined  and we define combing rectangles which are the commutative diagrams of foldable sequences and collapse maps that are used to describe combing  see Figure FigureCombingRectangle  We also prove Lemma LemmaCombingProperties which says that combing by collapse is closed on foldable sequences  The two main combing processes --- combing by collapse  and combing by expansion --- are described in Section SectionCombingConstructions  In Section SectionCombRectOps we will also give some methods for constructing new combing rectangles by composing or decomposing old ones  skip Also in Section SectionCombingRectangles combing rectangles will be used to define the projection map from to each fold path and we will state Proposition PropProjToFoldPath which says that these projection maps satisfy the requirements of the Masur-Minsky axioms  Combing rectangles will be important structures for the rest of the paper  Much of the geometric intuition behind our methods involves visualizing combing rectangles and other  more complicated diagrams of free splittings and maps as objects sitting in the complex and visualizing various methods for geometrically manipulating these objects  The technical details of the proof of the Main Theorem will involve a calculus of combing rectangles  which is based on the constructions of combing rectangles given in Sections SectionCombingConstructions and SectionCombRectOps
Combing rectangles and the projection onto fold paths

Foldable sequences 
 Consider a sequence of free splittings and maps over of the form and recall the notation for each  This sequence is said to be a foldable sequence  foldable sequence  over if for each the map is a foldable map  It follows that each of the maps is a foldable map  because for each vertex the -gate decomposition of is a refinement of the -gate decomposition 
Combing rectangles 
 A combing rectangle  combing rectangle  over is a commutative diagram of maps over having the form depicted in Figure FigureCombingRectangle such that  em The top horizontal row is a foldable sequence  em Each vertical arrow is a collapse map with collapsed subgraph indicated in the notation  em For all we have  Equivalently  for all we have   h   captio nA combing rectangle  Horizontal sequences are foldable  the top by definition and the bottom by Lemma LemmaCombingProperties  Vertical arrows are collapses and   As mentioned earlier  combing is not closed on the set of fold sequences  We will eventually prove that combing is closed on the set of all foldable sequences  the following proves this in part  by showing closure under   combing by collapse    For any combing rectangle notated as in Figure FigureCombingRectangle the bottom row is a foldable sequence  We put off the proof of Lemma LemmaCombingProperties until after the definition of the projection map 
Projecting onto fold paths 
 Given a free splitting a fold sequence and an integer a projection diagram from to of depth  projection diagram  is a commutative diagram of free splittings and maps over of the form depicted in Figure FigureProjDiagram such that each horizontal row is a foldable sequence  and the two rectangles shown are combing rectangles   h  A projection diagram of depth from to  The projection of to is defined to be the maximum depth of any projection diagram from a free splitting conjugate to to a fold sequence equivalent to if such a diagram exists  and otherwise  It is clear that this gives a well-defined function that depends only on the equivalence class of the fold sequence  One way to understand this definition is to think of as being Gromov hyperbolic and to think of fold paths as being quasigeodesic  all of which are true a posteriori assuming that Proposition 3 2 is true  That being so  given a fold path and projecting to by moving to some point nearby we should obtain a fold path from to having an initial segment that fellow travels the given fold path from to and no farther  In defining the projection map as above  the intuition is that combing rectangless provide an adequate definition of fellow traveling  The technical details of the definition were crafted to what would work in our proofs  but also received some original motivation from results of MasurMinsky complex1 which amount to a proof that for any finite type oriented surface splitting sequences of train tracks on define quasigeodesics in the curve complex of  In particular  Lemma 4 4 of that paper --- which can be regarded as a verification of the Coarse Lipschitz axiom --- contains the statement        and if one works out the train track diagram for that statement one obtains a rather strong analogue of our projection diagram above  The rest of the paper is devoted to the proof of the following  which immediately implies Proposition PropFoldContractions and therefore implies the Main Theorem  There exist depending only on such that for any fold sequence in the projection map defined above satisfies the Coarse retraction Coarse Lipschitz and Desymmetrized strong contraction axioms with constants  The Coarse Retraction axiom is proved in Proposition PropCoarseRetract and the other two axioms are proved in Section SectionMainProof  skip We now turn to   Proof of Lemma LemmaCombingProperties   Following the notation of Figure FigureCombingRectangle we must show that each map is foldable  First note that is injective on each edgelet because for some edgelet so so is an edgelet of  Given a vertex we must show that has gates at and that if is natural then has gates  Let  We have a subgraph and a subgraph such that  Note that each direction in is based at a frontier vertex of and is represented by an edgelet of and similarly for and so these direction sets are in the domain of definition of the derivative maps respectively  We have a commutative diagram of derivatives in which the vertical maps are bijections and so induces a bijection between gates of and point pre-images of the map in the top row  The valence of therefore equals the cardinality of the set and the number of gates of at equals the cardinality of the image of the map in the top row  If has valence  resp    then we must prove that the image of the map in the top row has cardinality  resp   Suppose that is a valence vertex contained in the interior of a natural edge  The subgraph is either a point or a segment contained in the interior of a natural edge such that  Let be the two oriented edgelets incident to representing the two directions of the set  Let be the two oriented edgelets incident to the endpoints of representing the two elements of the set indexed so that  Since is injective on it follows that are distinct edgelets of  Noting that for it follows that these are two distinct edgelets of and so has 2 gates at  Suppose now that is a vertex of valence so the set has cardinality  If is a point then it has valence and  since is foldable  there are gates of in   it follows that there are gates of in  If has infinite diameter then is infinite and so has infinite valence  implying that has infinitely many gates at  If does not contain a natural vertex of then it is a segment in the interior of a natural edge of implying that has valence a contradiction  We have reduced to the case that the graph has finite diameter  is not a point  and contains a natural vertex of  The graph also has finite diameter and is not a point  and so has vertices of valence  the cardinality may be countably infinite   Let be a set consisting of one vertex of in the preimage of each valence vertex of  By the First Derivative Test  each is a frontier vertex of  Choosing a direction based at each it follows that the directions are based at distinct points of and are therefore distinct directions in the set  If then we are done  We have reduced further to the subcase that and so is a segment with endpoints  We have with  Consider a natural vertex such that and its image  Since is foldable  there are gates at with respect to  If then at least one of the gates at maps to a direction at which is distinct from the direction and from the unique direction of the segment at and so we have found a third direction in the set  If is an interior point of the segment then at least one of the gates at maps to a direction at distinct from the two directions of the segment at and again we have found a third direction in
Combing by collapse and combing by expansion
 In approaching the proof of Proposition PropProjToFoldPath one immediately confronts the need for constructions of combing rectangles  in order to construct the projection diagrams needed to compute projection maps  This section and the next contain the constructions of combing rectangles that we use for this purpose  Our first construction of combing rectangles shows how to comb a foldable sequence followed by a collapse map   Combing by collapse  For each foldable sequence and for each collapse there exists a combing rectangle of the form shown in Figure FigureCombingRectangle such that  Define an equivariant subgraph using the definition of a combing rectangle  starting with by induction define  Since is a proper equivariant subgraph it follows by induction that each is a proper equivariant subgraph  and so free splittings with collapse maps and induced maps are all defined  and the squares are all evidently commutative  We remark that the cheapness of the above proof is slightly offset by the modest expense of proving that the sequence is foldable  which was done back in Lemma LemmaCombingProperties  skip Next we explain how to comb a foldable sequence followed by an expansion  In sharp contrast to the case of combing by collapse  both the construction of the combing rectangle and the proof that the resulting map sequence is foldable are very intricate in the case of combing by expansion   Combing by expansion  For each foldable sequence each expansion and each collapse map there exists a combing rectangle of the form Remark  Implicit in the conclusion via the definition of combing rectangle is that the sequence is foldable  We will construct this combing rectangle in two steps  In Step 1 we produce a commutative diagram of free splittings and maps of the form in which each is a collapse and but the row slightly fails to be foldable in that certain explicitly described natural vertices of are   bad   by fault of having only gates with respect to  One of these gates will always be a singleton  and so each   bad natural vertex   will be incident to a   bad natural edge    In Step 2 we will repair this problem by splitting each bad natural edge  to produce a commutative diagram of the form The row will be a foldable sequence  The maps are not collapses but instead are   multifolds   that invert the splitting process  The desired combing rectangle will be obtained by concatenating these two rectangles  the composition will indeed be a collapse map  which collapses the subgraph   subparagrap hStep 1   The free splitting is defined to be the minimal subtree of the pushout of and  Here are more details  As a set  the pushout of and is The action is obtained by restricting the diagonal action  The restrictions of the two projection maps are denoted Both are clearly -equivariant and we have  As a graph  the vertices and edgelets of the pushout are as follows  A vertex is a pair such that is a vertex of and is a vertex of  Edgelets are of two types  First  a collapsed edgelet is one of the form where is a vertex and is an edgelet such that   the barycentric coordinates on induce those on via the projection  Second  to each edgelet there corresponds a unique edgelet with the property that  uniqueness follows since is a collapse map   and there corresponds in turn an uncollapsed edgelet of with barycentric coordinates induced via the map which takes bijectively to the edgelet of  The action of on and the projection maps are each simplicial  The simplicial complex is 1-dimensional by construction  It is furthermore a tree  in that removal of the interior of each edgelet separates  because the simplicial map is injective over the interior of each edgelet of and for each vertex the subcomplex is a tree  mapped by a simplicial isomorphism to the tree  The action has no point fixed by each element of and so neither does the action   it follows that the -tree contains a unique minimal -invariant subtree which  by definition  is  For each edgelet its stabilizer is contained in if is uncollapsed and in if is collapsed  and in either case is trivial  This proves that is a free splitting  Here are some structural facts about the tree  For each edgelet the edgelet is the unique one mapped to via and since is minimal the map is surjective which forces to be contained in  This also shows that is a collapse map  The union of the collapsed edgelets of the pushout forms a subgraph with one component for each vertex such that is a component of   the map restricts to a simplicial isomorphism between these components  The subgraph of that is collapsed by is the union of those components of that contain at least one edge  Each of these components has the form when this intersection contains at least one edge  by convention we set otherwise  See below for a more detailed description of various features of  There is an induced map which is defined by the formula which makes sense because for each we have  The commutativity equation is immediate  Since is the minimal subtree of it follows that but we are not yet in a position to prove the opposite inclusion  not until we have established that the map has gates at each vertex   subparagrap hPreparation for Step 2   Here are some structural facts about the components of  Consider a vertex for which and so is a component of  Given an oriented edgelet we abuse notation by writing to mean that is the initial vertex of  There is a function where for each we define to be the initial vertex of the corresponding oriented edgelet  Note that the set is the topological frontier of the subtree in the tree  By Lemma LemmaCollapseProps  pre fItemCollapseFrontierHull  it follows that is the convex hull of the set in  Notice also that the function is constant on each gate of with respect to the map for if are in the same gate then is a single edgelet in which lifts to a unique edgelet and we have and so the initial endpoints of and have the same image under  But these initial endpoints are in the graph on which is injective  so these initial endpoints are equal  Letting denote the set of gates of in the map induces a map which we also denote whose image is also the frontier of  We now study the extent to which the maps are foldable  Note first that we may identify with the pushout and so we may identify and up to simplicial conjugacy and we may identify in particular the gates of and of are therefore identical  We will show that has gates at each vertex of so a vertex is either good meaning it has valence and gates or valence and gates  or bad meaning it has valence but only gates  We shall do this through a case analysis  going through various cases of good vertices and narrowing down to one remaining case which is bad  This will yield an explicit description of the bad vertices which will be used in describing the free splitting  Fix a vertex so if then  Denote  Consider first the case that   we shall show that is good  We have a commutative diagram of derivative maps where the left arrow is a bijection  i e  the valences of and are equal  Also  the set is in the domain of definition of the right arrow and the right arrow is an injection on its domain of definition  The number of gates at are therefore equal  Since is foldable it follows that is good  Consider now the case that  To simplify notation we denote and  Each gate of in is contained either in or its complement because implying that never maps a direction of and a direction of to the same direction of  Since is injective on each direction in the set constitutes an entire gate of  Gates at in the complement exist if and only if is a frontier vertex of if and only if is in the image of  Consider the subcase that has valence in  The graph is then a segment contained in the interior of a natural edge of  The vertex therefore has valence in with either directions in or one each in and in and in either case these 2 directions are mapped by to two different directions in and so is good  Consider the subcase that has valence in  If the valence of in plus the number of gates at in the complement of is then has gates at so is good  If is an interior vertex of then has valence in by minimality of   furthermore  the valences of in and in are equal and the number of gates of at equals the valence  so is good  If is a frontier vertex of valence in then has gate in the complement of and we considered this case already and showed that is good  If is a frontier vertex of valence in and if has gates in the complement of then we have also considered this case already and showed that is good  If is a frontier vertex of valence in and has exactly 1 direction in the complement of then has valence in and gates  so is good  The only case that remains  and the case that characterizes when is bad  is when has valence in is a frontier vertex of has valence in has exactly one gate in the complement of and that gate has cardinality called the external valence of  When in this case  let be the unique natural edge of with endpoint and with direction at equal to the unique direction of at  We call the bad natural edge incident to  Let be the natural endpoint of opposite  We claim that for each bad natural vertex we have   the only way this could fail is if is an edgelet path whose vertices apart from all have valence in implying that has 2 gates at the natural vertex contradicting that is foldable  We claim also that is good  otherwise it would follow that which again would imply the contradiction that has 2 gates at  The union of the bad natural edges of forms an equivariant natural subgraph denoted  The natural edges of its complement are the good natural edges of some of which may be contained in some in and some in neither  The endpoints of a good natural edge need not be good  From the description of bad natural edges it follows that each component of contains a unique good vertex and is the union of some number of bad natural edges with endpoint forming a star graph with valence vertices apart from   subparagrap hStep 2   Ignoring the simplicial structure for the moment  define the free splitting to be the one obtained from by collapsing the bad subgraph  Let be the collapse map  Note that restricts to an equivariant bijection from the good natural vertices of to the natural vertices of because is a natural subgraph each of whose components contains exactly one good natural vertex  Also  induces a bijection from the good natural edges of --- those in --- to the natural edges of   denote this correspondence by for each good natural edge and note that maps homeomorphically to  Define the map as follows  The restriction of to the natural vertices of is the equivariant bijection onto the good natural vertices of that is obtained by inverting  The endpoints of each natural edge of map to distinct points of and so may be extended equivariantly and continuously to be an injection on each natural edge of  Define the simplicial structure on to be the unique one with respect to which is a simplicial map  its vertices are the inverse image under of the vertices of   each of its edgelets maps via by simplicial isomorphism to an edgelet of  Define the subgraph to be   we will see below that is a collapse map which collapses the subgraph  Knowing that is injective on each natural edge of we describe the image of each natural edge as follows  The notation which so far defines an equivariant function from the bad natural vertices of to the good natural vertices of extends to all natural vertices of by defining when is good  For each natural vertex we have   if is good this is because and are inverse bijections between good natural vertices of and all natural vertices of   if is bad then and are contained in the same component of so and hence  Given a natural edge with corresponding good natural edge letting be the endpoints of and letting it follows that is the arc in connecting to which is just the union of together with the bad natural edges incident to whichever of are bad  From this description of we derive a few more properties of giving details about its behavior over good and bad natural edges of and its behavior on natural edges and natural vertices of  em  a  over good natural edges of    the map is injective over the interior of each good natural edge the closure of is an edgelet path contained in and the restriction of to this edgelet path is a simplicial isomorphism onto  em  b  over bad natural edges of    for each bad natural edge oriented to have terminal point and initial point letting be the external valence of letting  be the oriented good natural edges with common initial point and letting be the corresponding oriented natural edges with common initial point there exist initial segments such that maps each to by a simplicial isomorphism and such that  Furthermore each is a valence vertex of  Intuitively  a  and  b  together say that is a   partial multifold    which for each of its gates identifies proper initial segments of the oriented natural edges representing that gate  Perhaps the only nonobvious part of  a  and  b  is the last sentence of  b   For each bad natural vertex from  a  and the previous sentences of  b  it follows that and that for each the vertex is contained in the interior of the natural edge one direction being in the segment and the other direction being in the closure of which is in and so has valence in  em  c  on natural edges of    The restriction of to each good natural edge of is injective  Furthermore  an embedded edgelet path is the -image of some good natural edge of if and only if the endpoints of are good natural vertices of no interior point of is a good natural vertex  and is injective  Only the   if   part of  c  is not obvious  Let be an embedded edgelet path whose only good natural vertices are its endpoints  and suppose that is injective  If contains no bad natural vertex then is a good natural edge with associated natural edge and  If is a bad natural vertex then and since is injective it follows that one direction of at is the direction of the bad natural arc whose opposite good natural endpoint must be an endpoint of   the edgelet path is therefore the concatenation of some natural edge with any bad natural edges incident to the endpoints of and it follows that  em  d  at natural vertices of     qquad For each natural vertex the map  break is surjective  To justify  d   the vertex is a good natural vertex of  Consider a direction  If is the initial direction of some oriented good natural edge corresponding to an oriented natural edge it follows that the initial vertex of equals and the initial direction of maps to  If is the initial direction of some bad oriented natural edge with opposite bad natural vertex let be any of the good natural edges incident to oriented with initial vertex and let be the corresponding oriented natural edge  and it follows that the initial vertex of again equals and that the initial direction of maps to  We now prove that we have a collapse map  Clearly an edgelet of is in if and only its image under is in if and only if its image under is a point  Given an edgelet the collapse map is injective over the interior of so there is a unique edgelet mapped to by and   it follows that and so by item  a  above the map is injective over the interior of   therefore is injective over the interior of  Putting off for the moment the issue of defining the maps we define the maps as follows  First note that the map is evidently a simplicial isomorphism  and so we may identify with and with  We now define to be the composition  The map is foldable  equivalently is foldable  for the following reasons  by  c  the map is injective on natural edges of   for each natural vertex its image is a good natural vertex and so has gates with respect to and by  d  the derivative map is surjective  which implies that has gates at  All that remains is to define a map so that the commutativity equation holds  for by combining this with the equation it immediately follows that and so the map sequence is defined and is foldable  Consider a natural vertex  Its image is a good natural vertex and so has gates with respect to implying that has gates with respect to and so is a good natural vertex  and hence there is a unique natural vertex in that maps to which we take to be  We have thus defined so as to satisfy the commutativity equation on each natural vertex  Consider a natural edge with natural endpoints  Its image is the arc with good natural endpoints  By  c  above the map is injective on the arc implying that is injective on and that is injective on the arc the latter of which has good natural endpoints  Subdividing the arc at all interior good natural vertices of we write it as a concatenation  Each of the arcs has good natural endpoints  no good natural interior points  and the map is injective on and so by  c  there is a unique natural edge mapped by to by a simplicial isomorphism  Since every good natural vertex in has a unique natural pre-image in it follows that we may concatenate to obtain an arc and furthermore the restriction is a simplicial isomorphism onto  Inverting this restriction we may then define which is a simplicial isomorphism with image  We have thus defined so as to satisfy the commutativity equation on each natural edge  This completes the proof of Proposition PropCBE
Composition and decomposition of combing rectangles 
  Composition of combing rectangles   qquad
 Given two combing rectangles of the form their composition  which is the commutative diagram is a combing rectangle  The collapsed subgraph of is the union of the collapsed subgraph of with the inverse image under of the collapsed subgraph of  For each edgelet the map is injective over the interior of and so there is a unique edgelet such that  The map is injective over the interior of and it follows that is injective over the interior of  This proves that is a collapse map and that the second diagram in the statement above is a combing rectangle  Given an edgelet of clearly its image under is a vertex of if and only if its image under is a vertex of or an edgelet of whose image under is a vertex of   Decomposition of combing rectangles  Given a combing rectangle of the form and given equivariant subgraphs  having the property that for each there exist two combing rectangles of the form whose composition  as in Lemma LemmaCombingComp  is the given combing rectangle  Define the collapse map to be the quotient map obtained by collapsing each component of to a point  Since there exists a map induced from under the quotient  which makes the top rectangle with the row and the row commutative  and this rectangle is therefore a combing rectangle  By Lemma LemmaCombingProperties the sequence is foldable  Define a subgraph  We have where the second equation is verified by a diagram chase using that the map is surjective  and that is injective over the interior of each edgelet of  Clearly the collapse map factors as the composition of and a collapse map making the bottom diagram with the row and the row commutative  and this row is therefore a combing rectangle 
Free splitting units
 In this section we study how to break a fold sequence into natural units called free splitting units  Our story of free splitting units grew in the telling  The original concept was motivated by units along train track splitting paths that are implicit in the   nested train track argument   of MasurMinsky complex1 and refinements of that argument in MMS Splitting  The details of the definition were tailored to fit the proofs of our two major results  our Main Theorem on hyperbolicity of the free splitting complex  via the arguments of Sections SectionPushingDownPeaks   and Proposition PropFoldPathQuasis which says that free splitting units give a uniformly quasigeodesic parameterization of fold paths in  The main results of this section are Proposition PropCoarseRetract which verifies the Coarse Retraction axiom of Masur and Minsky  and Lemma LemmaUnitsLipschitz which says that free splitting units give a uniformly coarse Lipschitz parameterization of fold paths in  Underlying Lemma LemmaUnitsLipschitz are Lemmas LemmaBRNatural and LemmaBROneB which give two methods of finding diameter bounds along foldable foldable sequences  The diameter bounds  which are stated and proved in Section SectionDiamBounds arise from finding   invariant natural structures   along the foldable sequence  The first diameter bound  Lemma LemmaBRNatural occurs when each free splitting along the fold path decomposes equivariantly into a pair of natural subgraphs in a manner which is   invariant   with respect to the foldable maps  see Definition DefBRDecompos  The second diameter bound  Lemma LemmaBROneB occurs when each free splitting has a particular orbit of natural edges which is   almost invariant   with respect to the foldable maps  see Definition DefAIE  The combinatorial structures underlying the two diameter bounds are used to formulate the definition of free splitting units along a fold sequence  see Definitions DefLessThanOneFSU and DefGeneralFSU  The diameter bounds are not applied directly to the fold sequence itself  but instead to foldable sequences obtained by transforming the given fold sequence via an application of   combing by collapse   followed by an application of   combing by expansion    One can already see this kind of transformation in the   nested train track argument   of MasurMinsky complex1
Diameter bounds along foldable sequences
 In this section we describe a pair of techniques for finding upper bounds on the diameter of foldable sequences 
Diameter bounds from natural red-blue decompositions 
 Consider a free splitting and a nonempty  proper  -invariant subgraph having no degenerate components  The conjugacy classes of nontrivial stabilizers of connected components of form a free factor system as one can see by forming the collapse map and noting that is a subset of  Passing further to the quotient graph of groups the image of under the composition is a subset of the vertex set of  Let be the number of -orbits of components of equivalently the cardinality of  Let be the sum of the ranks of the components of equivalently the sum of the ranks of the subgroups labelling the vertices in the graph of groups and so we have  Defining the complexity of to be we have  If furthermore is a natural subgraph of then because the number of component orbits of is at most the number of natural edge orbits in and is an upper bound for the number of natural edge orbits of any free splitting of  Altogether this shows that the complexity of any nonempty  proper  natural  -invariant subgraph satisfies  Invariant blue-red decompositions  An invariant blue--red decomposition for a foldable sequence also called an invariant decomposition for short  is a decomposition for each such that for we have and  where in expressions like we abuse notation by deleting degenerate components   Notice that any choice of final decomposition determines a unique invariant decomposition by the equations and  An invariant decomposition is natural if either of the following two equivalent properties holds  are natural subgraphs of if and only if are natural subgraphs of for all  The   only if   direction follows by observing that the image of each natural vertex under a foldable map is a natural vertex  and so the image of a natural subgraph is a natural subgraph  Because an invariant decomposition is determined by the final decomposition  a general invariant decomposition carries little information about the foldable sequence  The typical behavior is that the edgelets within a natural edge will alternate many times between red and blue  that is  the number of components of and will be very large  Exploiting the difference between this typical behavior and the contrasting special behavior of a natural invariant decomposition is at the heart of the proof of the Main Theorem  specifically in the proof of Proposition PropPushdownInToto Step 2  Here is our first diameter bound  Given a foldable sequence with an invariant natural decomposition the following hold  em The complexity is nonincreasing as a function of  em The interval subdivides into subintervals on each of which is constant  em If is constant on the subinterval where then Remark  When is a fold sequence  one obtains a diameter bound for the entire sequence as follows  Subdivide the interval into subintervals on which is constant  On each subinterval one has a diameter bound of  At each of the fold maps where one subinterval transitions to another  one has an additional distance bound of coming from Lemma LemmaFoldDistance  Putting these together  However  the manner in which we actually apply Lemma LemmaBRNatural to fold sequences is via concepts of free splitting units in the next section  see Lemma LemmaUnitsLipschitz  Before turning to the proof proper of Lemma LemmaBRNatural we first state a sublemma about the behavior of complexity of invariant subforests under fold maps  If is a fold map of free splittings  if is a nonempty  proper  -invariant subgraph  and if  as usual ignoring degenerate components   then and and so  Furthermore  equality holds if and only if restricts to a bijection of component sets of and  We delay the proof of this sublemma and meanwhile turn to   Proof of Lemma LemmaBRNatural   Item  pre fItemBRDecrease  follows from Sublemma SublemmaBlueFoldBounds by factoring each foldable map into folds  Item  pre fItemBRSubintervals  follows from  pre fItemBRDecrease  and the fact that  To prove  pre fItemBRBound   fixing with it suffices to prove that  By assumption of  pre fItemBRBound   is constant for  For each factoring into folds  applying  pre fItemBRDecrease  to get constant complexity on the fold factorization  and applying Sublemma SublemmaBlueFoldBounds to each of those folds  it follows that induces a bijection between the component sets of and  By composing  it follows that induces a bijection between the component sets of and  Now we may factor into a fold sequence of the form by prioritizing folds of blue edge pairs over folds of red edge pairs up until when there are no more blue edge pairs to fold  with the result that if then an edge pair of folded by is blue  whereas if then an edge pair of folded by is red  To see that prioritizing in this manner is possible  if does not already restrict to a simplicial isomorphism from to then  using that induces a bijection of components of and together with the Local to global principle  see the proof of Lemma LemmaFoldSequenceConstruction and the following Remark   it follows that some pair of oriented natural edges with the same initial vertex have images in with the same initial direction  We may therefore define the first fold to be a maximal fold factor of obtained by folding producing a factorization  Pushing the natural blue-red decomposition of forward  or equivalently pulling that of back   we obtain a natural blue-red decomposition of and the map still induces a bijection of component sets of blue graphs  We may then continue by induction  stopping when the map restricts to a simplicial isomorphism of blue graphs  If the map is not already a simplicial isomorphism then one continues the fold factorization arbitrarily  with the result that all folds from to are red  For by collapsing all blue edges of we obtain a free splitting with a collapse map  Also  for by collapsing red edges of we obtain a free splitting with a collapse map  We claim that up to equivalence is independent of and is independent of  From this claim it follows that are connected in by a path of length as follows  which completes the proof  We prove for each that are equivalent  and for that are equivalent  the two cases are similar and we do just the first  Let be maximal oriented segments with the same initial vertex that are identified by the fold  Recall that the fold map can be factored as where identifies proper initial segments of and folds the remaining unidentified segments  Since are blue  by pushing forward the blue-red decomposition of or pulling back that of we obtain a blue-red decomposition of  Furthermore  there is a collapse map which collapses the blue segment resulting from partially identifying and a collapse map which collapses the remaining unidentified segments  also blue  By composition we obtain collapse maps and each of which collapses the entire blue subgraph of  It follows that and are equivalent   Proof of Sublemma SublemmaBlueFoldBounds   Let be oriented natural edges with the same initial vertex that are folded by the map  Let be maximal initial subsegments that are identified by  Let be the terminal endpoints  Note that either or  If or if and either or then all inequalities are equations and is a bijection of component sets  We are reduced to the case that and and so is not a bijection of component sets because the two components of containing are mapped to the one component of of that contains  We must prove that the inequalities and both hold and that at least one of them is strict  Let the fold map be factored as where folds short initial segments of and folds the remaining segments  as in the proof of Lemma LemmaFoldDistance  Let be the images of  In order to compare the complexities of and we shall move them both into where we can make the comparison directly  Letting be the image of equivalently the preimage of the fold map clearly induces an equivariant bijection from the component set of to that of and so the values of and on are all equal  Letting the fold map induces an equivariant bijection from the component set of to that of and so the values of and on are equal  So now we must prove the inequalities and and that at least one of them is strict  Let be the images of respectively  under the fold map  In the quotient graph of groups notice that is the union of with the segment obtained by projecting that segment is disjoint from except at its endpoints  it has one endpoint on and the other endpoint at and the stabilizer of the interior vertex of that segment is trivial  It follows that if that is  if are in different component orbits  then and  On the other hand if that is if and are in the same component orbit  then and
Diameter bounds from almost invariant edges 
 Consider a foldable map and a natural edge  By ignoring unnatural vertices in and their pre-images in we may speak about -edgelets in   these are the closures of the components of each of which is a subsegment of a natural edge of  If contains a unique -edgelet and if is the natural edge containing that edgelet then we say that the pair is an almost invariant edge of the foldable map   Almost invariant edge  An almost invariant edge for a foldable sequence is a sequence of natural edges such that for the edges and are an almost invariant edge for the foldable map  Note that an almost invariant edge exists for the whole foldable sequence if and only if one exists for the map  To see why  observe that for any natural edge letting be the number of edgelets in the sequence is nonincreasing as a function of  If there is a natural edge so that is an almost invariant edge for the map then and so has constant value equal to  Letting be the unique natural edge containing an edgelet in it follows that is an almost invariant edge for the whole foldable sequence  This argument also shows that each almost invariant edge for a foldable sequence is determined by its last term  Here is our second diameter bound  Given a foldable sequence the following are equivalent  em The foldable map has an almost invariant edge  em The foldable sequence has an almost invariant edge  em There exists a one-edge free splitting such that for all  em There exists a one-edge free splitting such that and  Furthermore if these hold then  The bound in the last sentence clearly follows from  pre fItemOneEdgeExistsAll   We have seen that  pre fItemAIEexistsSome   pre fItemAIEexistsAll   and clearly  pre fItemOneEdgeExistsAll   pre fItemOneEdgeExistsSome    medskip We next prove  pre fItemAIEexistsAll   pre fItemOneEdgeExistsAll   Let be an almost invariant edge  Let be the complement of the orbit of the natural edge  Define a collapse map so is a one-edge free splitting  It suffices to prove for each that  Letting be the unique -edgelet in letting be the complement of the orbit of and defining a collapse map clearly the map induces an equivariant homeomorphism and so  Also  since is the maximal natural subgraph of the identity map on induces a collapse map which is a bijection on natural vertices and which  on each natural edge of collapses an initial and or terminal segment and is otherwise injective  It follows that the collapse map is equivariantly homotopic to a conjugacy  and so   medskip It remains to prove  pre fItemOneEdgeExistsSome   pre fItemAIEexistsSome   After rewording  this says that if is a foldable map of free splittings  and if there exists a one-edge free splitting such that then has an almost invariant edge  Fix an oriented natural edge with initial and terminal vertices and oriented natural edges with initial and terminal vertices respectively  so that there are collapse maps which collapse the complement of the orbits of and which take homeomorphically to  We shall prove that is an almost invariant edge for  There is a component decomposition where contains the vertex and there are corresponding component decompositions so that are the inverse images of respectively  under the collapse maps  in general the       notation means    or respectively    for instance    is the inverse image of    means    is the inverse image of respectively     Note that are natural subgraphs of respectively  Also  is the unique point on the topological frontier of in and similarly for  Also  each vertex in each of these subgraphs has valence within the subgraph  in  say  this is obvious for all interior vertices  and the frontier vertex is a natural vertex in having only one -direction not in namely the direction of  It suffices to prove that which immediately implies that is an almost invariant edge for  Assuming that either or we shall produce a contradiction  The arguments are similar in either case  so we shall assume that  Given a free splitting and a nontrivial let denote either the axis of in or the unique vertex of fixed by  Let denote the set of nontrivial such that  Note that for each natural edge there exists whose axis under the action contains  It follows that Note also that em To prove this for say  note first that the collapse map takes to and its restriction to has image for each  If then and hence and since the axes contained in cover we get one inclusion  For the other inclusion  if then either crosses and so crosses or and so and in either case  Next we show  em There exists a finite number such that Applying the inclusion to all and using  pre fItemFpm  we obtain one inclusion  The opposite inclusion follows by applying the bounded cancellation lemma to the map  The version of the lemma that we need comes from  BookZero  Lemma 3 1  and although the hypothesis there requires that be a properly discontinuous action  called there a   free simplicial tree     the first paragraph of that proof works exactly as stated for a map like that factors as a fold sequence  The conclusion of that first paragraph is that there exists a bounded cancellation constant for such that for any vertices in the tree the set is contained in the neighborhood of the segment  Applying this to our situation  we conclude that for any we have  Applying this to all and using  pre fItemFpm   it follows that completing the proof of  pre fItemCrossingBound   We show that the only way for to cross is to do so rather sharply  em If then  Recalling that is the unique frontier point of it follows that  To see why  by  pre fItemCrossingBound  the tree has finite diameter  by assumption of  pre fItemThornProp  it is nondegenerate  and so it has at least two vertices of valence at least one being distinct from  The graph therefore has at least one vertex of valence  But is the unique frontier vertex of so by the First Derivative Test the point is the unique valence vertex of  Combining this with  pre fItemThornProp  follows immediately  But from  pre fItemThornProp  we deduce that has at most gates at the natural vertex because all of the directions at distinct from the direction of are mapped by to a single direction at namely  the direction of the segment  This contradicts that a foldable map has at least gates at every natural vertex 
Definitions and properties of free splitting units
 Given a fold sequence we shall first define what it means for to   differ by free splitting unit   for and we prove an appropriate stability result for this definition  With this in hand  for any we then define the number of free splitting units between and  Lemma LemmaFirstFSUBound proves that the free splitting parameterization along the fold sequence is a Lipschitz parameterization with respect to distance in    free splitting unit  Given a fold sequence and we say that differ by free splitting unit if there exists a commutative diagram of the form whose top and bottom rectangles are combing rectangles  so that foldable sequence on the top row has either an invariant natural blue-red decomposition of constant complexity or an almost invariant edge  by combining Lemmas LemmaBRNatural and LemmaBROneB this holds if and only if the foldable map has either an invariant natural blue-red decomposition of constant complexity or an almost invariant edge   To complete the definition  we symmetrize the concept by requiring that differ by free splitting unit if and only if differ by free splitting unit   medskip The following is an immediate consequence of the definition  by restricting to the appropriate subdiagram of the above commutative diagram   Stability of free splitting units  Given a fold sequence and if differ by free splitting unit then differ by free splitting unit  Using these concepts we get a diameter bound as follows  Given a fold sequence and if differ by free splitting unit then  Consider the commutative diagram in the definition of free splitting unit  Combining Lemmas LemmaBRNatural and LemmaBROneB it follows that  Since for each we have
The coarse retract axiom 
 As an application of the concepts of free splitting units  particularly Lemma LemmaBROneB we now prove that our definition for projecting onto fold paths satisfies the first of the three Masur-Minsky axioms  For any fold sequence the associated projection map satisfies the Coarse Retraction axiom with the constant   for any we have and the diameter of the set is  Furthermore  there is free splitting unit between and  We start by noticing that a projection diagram from to of depth certainly exists  where all vertical arrows are conjugacies and all collapse graphs are empty  see Figure FigureCoarseRetractCombRect1   h   centerlin e xymatrix  S 0  ar r   ar     d  	  cdots  ar r  	 S i  ar     d 
 S 0  ar r  	  cdots  ar r  	 S i
 S 0  ar r   ar     u  	  cdots  ar r  	 S i  ar r   ar     u  	  cdots  ar r  	 S K
    A projection diagram from to of depth  By definition  is the largest integer in the set such that  after rechoosing the free splitting in its conjugacy class  and after rechoosing the fold sequence in its conjugacy class  a projection diagram from to of depth exists  This largest integer therefore satisfies and yields a projection diagram as in Figure FigureCoarseRetractCombRect2   centerlin e xymatrix  T 0  ar r   ar d  	  cdots  ar r  	 T i  ar r   ar d  	  cdots  ar r  	 T   pi S i    ar r   ar d  	 S i
 S  0  ar r  	  cdots  ar r  	 S  i  ar r  	  cdots  ar r  	 S    pi S i 
 S 0  ar r   ar u  	  cdots  ar r  	 S i  ar r   ar u  	  cdots  ar r  	 S   pi S i    ar r   ar u  	  cdots  ar r  	 S K
    A maximal depth projection diagram from to  Let be any natural edge  and let be the one-edge free splitting obtained from by collapsing the complement of the orbit of  Then we have collapse maps and proving that and  Applying Lemma LemmaBROneB the foldable sequence on the top row from to has an almost invariant edge  and by restriction there is an almost invariant edge from to  Also by Lemma LemmaBROneB the set has diameter and since for each it follows that  And by Definition DefLessThanOneFSU it follows that there is free splitting unit between and   General count of free splitting units   free splitting unit   hfill break Given a fold sequence for we say that differ by free splitting unit if they do not differ by free splitting unit  Then  for the number of free splitting units between and is defined to be the maximum integer for which there exists a sequence of integers of length parameterized by integers such that if then differ by free splitting unit  Notice that our definitions are consistent in that if and only if  following the earlier definition  there is free splitting unit between and  Also  we symmetrize the definition by saying that the number of free splitting units between and equals the number between and   subparagrap hRemark   In counting the number of free splitting units between and although this number depends on the fold sequence that connects to that fold sequence will always be clear by context and we suppress this dependence in our terminology  Notice that this number does not depend on any other details of an ambient fold sequence of which might be a subinterval  In particular  the number of free splitting units between and is unaffected if the ambient fold sequence is truncated by deleting an initial segment before and or a terminal segment after   medskip Notice that with the notation as above  if then the number of free splitting units between and equals  To see why  first note that this number is by construction  If it were then one could alter the sequence by removing the entries and inserting an increasing sequence of entries in the interval which amongst themselves have free splitting unit between any consecutive two  By Stability of Free Splitting Units the new entries would have free splitting units with the remaining entries outside of the interval  The new sequence would therefore still have free splitting units between consecutive terms  but would have length contradicting the maximality of  One can count free splitting units between and in several ways  For example  define the front greedy subsequence  front greedy subsequence  from to to be the sequence obtained by induction as follows  assuming is defined  and assuming and differ by free splitting unit  let be the least integer such that and differ by free splitting unit  the sequence stops when differ by free splitting unit  We claim that the length of the front greedy subsequence  is equal to the number of free splitting units between and  When differ by free splitting unit the claim is immediate  In the case where differ by free splitting unit  clearly   then  noting by stability that differ by free splitting unit for and using maximality of it follows that  For the opposite inequality we argue by contradiction assuming that  Consider any subsequence such that differ by free splitting unit for each  By maximality of it follows that between each of the pairs and there is free splitting unit  By stability it follows that between and there is free splitting unit  By definition of we have  By stability it follows that and differ by free splitting unit from which it follows that  Continuing by induction we see that for  But since and since differ by free splitting unit  it follows by stability that differ by free splitting unit  which contradicts the definition of  In a similar fashion one proves that the number of free splitting units is equal to the length of the back greedy subsequence  back greedy subsequence  defined as follows  assuming by induction that is defined and that and differ by free splitting unit  is the greatest integer such that and differ by free splitting unit  the sequence stops when differ by free splitting unit  The following result says that a fold path which is parameterized by free splitting units is a coarse Lipschitz path in   For any fold path and any if the number of free splitting units between and equals then the diameter in of the set is  If that is if differ by free splitting unit  then by Lemma LemmaFirstFSUBound we have  If from to let be the front greedy sequence  For the free splittings and differ by free splitting unit  and so  By Lemma LemmaFoldDistance we have and so  It follows in turn that  Since differ by free splitting unit we have and putting it all together   We also need the following lemma which gives a coarse triangle inequality for free splitting units within a fold path  Given a fold path and if is the number of free splitting units between and and is the number between and then the number between and satisfies  In the case where is between and using symmetry of free splitting units we may assume that  Let be the front greedy sequence from to  Clearly the front greedy sequence from to is an initial segment  implying that and and so we have a subsequence of with the property that between any two adjacent elements of this subsequence there is free splitting unit  By Definition DefGeneralFSU and the hypothesis on the length of this subsequence is therefore giving us  In the case where again using symmetry we may assume  Let be the front greedy subsequence between and  Again the front greedy subsequence between and is an initial subsegment and so  In the case where using symmetry we assume and we proceed similarly using the back greedy subsequence between and
Proof of the Main Theorem
 We begin with a quick sketch of the proof  Consider a free splitting a fold sequence and a maximal depth projection diagram which defines the projection from to this fold sequence  The form of this projection diagram can be viewed in Section SectionCombingRectangles Figure FigureProjDiagram the top row of which is a foldable sequence  We then apply Lemma LemmaFoldSequenceConstruction to factor the final foldable map as a fold sequence of the form which we then paste into the foldable sequence on the top row of the projection diagram to get an   augmented   projection diagram  Figure FigureMaxProjDiagram shows the original  unaugmented projection diagram and the augmented version in the same picture  Note that the top row of the augmented projection diagram is the foldable sequence  See Section SectionStatmentFSUContraction for more details on augmented projection diagrams  Consider also a geodesic in the  n b1 skeleton of starting with and ending with some free splitting  This geodesic is a zig-zag path  suppose for concreteness that it starts with a collapse and ends with an expand  and so is even  By combing the foldable sequence across each collapse and expansion in this zig-zag path one at a time  we obtain   The Big Diagram  Step 0   depicted in Section SectionProofFSUContraction Figure FigureBigDiagram0 which is built out of the projection diagram and an rectangle composed of combing rectangles  Note that the interior even terms along the zig-zag path  the free splittings are   peaks   of the zig-zag  The big rectangle has the form of a corrugated aluminum roof in which the interior even horizontal rows are peaks of the corrugations  Our technique can be described as   pushing down the peaks    In brief  we prove that if one backs up from to some earlier term in the fold path moving back a certain fixed number of free splitting units  then the big diagram can be simplified by pushing the first corrugation peak down  reducing the number of corrugation peaks by as shown in   The Big Diagram  Step 1    These   back up --- pushdown   arguments are found in Section SectionPushingDownPeaks  Therefore  if the number of free splitting units between and is greater than a certain multiple of the number of peaks in the zig-zag path from to then the number of corrugation peaks in the Big Diagram can be reduced to zero  With one final   back up --- push down   step that uses up some of the original projection diagram for one obtains a projection diagram from to from which one concludes that the projection of to is not much further back  measured in free splitting units  than which is the projection of  The exact statement proved by these arguments is contained in Proposition PropFSUContraction which can be regarded as a reformulation of the Coarse Lipchitz and Desymmetrized strong contraction axioms in terms of free splitting units  and which quickly implies those axioms and the main theorem as shown in Section SectionStatmentFSUContraction  The proof of Proposition PropFSUContraction itself is carried out in Sections SectionPushingDownPeaks and SectionProofFSUContraction
Desymmetrized strong contraction reformulated and applied
 In Proposition PropFSUContraction we reformulate the Coarse Lipschitz and Desymmetrized strong contraction axioms as a joint statement expressed in terms of free splitting units  The proposition will be proved in later subsections of Section SectionMainProof  After stating the proposition  we use it to finish off the proof of the main theorem  We also use it to prove Proposition PropFoldPathQuasis which describes precisely how to reparameterize fold paths in terms of free splitting units so as to obtain uniform quasigeodesics in  To set up Proposition PropFSUContraction consider any fold path any free splitting and any projection diagram of maximal depth as depicted in Figure FigureMaxProjDiagram  Applying Proposition LemmaFoldSequenceConstruction we may factor the foldable map as a fold sequence  and then replace with this factorization in the top line of the projection diagram  to obtain a sequence of maps This sequence of maps is still foldable --- if then is foldable by virtue of being a map in the original foldable sequence on the top line of the unaugmented projection diagram  and if then is foldable by virtue of being a map in the newly inserted fold sequence  note that if one replaces any but the last map in a foldable sequence with a fold factorization  this trick does not work --- the resulting sequence need not be foldable   We therefore obtain the augmented projection diagram  projection diagram augmented  from to of maximal depth  as depicted also in the Figure FigureMaxProjDiagram   h  An augmented projection diagram from to of maximal depth  with the straight arrows from to  is obtained from a maximal depth projection diagram  with the curved arrow from to labelled  by inserting a fold sequence factorization of the foldable map  After this insertion the whole sequence in the top row is still a foldable sequence   Strong contraction in terms of free splitting units   quad
 Letting the following holds  Consider a fold path a free splitting with projection and an augmented projection diagram of maximal depth as notated in Figure FigureMaxProjDiagram  Let be the number of free splitting units between and  If is a free splitting such that and if the number of free splitting units between and is then there exists such that the number of free splitting units between and is   subparagrap hRemark   To put it more plainly  Proposition PropFSUContraction says that the projection of to the fold path is no farther to the left of the projection of than a bounded number of free splitting units  as long as is at most some bounded proportion of the number  One can think of the number as being a stand-in for the distance from to the fold path  a posterior one sees that is indeed quasicomparable to that distance   Notice that the proposition does not apply if no projection diagram exists for nor if the number of free splitting units between and is too small  in either of these cases the projection of is close to in  These special situations are handled in Case 1 of the proof of the Main Theorem  Note that Proposition PropFSUContraction is trivially true when by taking  The real meat of the proposition is when  skip Proposition PropFSUContraction is proved in Sections SectionPushingDownPeaks and SectionProofFSUContraction  For the rest of Section SectionStatmentFSUContraction we shall apply Proposition PropFSUContraction to prove first the Main Theorem and then Proposition PropFoldPathQuasis regarding quasigeodesics in   Proof of the Main Theorem   qquad As we showed earlier  Proposition PropProjToFoldPath implies Proposition PropFoldContractions which implies the Main Theorem  To prove Proposition PropProjToFoldPath we must prove that the projections to fold paths in satisfy the Coarse retraction Coarse Lipschitz and Desymmetrized strong contraction axioms given in Section SectionMasurMinsky with uniform constants depending only on  In Proposition PropCoarseRetract we already did this for the Coarse retraction axiom  We turn to the other two axioms  Fix the fold path and free splittings with projections  For verifying both the Coarse Lipschitz and Desymmetrized strong contraction axioms we may assume that  We seek to bound the diameter in of the set  If then and we are done  Otherwise  after rechoosing in its conjugacy class and rechoosing in its equivalence class  we may choose an augmented maximal depth projection diagram for and as notated in Figure FigureMaxProjDiagram  Let be the number of free splitting units between and  Throughout the proof we denote the constants from Lemma LemmaUnitsLipschitz as It follows that along any fold path  for any two terms of that path between which the number of free splitting units is at most the diameter in of the segment between those two terms is at most This is the value of that will be used in verifying the two axioms   subparagrap hCase 1   Suppose that the number of free splitting between and is  Applying the inequality together with Stability of free splitting units it follows that the number of free splitting units between and is  By Lemma LemmaUnitsLipschitz the diameter of the set is which is the common conclusion of the Coarse Lipschitz and Desymmetrized strong contraction axioms  In this case  those axioms are verified using any values of   subparagrap hCase 2   Suppose that the number of free splitting units between and is  We claim that the following statement holds  em    If then the number of free splitting units between and is and so the diameter in of the set is  To prove assume that  Using the hypothesis of Case 2 we may apply Proposition PropFSUContraction concluding that for some the number of free splitting units between and is  Using Stability of free splitting units it follows that the number of free splitting units between and is  Applying Lemma LemmaUnitsLipschitz we have  Since applies whenever the Coarse Lipschitz axiom follows immediately  To prove Desymmetrized strong contraction we shall produce constants so that if and then for then applies and so  Consider first the case that  By Lemma LemmaUnitsLipschitz we have and so  By taking we may dispense with this case  Consider next the case that  It follows that  We have from which it follows that The number of free splitting units between and equals and so by Lemma LemmaUnitsLipschitz we have  It follows that which implies that  Let b 	   fra c1  80  rank F  - 60     fra c1  b 1 L   C   2  
 	  fra c1  b 1 L    fra cC 2   Upsilon       fra c Upsilon  b 1 L  Upsilon C 2   where the inequality follows from  We then have It follows that if then and we are done  subject to proving Proposition PropFSUContraction
Quasigeodesic reparameterization of fold paths 
 We can also use these arguments to show how fold paths can be reparameterized  using free splitting units  to give a system of uniform quasigeodesics in  Recall that each fold sequence can be interpolated by a continuous edge path in   for each fold the vertices are connected in by an edge path of length or by Lemma LemmaFoldDistance  Let be the number of free splitting units from to  Choose any sequence such that for there is free splitting unit between and  Notice that by Stability of Free Splitting Units the number of free splitting units between and and between and is and so we may rechoose the first and last terms of the sequence so that  Choose a continuous parameterization of the interpolating edge path of the form such that  We call this a free splitting parameterization of the fold sequence  We use Proposition PropFSUContraction in particular some details of the preceding proof  in order to prove the following result  There exist constants depending only on such that any free splitting parameterization of any fold path is a quasigeodesic in that is  We continue with the constants from the previous proof  As shown back in the definition of free splitting units  for each integer there is exactly free splitting unit between and  Applying Lemma LemmaUnitsLipschitz it follows that for each the set has diameter  Combining this with the fact that the edge path interpolating each fold has length it follows that Given if there is no integer in the interval then  Otherwise we take to be the smallest integer and the largest integer respectively  and we have d mma s   mma t   	 d mma u   mma v     d mma s   mma u     d mma t   mma v  
 	  L C 1   ab sv-u    2 L C 1 
 	 k  ab ss-t    c using any and any  and we note that this inequality also holds in the previous case where there is no integer in  This proves the second inequality of the proposition  To prove the first inequality  we first prove it for integer values  Fix a geodesic edge path of length connecting to in  Project to the fold path  By the statement above  within this fold path there are free splitting units between the projections of any two consecutive vertices of  By applying Lemma LemmaFSUTriangleInequality the coarse triangle inequality for free splitting units  it follows that there are free splitting units between and the projections of and respectively  By Proposition PropCoarseRetract where the Coarse retract axiom was proved  the number of free splitting units between and and between and are both  By applying Lemma LemmaFSUTriangleInequality again  the number of free splitting units between and is that is   For arbitrary letting be the largest integer and be the smallest integer we have and  By we therefore have  It follows that   ab ss-t  	  ab su-v
 	  b 1 1  d S   mma v    S   mma v      2
  fra c1  b 1 1   ab ss-t  -  fra c2  b 1 1  	 d S   mma v    S   mma v   
 	 d S   mma v    S   mma v       19 - d S   mma u   S   mma s    
 	 qquad qquad    19 - d S   mma v   S   mma t    
  fra c1  b 1 1   ab ss-t  -   fra c2  b 1 1    38  	 d S   mma s   S   mma t    This proves that the first inequality is true for any and any  break  Proposition PropFoldPathQuasis is therefore proved for and
Pushing down peaks
 Recall that every geodesic in is a zig-zag edge path  On a zig-zag subpath of the form where is the domain of two incident collapse maps and we say that is a peak  If on the other hand then is a valley  We start with a simplistic technique that can be used to shortcut a zig-zag path  and we work up to a technique  described in Proposition PropPushdownInToto that will be central to the proof of the Main Theorem  In each case the intuition is to   push down the peak    thereby reducing length 
The peak of a W diagram 
 A W diagram  W diagram  or a W zig-zag is a length zig-zag path with a peak in the middle  sometimes depicted as in Figure FigureWDiagram   h  A W diagram We think of as the   blue   and   red   subgraphs of  In this generality  an edgelet of may be in either  or both  or neither of  The subgraphs therefore do not necessarily form a blue--red decomposition of as in Definition DefBRDecompos which requires that have no edgelets in common and and their union is all of   furthermore  even if did form a blue--red decomposition  they need not be a natural one  which requires in addition that they both be natural subgraphs of  Soon  though  we shall narrow down to a key special case where is indeed a natural blue--red decomposition  Pushing down the peak is easy when is a proper subgraph of for in that case the given W diagram extends to a commutative diagram of collapse maps as shown in the diagram in Figure FigureSimplistic  A simplistic pushdown works if is a proper subgraph  In that diagram  collapse of produces  The collapse map takes the edgelets of the subgraph bijectively to the edgelets of a subgraph of which by convention is also denoted   collapse of this subgraph also produces  Similarly  collapse of produces  Compositions of collapse maps being collapse maps  we obtain a length 2 zig-zag path that cuts short the original length 4 zig-zag path --- we have successfully   pushed down the peak    The same argument works on a length zig-zag path --- which can be visualized by cutting off one of the terminal edges of a W zig-zag --- with the result that if the union of the two collapse graphs at the peak of the zig-zag forms a proper subgraph then there is a length 2 path with the same endpoints  We summarize as follows  Given a W zig-zag as notated in Figure FigureWDiagram or a length 3 zig-zag obtained from Figure FigureWDiagram by cutting off one of the terminal edges  if the path is geodesic then
Normalizing a W diagram 
 We shall also need to push down the peak of certain W diagrams in the situation where  In this situation it is convenient to first alter the W diagram to ensure that contains no edgelet of equivalently is a blue--red decomposition of as in Definition DefBRDecompos  If does contain an edgelet of then  since are proper subgraphs  the given W diagram is contained in a commutative diagram of collapse maps as shown in the diagram in Figure FigureNormalization called a normalization diagram   normalization diagram   h  A normalization diagram  The W zig-zag on the top of the diagram has the property that  The W zig-zag on the bottom of the diagram is normalized  In this diagram  subgraphs of are labelled by the same convention as described above  Since it follows that the two subgraphs and of partition the edgelets of  Motivated by this observation  we say that a zig-zag path in is normalized if at every free splitting along the path that forms a peak  the two subgraphs of whose collapses define the vertices of the path incident to form a blue--red decomposition of  The argument we have just given shows that every geodesic zig-zag path in may be replaced by a normalized zig-zag path of the same length and with the same set of valleys 
Pushdown subgraphs and baseball diagrams 
 We now turn to a more sophisticated technique for pushing down the peak of a W diagram  Consider a W diagram as notated in Figure FigureWDiagram and suppose that is a blue--red decomposition  Consider also a subgraph that satisfies the following  em  is a pushdown subgraph   is a proper  equivariant subgraph  and each natural edge of not contained in contains at least one red and one blue edgelet of that are not contained in  No requirement is imposed that a pushdown subgraph be a natural subgraph  the proof of Proposition PropPushdownInToto produces pushdown subgraphs which are not natural  Note that a pushdown subgraph can only exist if is not a natural blue--red decomposition  Given a normalized W diagram and a pushdown subgraph we may extend the W diagram to a larger commutative diagram of collapse maps called a baseball diagram  baseball diagram  as shown in Figure FigureBaseball  Certain superscripts in this diagram represent various positions on a baseball diamond  represent and bases  the pitcher s mound  and the points halfway from home plate to and bases  A baseball diagram Collapsed subgraphs of the trees in this diagram are named following a convention similar to that used earlier  Because is a pushdown subgraph  neither of the two subgraphs contains a natural edge of  It follows that neither of the two collapse maps collapses an entire natural edge of  Each of the maps therefore induces by restriction a bijection of natural vertex sets  takes each natural edge onto a natural edge inducing a bijection of natural edge sets  and is homotopic to a conjugacy relative to natural vertex sets  By restricting to natural vertex sets we therefore obtain a well-defined bijection from the natural vertex set of to the natural vertex set of which extends to a conjugacy  Since collapses are transitive  we have again successfully   pushed down the peak    without even bothering to involve home plate as in the earlier scenario  We record this as   Pushing down peaks  Given a normalized W diagram notated as in Figure FigureWDiagram and given a pushdown subgraph there exists a baseball diagram notated as in Figure FigureBaseball in which each map and induces by restriction a bijection of natural vertex sets and a bijection of natural edge sets  and is homotopic rel natural vertices to a conjugacy  By composition we therefore obtain a bijection from the natural vertex set of to the natural vertex set of that extends to a conjugacy  We emphasize that the conjugacy in the conclusion of this lemma need not be a map i e   it need not be simplicial  Nonsimplicial conjugacies resulting from Lemma LemmaPushingDown will proliferate into the proof of Proposition PropFSUContraction given in Section SectionProofFSUContraction and that proof will have a certain step dedicated to patching up this problem 
Pushing down corrugation peaks 
 One key strategy occuring in the proof of Proposition PropFSUContraction is to set up applications of Lemma LemmaPushingDown by finding pushdown subgraphs in peaks of normalized W diagrams  Of course this is impossible if the W diagram is geodesic  Nevertheless in Proposition PropPushdownInToto we will show that when combing a fold path across an arbitrary W diagram  even one which is geodesic  one can always locate enough pushdown subgraphs to carry out the pushdown process in a useful fashion  as long as the fold path is sufficiently long when measured in free splitting units  Consider a fold sequence  Consider also a zig-zag path in which may be regarded as a W diagram  We do not assume that this W diagram is a geodesic  nor even that it is normalized  but we do assume that  Consider finally a stack of four combing rectangles combined into one commutative diagram as shown in Figure FigurePullBack1 where the given fold sequence occurs as the row along the bottom of the diagram  and the W zig-zag occurs as the column along the right side  in such diagrams  in general we refer to rows by dropping subscripts  and to columns by dropping superscripts    h  A diagram of four combing rectangles over  The row along the bottom is assumed to be a fold sequence  In the column we assume that  Such a diagram can be constructed  for example  by starting with the bottom row and right side  and applying Propositions PropCBC then PropCBE then PropCBC then PropCBE in that order  to comb the given fold sequence along each of the four edges of the given zig-zag path  We will also encounter such diagrams constructed by other combing processes involving concatenation and deconcatenation of combing rectangles  We can visualize Figure FigurePullBack1 as a piece of corrugated metal  The row forms a peak of the corrugation which we wish to push down all at once  by parallel applications of Lemma LemmaPushingDown  Of course this is impossible in general  for instance when the column is a geodesic path in  We now describe a process which allows us to push down the corrugation peak along the row  at the expense of throwing away the portion of the diagram to the right of the column that is depicted in Figure FigurePullBack1  The next lemma says that this is always possible as long as the bottom row has sufficiently many free splitting units between and  As a consequence  the columns for are not geodesic paths in because even when the on the far right is geodesic  We thus obtain a key indicator of   hyperbolic   behavior  local curve shortening  The following proposition introduces the constant which is needed for the proof of Proposition PropFSUContraction   break For any commutative diagram as in Figure FigurePullBack1 if the number of free splitting units between and is then there is a commutative diagram such that the following hold  the top and bottom horizontal rows are the same foldable sequences as the top and bottom rows of Figure FigurePullBack1 between the and columns  the and rows are foldable sequences  for each the function is a  nonsimplicial  conjugacy between and   and the top and bottom horizontal rectangles are combing rectangles obtained from the top and bottom combing rectangles of Figure FigurePullBack1 between the and columns by application of Composition of combing rectangles LemmaCombingComp  There are three steps to the proof  normalization  pullback  and pushdown  skip Step 1  Normalization  Knowing that and knowing for each that are the union of the edgelets mapped to respectively  under the foldable map it follows that  If the column is already normalized  that is if is a blue--red decomposition  then the same is true of and so each column is normalized and we pass directly to Step 2  Otherwise  let us assume that have some edgelets in common  The union of these edgelets is a subgraph with nondegenerate components which by abuse of notation we denote  It follows that for each the graphs have some edgelets in common  these being the edgelets that are mapped to by the foldable map   their union forms a subgraph  We may now carry out the normalization process depicted in Figure FigureNormalization in parallel as varies from to  The resulting normalization diagrams  commutative diagrams of collapse maps  are shown in Figure FigureNormalizationWZigZag   h   captio nParallel normalization diagrams associated to the W zig-zags from to in Figure FigurePullBack1    break We claim that for each of the seven arrows in Figure FigureNormalizationWZigZag as varies from to we obtain a combing rectangle  One can visualize this statement as a description of a 3-dimensional commutative diagram where the normalization diagrams are lined up in parallel vertical planes  connected up by six foldable sequences  one for each of the six positions in the normalization diagram  and seven combing rectangles  one for each of the seven arrows   The claim is true by hypothesis for the four arrows on the top of the diagram  To obtain the combing rectangle with vertical arrows from to since is the inverse image of under the foldable map by Proposition PropCBC the collapse maps fit together in a combing rectangle as follows  The two combing rectangles with vertical arrows from to and from to respectively  are obtained by two applications of Lemma LemmaCombingDecomp Decomposition of combing rectangles the first application using the to and the to combing rectangles  and the second using the to and the to combing rectangles  This proves the claim  The outcome of the claim is a commutative diagram of the form shown in Figure FigureNormalOutcome in which the top and bottom rectangles are the same combing rectangles as in Figure FigurePullBack1  By construction  see Figure FigureNormalization   the zig zag path on the right side of Figure FigureNormalOutcome is normalized  completing Step 1   captio nThe outcome of normalizing Figure FigurePullBack1 using the parallel normalization diagrams of Figure FigureNormalizationWZigZag   Step 2  Pullback  This is the central argument where the concepts of free splitting units are used to their maximal effect  Having carried out Step 1  we may now go back to Figure FigurePullBack1 and assume that each column is a normalized W zig-zag  In other words  for each we have a blue--red decomposition  Let be the number of free splitting units along the bottom row of the diagram between and and choose a sequence so that for each there is free splitting unit between and  By hypothesis we have  We prove that the blue--red decomposition is not natural  Arguing by contradiction  suppose that is natural  By Definition DefBRDecompos it follows that is natural for  By Lemma LemmaBRNatural the interval breaks into no more than subintervals on each of which the complexity of is constant  By Definition DefLessThanOneFSU on each of these subintervals there is free splitting unit  and so each of these subintervals contains at most one entry from the sequence  It follows that contradicting the hypothesis   subparagrap hRemark   The previous version of this paper contained an invalid argument  starting from the statement that is natural for  The erroneous statement  which incorrectly exploited said that if one expands by blowing up each vertex pulling the blue and red edges at apart to form two vertices connected by a gray edge  then the resulting tree with -action is a free splitting  The error is that the inserted gray edges might have nontrivial stabilizers  Correcting this error led to a revamping of the theory of free splitting units presented in Section SectionFSU  In particular  the concept of an   invariant  natural  blue--red decomposition   in Definition DefBRDecompos and the diameter bounds of Lemma LemmaBRNatural are new to this version of the paper and were concocted to correctly exploit the subgraphs  skip Step 3  Pushdown  Having carried out Steps 1 and 2  we assume now that we have a commutative diagram as shown in Figure FigurePullBack2 in which each column is normalized and the blue--red decomposition is not natural  It follows that has a natural edge which contains both red and blue edgelets  Using this  we shall produce the commutative diagram needed for the conclusion of Proposition PropPushdownInToto  The argument will be a somewhat more intricate version of the parallel normalization process used in Step 1  using parallel baseball diagrams instead   h  Each of the four horizontal rectangles is a combing rectangle  We assume that every column is a normalized W zig-zag and that the tree has an edge containing both red and blue edgelets  Define a proper -equivariant natural subgraph to be the complement of the orbit of and so every natural edge of not in contains both a red and a blue edgelet  By decreasing induction on define an -equivariant subgraph to be the inverse image of under the foldable map  ignoring degenerate components as usual   equivalently is the inverse image of under  It follows that the subgraphs are proper for all  We claim that for the graph is a pushdown subgraph of  To prove this  given a natural edge such that we must find a red and a blue edgelet in neither of which is in  Foldable maps take natural vertices to natural vertices and natural edges to nondegenerate natural edge paths  so the image of under the foldable map is a nondegenerate natural edge path denoted  Since it follows that and so contains a natural edge not in which therefore has both a red and a blue edgelet  Since natural edges not in have interior disjoint from it follows that contains a red and a blue edgelet neither of which is in  By pulling back under the foldable map we obtain a red and a blue edgelet in neither of which is in  We now apply Lemma LemmaPushingDown in parallel to each column of Figure FigurePullBack2 for  The resulting baseball diagrams  commutative diagrams of collapse maps  are shown in Figure FigureParameterizedBaseball  compare Figure FigureBaseball  Lemma LemmaPushingDown also produces conjugacies and and hence conjagacies  What we are still missing  however  are the conclusions of Proposition PropPushdownInToto concerned with combing rectangles and commutativity   h  The baseball diagram associated to the W-diagram from to  We claim that for each of the nine arrows in Figure FigureParameterizedBaseball as varies from to we obtain a combing rectangle  As in Step 1  one visualizes this as a 3-dimensional commutative diagram by lining up the baseball diagrams in parallel vertical planes  connected up by eight foldable sequences  one for each of the eight positions in the baseball diagram  and nine combing rectangles  one for each of the nine arrows   The claim is true by hypothesis for the four arrows on the top of the diagram  For the arrow from 2nd base to the pitcher s mound  since is the inverse image of under the foldable map by Proposition PropCBC the collapse maps fit together in a combing rectangle Notice that for each the subgraph is proper  because any natural edge not in contains a blue edgelet not in which is also not in  Similarly the subgraph is proper  By Proposition PropCBC since is the inverse image of and since is the inverse image of we obtain combing rectangles Rectangles II and III do not correspond to any of the nine arrows in the baseball diagram  but to invisible arrows going from 2nd base to the point halfway between 1st base and home plate and from 2nd base to the point halfway between 3rd base and home plate  For the arrows going from the pitcher s mound to the points halfway between 1st and home and halfway between 3rd and home  apply Lemma LemmaCombingDecomp Decomposition of combing rectangles first to combing rectangles II and I and then to combing rectangles III and I  to obtain combing rectangles where we follow the same notation convention for subgraphs of as used in the original baseball diagram Figure FigureBaseball  For the arrows going from 1st base and 3rd base to the points halfway home  applying Lemma LemmaCombingDecomp Decomposition of combing rectangles to combing rectangle II and the 2nd base to 3rd base combing rectangle  and then to combing rectangle III and the 2nd base to 1st base combing rectangle  we obtain combing rectangles Applying Lemma LemmaCombingComp Composition of combing rectangles by composing the two combing rectangles corresponding to the arrows along the 1st base foul line in Figure FigureParameterizedBaseball we obtain the combing rectangle from the row to the row needed for the conclusion of Proposition PropPushdownInToto  Similarly  by composing the two combing rectangles corresponding to the arrows along the 3rd base foul line we obtain the combing rectangle from the row to the row  To complete Step 3 and the proof of the proposition  it remains to construct the commutative diagram of conjugacy maps in the conclusion of the lemma  For this purpose it suffices to replace combing rectangles IV and V by commutative diagrams of conjugacies of the form for then defining we will be done  While Lemma LemmaPushingDown produces conjugacies for each if that lemma is used crudely there is no guarantee that these conjugacies will form commutative diagrams as needed  With a little care in how Lemma LemmaPushingDown is applied we can get the needed guarantee  We construct diagram in detail  the construction of being similar  The construction is by induction  starting from the column on the far right and moving leftward  First apply Lemma LemmaPushingDown to produce a conjugacy so that the restrictions of and to natural vertex sets are the same  Proceeding by decreasing induction on suppose that for some we have produced all the conjugacies from column to in diagram making that portion of the diagram commute  and so that the restrictions to natural vertex sets of the conjugacies in diagrams IV and are the same from column to column  We must choose the conjugacy so as to fill in a commutative diagram of -equivariant functions where are the foldable maps in Rectangle IV  and where the restrictions of and to natural vertex sets are the same  This tells us how to define on natural vertex sets  Consider a natural edge  By Lemma LemmaPushingDown its image is a natural edge whose endpoints are the images of the endpoints of  The foldable map is injective on the conjugacy is injective on and we have the following equation of subsets  The foldable map is injective on the natural edge and therefore has a homeomorphic inverse and so we can define This completes Step 3 and the proof of Proposition PropPushdownInToto   subsectio nProof of Proposition PropFSUContraction    subparagrap hPrologue   Consider a fold sequence over a free splitting and an augmented projection diagram of maximal depth as notated in Figure FigureMaxProjDiagram of Section SectionStatmentFSUContraction whose top row has the fold sequence as a terminal segment  Let be the number of free splitting units between and  Using the constant from Proposition PropPushdownInToto we list every term of the back greedy subsequence of this fold sequence as where  Thus is the greatest integer such that there are exactly free splitting units between and for each  Emphasizing only those  s with subscripts from the list and assigning them a superscript for later purposes  we may write the augmented projection diagram in the form where the foldable map may just be the identity map  skip Consider also a vertex and a geodesic path from to in  We shall assume here that   the case that will be considered in the epilogue  If the path from to starts with an expansion of prefix the path with an improper collapse  The result in a zig-zag path of the form where or and  The peaks along this zig-zag are the even terms strictly between and the first such peak being  For each peak along this path  applying Lemma LemmaRedBlueUnion together with the assumption that it follows that the peak is the union of its two collapse graphs  The number of peaks along this zig-zag path equals which equals if is even and if is odd  By combing the foldable sequence across each collapse or expansion of the zig-zag path alternately applying Combing by Collapse PropCBC and Combing by Expansion PropCBE and by stacking the resulting combing rectangles atop the augmented projection diagram  we obtain The Big Diagram  Step 0  shown in Figure FigureBigDiagram0  The Big Diagram  Step 0   hfill break We emphasize the columns indexed by  Each horizontal row is a foldable sequence  and the rectangle between any two rows is a combing rectangle  The bottom row is a fold sequence  and the row from to is a fold sequence  Each peak of the column is the union of its two collapse graphs  Rows in this and subsequent diagrams will be indicated by stripping off subscripts  for instance the    row   refers to the foldable sequence   similarly  columns are indicated by stripping off superscripts  Since each peak of column between rows and is the union of its two collapse graphs  it follows that each peak of each column between rows and is the union of its two collapse graphs  because the two collapse graphs at a column peak are the pullbacks under the foldable map of the two collapse graphs at the corresponding column peak  Proposition PropFSUContraction will be proved by explicitly transforming the Big Diagram  Step 0 into a projection diagram from onto of an appropriate depth needed to verify the conclusions of the proposition  This transformation is primarily an induction that uses the pushdown tools of Section SectionPushingDownPeaks followed by an epilogue which uses the pushdown tools one more time  As the proof progresses we will consider the truncated fold sequences for increasing values of but such truncation will not affect measurements of free splitting units between and as long as  see the remark following Definition DefGeneralFSU   subparagrap hInduction   We explain in detail how to carry out the first step of the induction  Under our assumption that the column of the Big Diagram  Step 0 has a peak at  Assuming furthermore that equivalently then is defined and there are free splitting units between and  We may therefore apply Proposition PropPushdownInToto to the portion of the diagram between the and rows as follows  trim away all portions of the Big Diagram  Step 0 that lie to the right of the column and below the row  and use the conclusion of Proposition PropPushdownInToto to replace the combing rectangles between the and rows  to get the Big Diagram  Step 0 1  shown in Figure FigureBigDiagram0point1   h  The Big Diagram  Step 0 1  The rectangles of the Big Diagram  Step 0 1 between the and rows and between the and rows are combing rectangles  Each is a conjugacy  possibly nonsimplicial  Now we must pause to patch things up in order to make these conjugacies simplicial  We claim that  by an operation of equivariant subdivision of simplicial structures and re-assignment of barycentric coordinates on edgelets  carried out over all free splittings in Big Diagram  Step 0 1  but without changing any of the functions  we may assume that the conjugacies are indeed simplicial maps  Here are the details of this operation   break Consider first the conjugacy  We may subdivide at the pre-image of the vertex set of and simultaneously subdivide at the image of the vertex set of to obtain new equivariant vertex sets on which is a bijection  it is also a bijection of edgelets  although it may not yet respect barycentric coordinates  We may then reassign the barycentric coordinates on one edgelet of in each -orbit  and move these coordinates around by the -action  to obtain a new simplicial structure on  We may then push these coordinates forward under the map to obtain new barycentric coordinates on the edgelets of  Having carried out these operations  the map is now a simplicial conjugacy  Now we move left one step  by a similar subdivision re-assignment on pulling back vertices and barycentric coordinates under the foldable map we may assume that this map is simplicial  Similarly  by a subdivision re-assignment on we may assume that the foldable map is simplicial  We have now verified that in the commutative diagram the top  bottom  and right sides are simplicial maps  by commutativity  the left side is therefore automatically simplicial  Now we continue to move left  by similar subdivisions re-assignments carried out one at a time on the trees in rows and moving to the left one at a time from the last map in each row  we may assume that these rows are simplicial  having done this  by commutativity each of the maps is automatically a simplicial conjugacy  Now we move up  by similar subdivisions re-assignments carried out one at a time on the trees in rows starting with the collapse maps and moving upward  we may assume that each vertical arrow above row is simplicial  having done this  each of the horizontal arrows from row upward and between columns and is automatically simplicial  Now  from we move to the right  by similar subdivisions re-assignments we may assume that each of the maps is simplicial  Finally  in a similar manner moving down from row to row then moving right from to we have proved the claim  Knowing now that we have simplicial conjugacies and using commutativity of the rectangle between rows and we may identify and via the map replacing these two rows by a single row as shown in The Big Diagram  Step 1  In summary  when and we have completed the first iteration of the induction argument  starting from the Big Diagram Step 0  by applying Proposition PropPushdownInToto trimming away everything to the right of column and below row and replacing everything between rows and we get the Big Diagram Step 0 1  and then by subdividing and re-assigning barycentric coordinates we may assume that the conjugacies between rows and are simplicial  Identifying rows and we obtain the Big Diagram Step 1  shown in Figure FigureBigDiagram1  In the process we have decreased by the lengths of all vertical zig-zag paths and the number of combing rectangles between the and rows  Observe that the conjugacy class of the free splitting and the equivalence class of the fold sequence have not been altered by these subdivision re-assigmnent operations   h  The Big Diagram  Step 1 To complete the inductive step there is one last thing to do  namely to verify that along the zig-zag path in column on the right side of the Big Diagram  Step 1  each peak is the union of its two collapse graphs  This is evident for each peak from upward  since the collapse maps and collapse graphs are unchanged at those peaks from the Big Diagram  Step 0  For the peak at one of the collapse graphs is unchanged from the Big Diagram  Step 0  namely that of the map  For the collapse graph of the map we use the part of the conclusion of Proposition PropPushdownInToto which tells us that the combing rectangle in the Big Diagram Step 1 between the and rows is obtained by an application of Composition of combing rectangles Lemma LemmaCombingComp using the combing rectangle in the Big Diagram Step 0 between the and rows and between the and columns  What Lemma LemmaCombingComp allows us to conclude is that the collapse graph of the Step 0 map is contained in the collapse graph of Step 1 map  The union of the two collapse graphs of in the Big Diagram  Step 1 is therefore still equal to  skip Remark  The reader may wonder why the initial normalization step was necessary in the proof of Proposition PropPushdownInToto   we could have started with a normalized zig-zag geodesic on the right side of the Big Diagram  Step 0  This would imply that the column in that diagram is normalized at  Nonetheless it is possible that the column in the Big Diagram  Step 1 is not normalized at because the collapse graph for may be strictly larger than the collapse graph for  If so then the normalization step of Proposition PropPushdownInToto is inescapable in the next step of the induction  skip We now describe the induction step in general  From the hypothesis we have  If then we refer to the Epilogue below  Otherwise  under the assumption we have and so we may repeat the above argument inductively a total of times  removing the corrugation peaks one at a time  For each at the step of the induction we do the following  At the start of the step we have the Big Diagram  Step analogous to the Big Diagram Step but with in place of and in place of and with a stack of combing rectangles between the and rows  We trim away the portion of the diagram to the right of column on or above row and below row  We replace the four combing rectangles between rows and by two combing rectangles and a commutative diagram of conjugacies  We carry out a subdivision re-assignment operation which allows us to assume that the conjugacies are simplicial  We then collapse the commutative diagram of conjugacies  identifying its two rows into a single row  We have now produced the Big Diagram  Step with a stack of combing rectangles between the and rows  we have decreased by the lengths of all vertical zig-zag paths between the and rows and decreased by the number of corrugation peaks  Finally we verify that each peak along column is still the union of its two collapse graphs  At each stage of the induction  we have not altered the conjugacy class of nor the equivalence class of   subparagrap hEpilogue   If when the induction process stops we have backed up to column where and there are no remaining corrugation peaks above row  We obtain the Big Diagram  Step a not-so-big diagram that comes in two cases  The Case 1 diagram occurs when is even  and it has two combing rectangles between row and row   see Figure FigureNotSoBigCase1  The Case 2 diagram occurs when is odd and has only one such combing rectangle  see Figure FigureNotSoBigCase2  In each of these diagrams  the conjugacy class of and the equivalence class of the fold sequence have not been changed from the initial setup in the Prologue  Case 1  a collapse--expand from to Case 2  a collapse from to  If then  starting from the augmented projection diagram depicted in the prologue  and depending on the nature of the geodesic from to we proceed as follows  If and there is a collapse we comb the row along this collapse to obtain the Case 2 diagram with and  If and there is an expansion then we append an improper collapse to get a length 2 collapse--expand zig-zag and we comb the row along this collapse--expand to obtain the Case 1 diagram with similar notation changes  If and there is a collapse--expand from to then  combing the row along this collapse--expand  we produce the Case 1 diagram with similar notation changes  Finally  if and there is an expand--collapse from to then combing the row along this expand--collapse  we obtain the Case 3 diagram in Figure FigureNotSoBigCase3  Case 3  an expand--collapse from to  We now finish off Case 1  afterwards we shall reduce Cases 2 and 3 to Case 1  In the Case 1 diagram  trim off everything to the right of column on or above row and below row to obtain the diagram shown in Figure FigureCaseOneTrimmed which has a corrugation peak along the row  We must consider two subcases  depending on whether the peak of the W zig-zag in column is the union of its two collapse graphs   h  The Case 1 diagram  trimmed down  Suppose first that in Figure FigureCaseOneTrimmed  For each in the tree which is the peak of the W zig-zag in column the union of its two collapse graphs is a proper subgraph  that subgraph being the inverse image of under the foldable map  We may therefore carry out the simplistic pushdown depicted in Figure FigureSimplistic in parallel as varies from to resulting in a diagram of the form depicted in Figure FigureCaseOnePushedDown   captio nThe result of a parallel simplistic pushdown on Figure FigureCaseOneTrimmed in the case when  Concatenating the upper two combing rectangles into a single one  and the same for the lower two  we obtain a projection diagram   In Figure FigureCaseOnePushedDown the row is obtained by applying Proposition PropCBC Combing by collapse using the collapse graphs and the middle two combing rectangles are each obtained by an application of Lemma LemmaCombingDecomp Decomposition of combing rectangles  By applications of Lemma LemmaCombingComp Composition of combing rectangles we may compose the lower two and the upper two combing rectangles of Figure FigureCaseOnePushedDown to produce a depth projection diagram from to and the proof of Proposition PropFSUContraction is complete in this case  Suppose next that in Figure FigureCaseOneTrimmed  From the hypothesis of Proposition PropFSUContraction there are free splitting units along the bottom row of the diagram between and  Let be the largest integer such that there are free splitting units between and from which it follows that there are exactly free splitting units between and  We may now carry out one last iteration of the Induction  Applying Proposition PropPushdownInToto remove all portions of the diagram in Figure FigureCaseOneTrimmed to the right of column above the row  and below the row  and replace the four combing rectangles by two combing rectangles and a commutative diagram of conjugacies  After an operation of subdivision and re-assignment of barycentric coordinates  we may assume that the conjugacies are all simplicial  After collapsing the commutative diagram of conjugacies  identifying its two rows to a single row  we obtain the diagram depicted in Figure FigureOneLastTime in which the conjugacy class of the free splitting and the equivalence class of the fold sequence remain unchanged  This is the desired projection diagram from the free splitting to the fold sequence which completes the proof of Proposition PropFSUContraction in case 1   captio nThe projection diagram resulting from one last iteration of the Induction carried out on Figure FigureCaseOneTrimmed in the case when    subparagrap hRemark   As was remarked earlier regarding the Big Diagram  Step 1 depicted in Figure FigureBigDiagram1 in the context of case 1 depicted in Figure FigureOneLastTime the initial normalization step in the proof of Proposition PropPushdownInToto cannot be avoided  because there is no guarantee that the column is normalized at  skip We reduce case 2 to case 1 by producing a case 1 diagram  just attach an improper combing rectangle to the top of the case 2 diagram  by defining the foldable sequence to equal the foldable sequence and defining for each an improper collapse map which is just the identity map  We also reduce case 3 to case 1  First trim away everything in the Case 3 diagram to the right of the column  on or above the row  and below the row  Next  apply Lemma LemmaCombingComp Composition of combing rectangles to the two combing rectangles between the row and the row  concatenating them into a single combing rectangle  Finally  attach an improper combing rectangle to the top of the diagram as in case 2  The result is a case 1 diagram  completing the reduction  ef cprim e   ef cprim e    providecomman d bysame   avevmode hbox to3e m hrulefill  hinspace   providecomman d MR   relax ifhmode unskip space fi MR    providecomman d MRhref  2    href http   www ams org mathscinet-getitem mr  1   2     providecomman d href  2   2   bibitem AS11  AramayonSouto FreeSplittings  J  Aramayona and J  Souto  Automorphisms of the graph of free splittings Michigan Math  J  60  2011   no  3  483--493   bibitem BF91  BestvinaFeighn bounding  M  Bestvina and M  Feighn  Bounding the complexity of simplicial group actions on trees Invent  Math  103  1991   no  3  449--469   bibitem BF11  BestvinaFeighn FFCHyp   bysame  Hyperbolicity of the complex of free factors arXiv 1107 3308  2011   bibitem BFH97  BFH laminations  M  Bestvina  M  Feighn  and M  Handel  Laminations  trees  and irreducible automorphisms of free groups Geom  Funct  Anal  7  1997   215--244   bibitem BFH00  BFH TitsOne   bysame  p h The Tits alternative for  I  Dynamics of exponentially-growing automorphisms     Ann  of Math  151  2000   no  2  517--623   bibitem Hat95  Hatcher HomStability  A  Hatcher  Homological stability for automorphism groups of free groups Comment  Math  Helv  70  1995   no  1  39--62   bibitem HM  HandelMosher distortion  M  Handel and L  Mosher  p h Lipschitz retraction and distortion for subgroups of     To appear  Geom  and Top  2012  Preprint s carXiv 1009 5018    bibitem HV98  HatcherVogtmann FreeFactors  A  Hatcher and K  Vogtmann  The complex of free factors of a free group Quart  J  Math  Oxford Ser   2  49  1998   no  196  459--468   bibitem Man05  Manning pseudocharacters  J  Manning  Geometry of pseudocharacters Geometry and Topology 9  2005   1147--1185   bibitem MM99  MasurMinsky complex1  H  Masur and Y  Minsky  p h Geometry of the complex of curves  I  Hyperbolicity    Invent  Math  138  1999   no  1  103--149   bibitem MMS10  MMS Splitting  H  Masur  L  Mosher  and S  Schleimer  On train track splitting sequences Preprint arXiv 1004 4564  2010   bibitem Sch06  Schleimer CurveComplexNotes  S  Schleimer  Notes on the complex of curves Preprint s chttp   www warwick ac uk ˜masgar Maths notes pdf   2006   bibitem SS  SabalkaSavchuk NotHyperbolic  L  Sabalka and D  Savchuk  p h On the geometry of a proposed curve complex analogue for     Preprint s carXiv 1007 1998    bibitem Sta83  Stallings folding  J  Stallings  Topology of finite graphs Inv  Math  71  1983   551--565   bibitem SW79  ScottWall  P  Scott and C  T  C  Wall  Topological methods in group theory Homological group theory  Proceedings of Durham symposium  Sept  1977  London Math  Soc  Lecture Notes  vol  36  1979  pp  137--203  em back greedy subsequence  51 em baseball diagram  61 space em collapse  6  8   se e Glossary   85   subitem map   se e Glossary under Map   85   subitem proper and improper  9 em combing rectangle  27 em conjugacy  1  5   se e Glossary   85  space em derivative  14 em direction  13 space em edgelet  6   se e Glossary   85   subitem of a foldable map  15 em expansion  8   se e Glossary   85  space em fold  18  subitem full  18  subsubitem improper  18  subsubitem proper  18  subitem type IA  18  subitem type IIIA  18 em fold factorization  21 em fold map  18   se e Glossary under Map   85  em fold path  21  		 se e Glossary under Foldable sequence   85  em fold sequence  20  		 se e Glossary under Foldable sequence   85   subitem equivalence  21 em foldable map  14   se e Glossary under Map   85  em foldable sequence  27   se e Glossary   85  em free splitting  1  4 em free splitting unit  50 em front greedy subsequence  50 space em gate  14 space em map  5   se e Glossary   85   subitem collapse  1  6  subitem fold  18  subitem foldable  14 space em natural cell structure  5   se e Glossary   85  em natural core  8 em normalization diagram  60 space em projection diagram  28  subitem augmented  54 space em W diagram  59 space em zig-zag  10   se e Glossary   85 
Glossary
 em Collapse and expansion    collapse|see  Glossary     expansion|see  Glossary    Inverse relations amongst free splittings  denoted and respectively  defined so that is obtained from by collapsing to a point each component of some proper  equivariant  natural subgraph of  em Conjugacy    conjugacy|see  Glossary    An equivariant homeomorphism between free splittings  which need not be a map  em Edgelet    edgelet|see  Glossary    A 1-cell of some given simplicial structure on a tree  The term is also used in a relative sense --- given a foldable map and an edgelet of an -edgelet of is any edgelet of mapped by to  em Foldable sequence    foldable sequence|see  Glossary    A sequence of maps of free splittings in which any composition of any subinterval of that sequence is a foldable map  em A fold sequence  fold sequence|see  Glossary under Foldable sequence    is a special kind of foldable sequence in which each map is a fold  em A fold path  fold path|see  Glossary under Foldable sequence    is the sequence of vertices in obtained from the conjugacy classes of the free splittings along a fold sequence  em Map    map|see  Glossary    An equivariant simplicial function between free splittings  Important types of maps include  em A collapse map  collapse map|see  Glossary under Map    collapses to a point each edge in an equivariant subgraph  em A foldable map  foldable map|see  Glossary under Map    is injective on each natural edge  and has gates at each natural vertex  em A fold map  fold map|see  Glossary under Map    is a foldable map defined by identifying initial segments of some pair of natural edges with the same initial vertex  em Natural cell structure    natural cell structure|see  Glossary    Every tree with no isolated ends and no valence vertices --- in particular every free splitting of a free group of rank --- has a natural cell structure  whose vertices are the points that  locally  separate the tree into some number of components  A natural subgraph is a subcomplex of the natural cell structure  Any other cell structure on the graph is a refinement of the natural cell structure  em Zig-zag path    zig-zag|see  Glossary    An edge path in which alternates between expansions and collapses  Examples include all geodesic edge paths in  