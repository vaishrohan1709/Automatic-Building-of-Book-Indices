 Product formula for -adic epsilon factors Tomoyuki Abe  Adriano Marmora Let be a smooth proper curve over a finite field of characteristic  We prove a product formula for -adic epsilon factors of arithmetic -modules on  In particular we deduce the analogous formula for overconvergent -isocrystals  which was conjectured previously  The -adic product formula is the equivalent in rigid cohomology of the Deligne-Laumon formula for epsilon factors in -adic   etale cohomology  for  One of the main tools in the proof of this -adic formula is a theorem of regular stationary phase for arithmetic -modules that we prove by microlocal techniques   setcounte rtocdepth  2 
Introduction
 Inspired by the Langlands program  Deligne suggested that the constant appearing in the functional equation of the -function of an -adic sheaf  on a smooth proper curve over a finite field of characteristic should factor as product of local contributions  later called epsilon factors  at each closed point of the curve  He conjectured a product formula and showed some particular cases of it  cf   Del sem  This formula was proven by Laumon in the outstanding paper Lau  The goal of this article is to prove a product formula for -adic epsilon factors of arithmetic -modules on a curve  This formula generalizes the conjecture formulated in Marmora Facteurs epsilon for epsilon factors of overconvergent -isocrystals  and it is an analog in rigid cohomology of the Deligne-Laumon formula  Let us give some notation  In this introduction we simplify the exposition by assuming more hypotheses than necessary  and we refer to the article for the general statements  Let be a finite field of characteristic and let be its cardinality  Let be a smooth  proper and geometrically connected curve over  We are interested in rigid cohomology Berthelot prepub on which is a good -adic theory in the sense that it is a Weil cohomology  The coefficients for this theory are the overconvergent -isocrystals  they play the role of the smooth sheaves in -adic cohomology  or vector bundles with  flat  connection in complex analytic geometry  These coefficients are also known in the literature as -adic differential equations  As their -adic and complex analogs  the overconvergent -isocrystals form a category which is not stable under push-forward in general  Berthelot Ber rigD inspired by algebraic analysis  proposed a framework to remedy this problem by introducing arithmetic - -modules  shortly - -modules  and in particular the subcategory of holonomic modules  see BerInt for a survey  Thanks to works of many people    e g    Caro courbes Cr3      we have a satisfactory theory  at least in the curve case  We note that another approach to -adic cohomologies has been initiated by Mebkhout and Narvaez-Macarro MeNa and is giving interesting developments  for example see ArMe  Although it would certainly be interesting to transpose our calculations into this theory  we place ourselves exclusively in the context of Berthelot s arithmetic -modules throughout this paper  Nevertheless  we point out that Christol-Mebkhout s results in the local theory of -adic differential equations are indispensable both explicitly and implicitly in this article  The local theory of arithmetic -modules has been developed by Crew  cf   Cr3 Cr  and we will use it extensively in our work  To state the -adic product formula let us review the definitions of local and global epsilon factors for holonomic -modules  The Poincaré duality was established for overconvergent -isocrystals in the works of Berthelot BePoinc Crew Crew ens and Kedlaya KeDuke and for the theory of -modules by the first author Abe3 based on the results of Virrion Vir  This gives a functional equation for the -function  Caro Caro courbes Etesse-LeStum LE  of see  Ssb main  The constant appearing in this functional equation is where is the structural morphism  and it is called the global epsilon factor of  The local epsilon factor of an arithmetic -module at a closed point of is defined up to the choice of a meromorphic differential form on  To define it  we restrict to the complete   trait  of at  To define the local factors we consider a localizing triangle  cf    anotherloctriag   hence  by linearity  it remains to define the epsilon factors for punctual modules and for free differential modules on the Robba ring with Frobenius structure  The former case is explicit  the latter was done in Marmora Facteurs epsilon via the Weil-Deligne representation attached to free differential modules by the -adic monodromy theorem  The product formula  Theorem Product formula  states that for any holonomic - -module on we have where is the genus of denotes the generic rank of is the set of closed points of and is a meromorphic differential form on  This formula can be seen as a multiplicative generalization of Grothendieck-Ogg-Shafarevich formulas in rigid cohomology  The proof of  intro PF  starts by following the track of Laumon  a geometric argument  see  reduces to prove the fundamental case where and is an -isocrystal overconvergent along a closed set of rational points of  by refining the argument we can even take cf    By saying that is an -isocrystal  we mean that it is an arithmetic -module corresponding to an -isocrystal via the specialization map  see the convention  Sconventionocisoc  In order to conclude  we need four components   1  a canonical extension functor from the category of holonomic - -modules on the formal disk to that of holonomic - -modules on the projective line  overconvergent at    2  the proof of  eqre fintro PF  for -modules in the essential image of this functor   3  the   principle   of stationary phase  for modules whose differential slopes at infinity are less than    4  an exact sequence in the style   nearby-vanishing cycles   for certain kinds of -modules  The first component is provided by the work of Crew Cr extending the canonical extension of Matsuda for overconvergent -isocrystals  The second is technical but not difficult to achieve  The third is the deepest among these four  and a large part of this paper is devoted to it  This   principle   can roughly be described by saying that it provides a description of the behavior at infinity of the Fourier-Huyghe transform of in terms of local contributions at closed points in where is singular    i e    the characteristic cycle of does contain a vertical component at cf   paragraph stabledef  These   local contributions   are called local Fourier transforms  LFT  of and one of the key points of our work is to provide a good construction of them  Here  we differentiate from the work of Laumon  who used vanishing cycles to construct the local Fourier transform of an -adic sheaf  A definition of local Fourier transform has been given by Crew following the classical path  take the canonical extension of a holonomic - -module at then apply the Fourier-Huyghe transform  and finally restrict around  However  we need more information on the internal structure of LFT  and therefore  we redefine it  Our approach is based on microlocalization inspired by the classical works of Malgrange Malgrange Eq diff and Sabbah Sabbah isomono  Yet  there are many more technical difficulties in our case because we need to deal with differential operators of infinite order  We note that the definition is still not completely local in the sense that it uses the canonical extension and the Frobenius is constructed by global methods  Once we have established some fundamental properties of LFT  the proof of the regular stationary phase is analogous to that of Sabbah Sabbah isomono in the classical case  see also Lopez Microloc for its generalizations   The fourth component is proved using an exact sequence of Crew Cr Noot-Huyghe s results on Fourier transform  and the properties of cohomological operations proven in Abe3  The end of the proof of  eqre fintro PF  is classical and it follows again Laumon  although there are still some differences from the -adic case that we have carefully pointed out in  Ssb proof gen case  In particular  in   loc   cit    we detail the proof of a determinant formula for the -adic epsilon factor  This -adic formula gives a differential interpretation of the local epsilon factors and promises to have new applications  Indeed  in  Sexplicitcalcfrob we give an explicit description of the Frobenius acting on the Fourier-Huyghe transform  This might provide explicit information on the -adic epsilon factors  and moreover have arithmetic spin-offs  For example  in the case of a Kummer isocrystal  by carrying out this calculation and applying the product formula we can re-prove the Gross-Koblitz formula  This and related questions will be addressed in a future paper  Concerning -adic theory  we point out that Abbes and Saito AS have recently given an interesting new local description of LFT as well as an alternative proof of Laumon s determinant formula for -adic representations satisfying a certain ramification condition  Finally  regarding Langlands program for -adic coefficients  we mention the recent preprint Abe4 where the -adic product formula is used to show the equivalence between the  conjectural  -adic Langlands correspondence for over function fields and Deligne s hope for petits camarades cristallins cf   and also  skip After this introduction  this article is divided into seven sections  Here  we briefly describe their content  more information can be found in the text at the beginning of each section and subsection  The aim of the first section is to define the characteristic cycles of holonomic -modules on curves over the field  which is supposed here only of characteristic   and prove some relations with the microlocalizations  For this  we prove a level stability theorem using microlocal techniques of Abe  The section starts with a short survey of microdifferential operators of   loc   cit   The second section begins the study of local Fourier transforms for holonomic -modules  This section is the technical core of the paper  We start in  SCrewreview by a review of Crew s theory of arithmetic -modules on a formal disk  then we study in  Sanalye the relations between microlocalization and analytification of -modules  This gives several applications  namely the equality between Garnier s and Christol-Mebkhout s definitions of irregularity   Sapplithem  We finish the section by giving an alternative definition of local Fourier transform  except for the Frobenius structure  in  Ssecdefforloc  We will see in  Ssection4 that this LFT coincides with that of Crew and we will complete the definition in  Ssection5 by endowing it with the Frobenius structure  The third section reviews the cohomological operations on arithmetic -modules  In particular  in  Scohoprev we recall the results of Abe3 which are used in this paper  and in  Ssecgeforev we review the global Fourier transform of Noot-Huyghe  The fourth section is devoted to the regular stationary phase  In  Ssecgeomcalc we establish some numerical results analogous to those of Laumon for perverse -adic sheaves  In  Ssecregstfo we prove the stationary phase for regular holonomic modules on the projective line  It is in the fifth section that we finally implement the Frobenius in the theory  In  Ssecfroblocfou we endow the local Fourier transform with the Frobenius induced by that of the global Fourier transform via the stationary phase isomorphism  In section  Sexplicitcalcfrob we explicitly describe the Frobenius on the naive Fourier transform  The sixth section provides a key exact sequence for the proof of the product formula  This sequence should be seen as an analog of the exact sequence of vanishing cycles appearing in Laumon s proof of the -adic product formula  The section begins with a result on commutation of the Frobenius in  Ssecommfrob and we then prove the exactness of the sequence in  Ssecanexse  Finally  in the last section  we state and prove the -adic product formula  We begin in  Ssb Loc con with the definition of local factors of holonomic modules  then  in  Ssb main we recall the definition of the -function attached to a holonomic module and define the global epsilon factor  We state the product formula and we show that it is in fact equivalent to the product formula for overconvergent -isocrystals conjectured in Marmora Facteurs epsilon  The section continues with the proof of the product formula  some preliminary particular cases in  Sproof geo mod and the general case  as well as the determinant formula for local epsilon factors  in  Ssb proof gen case
Acknowledgments
 The first author  T A   would like to express his gratitude to Prof   S  Matsuda for letting him know the reference Pu and to C  Noot-Huyghe for answering various questions on her paper NH  He also like to thank professor   T  Saito for his interest in the work  and teaching him the relation with   petits camarades  conjecture of Deligne  Finally some parts of the work was done when the he was visiting to IRMA of   Université de Strasbourg  in 2010  He would like to thank the second author  A  Marmora and the institute for the hospitality  He was supported by Grant-in-Aid for JSPS Fellows 20-1070  and partially  by   l agence nationale de la recherche  ANR-09-JCJC-0048-01  The second author would like to thank P  Berthelot  B  Chiarellotto  A  Iovita  B  Le Stum  and C  Noot-Huyghe  for their long interest in this work  advice  discussions and encouragement  He would like to thank professors T  Saito and N  Tsuzuki  for several instructive conversations about the -adic product formula  especially during his first visit to Japan in Fall 2006  JSPS post-doctoral fellowship number PE06005   He thanks X  Caruso and the members of the project ANR-09-JCJC-0048-01  which sponsored part of this collaboration  Finally  both authors would like to thank A  Abbes for his strong interest in the work  and his effort to make them write the paper quickly  Without him  we believe the completion of the paper would have been very much delayed 
Conventions and Notation
 Unless otherwise stated  the filtration of a filtered ring  resp   module  is assumed to be increasing  Let be a filtered ring or module  For we will often denote by  Recall that the filtered ring is said to be a   noetherian filtered ring   noetherian filtered ring  if its associated Rees ring is noetherian 

 Let be a topological ring  and let be a finitely generated -module  We consider the product topology on for any positive integer  Let be a surjection  and we denote by the quotient topology on induced by  Then does not depend on the choice of up to equivalence of topologies  We call this topology the   -module topology on   

 Let be a field  and be an automorphism  A - -vector space    miscellaneous sigma  - -vector space  is a -vector space equipped with a -semi-linear endomorphism such that the induced homomorphism is an isomorphism 

 Let be a complete discrete valuation ring of mixed characteristic be its residue field  and be its field of fractions     miscellaneous k       miscellaneous K    We denote a uniformizer of by    miscellaneous pi     For any integer we put  The residue field is not assumed to be perfect in general  we assume to be perfect from the middle of  S section2 and in the last section   Ssection7   we assume moreover to be finite  We denote by the -adic norm on or normalized as  In principle  we use Roman fonts    e g      for schemes and script fonts    e g      for formal schemes  For a smooth formal scheme over we denote by the reduction over  We denote by unless otherwise stated  In this paper    curve   resp     formal curve   means dimension smooth separated connected scheme  resp   formal scheme  of finite type over its basis  When  resp    is an affine scheme  resp   formal scheme   we sometimes denote  resp    simply by  resp    if this is unlikely to cause any confusion 

 Let be a smooth formal scheme over of dimension  A system of  global  coordinates  coordinates  local coordinates  on is a subset of such that the morphism defined by these functions is étale  A system of local coordinates is a system of coordinates on an open subscheme of  Let be a closed point  A system of local parameters  local parameters  at is a subset of for some open neighborhood of such that its image in forms a system of regular local parameters in the sense of  EGA 17 1 6   When we say   a  local  coordinate   instead of saying   a system of  local  coordinates    and the same for   a local parameter   

 We freely use the language of arithmetic -modules  For details see BerInt Ber1 Ber2  In particular  we use the notation   differential operators    |   An index means tensor with

 Let be a scheme of finite type over and be a closed subscheme of  We put  We denote by  -   categories Isoc  -   the category of convergent  - isocrystal on over overconvergent along  If is proper  we say  for sake of brevity  p hoverconvergent  linebreak  - isocrystal  Fi  -isocrystal  overconvergent isocrystal  on over    instead of convergent  - isocrystal on over overconvergent along and we denote the category by  -   categories Isoc  -    Now  let be a smooth formal scheme  and be a divisor of its special fiber  Let and be the special fibers of and respectively  In this paper  we denote by  differential operators    |   for short  In the same way  we denote    miscellaneous Ox1    by  Let be a coherent  -  -module such that is coherent as an -module  Then we know that is a coherent -module by BerL  Let be the full subcategory of the category of coherent  -  -modules consisting of such  By and the specialization functors and induce an equivalence between and the category  -   We will say that is a convergent  - isocrystal on overconvergent along by abuse of language 

 The shift of a complex will be denoted always by brackets  When parenthesis appear  like it means that all the terms of the complex are Tate twisted times  cf   eqre fsb dec lambda  for a definition of Tate twist 
Stability theorem for characteristic cycles on curves
 The definition of stable holonomic module  stabledef  and the stability theorem  stabilitytheoremcy  are the goal of this section  Theorem stabilitytheoremcy is needed to prove the product formula for holonomic -modules with Frobenius structure on a curve over a finite field  Nevertheless  in this section  we tried to state the theorems in the more possible generality  in particular  we do not require to be perfect  neither we assume the existence of a Frobenius structure on -modules  Even if we put Frobenius structures  we do not know if the proof of the stability theorem could be simplified 
Review of microdifferential operators
 We review the definitions and properties of the arithmetic microdifferential sheaves on curves  which are going to be used extensively in this paper  For the general definitions in higher dimensional settings and more details  see Abe

 Let be a formal curve over  We denote its special fiber by  Let be the cotangent bundle of and be the canonical projection  We put where denotes the zero section     miscellaneous pi    Let be an integer and be a coherent -module  One of the basic ideas of microlocalization is to   localize   over to make possible a more detailed analysis on  For this  we define step by step the sheaves of rings on the cotangent bundle   microdifferential operators naive |   Let be a non-negative integer  Let us define first  For the detail of this construction  see  There are mainly two types of rings of sections of  Let be an open subset of  If is non empty  we get  Suppose that the intersection is empty  Let  Then the ring of sections of on is equal to that on and the ring of these sections is the   microlocalization   of  Let us describe locally the sections  Shrink so that it possesses a local coordinate denoted by  We denote the corresponding differential operator by  There exists an integer such that is in the center of  Let be the multiplicative system generated by in  The positive filtration on given by the order of differential operators  induces a ring filtration  necessarily indexed by on the localization  Thus the elements in can have negative order  but they are   finite   in the sense that only finitely many negative powers of can appear in  the total symbol of  each of them  We define  Gamma  U    Emo dm  X i     l S  -1  Gamma  pi  U      Dmo dm  X i   r   wedge  as the completion of this filtered ring with respect to negative order  see for our conventions on the completion of a filtered ring   Taking an inverse limit over we define  The sections of can be described concretely as follows  Let be an open subset of and assume to be affine  Let be the open formal subscheme sitting over  Suppose moreover that possesses a local coordinate and we denote the corresponding differential operator by  For an integer take the minimal integer such that and let  By the construction of the operator in considered as a section of is invertible  and the inverse is denoted by  Then we put  By using we get  Gamma  U   Ecom pm   m sX    cong Bigl  sum  k in mb Z  a k tial   angles m  k   Big arrowvert a k in m cO    ms V    lim   k arrow  infty a k 0  Bigr   Finally  by tensoring with we define  One of the most important properties of is that we get an equality for any coherent -module  cf     m rChar    m    m sM    m rSupp   Ecomp Qm   m sX   otimes    pi  -1  Dcomp Qm   m sX    pi  -1  m sM    where  characteristic variety and cycle Char    denotes the characteristic variety of level  cf    The module is called the  naive  microlocalization of of level  The ring is called the  naive  microdifferential operators of level

 In the last paragraph  we fixed the level to construct the ring of microdifferential operators  However  to deal with microlocalizations of -modules  we need to change levels and see the asymptotic behavior  The problem is that there are no reasonable transition homomorphism for non-negative integers  To remedy this  we need to take an   intersection    Let where  microdifferential operators naive |   denotes the sub- -module of consisting of microdifferential operators of order less than or equal to and put  Then there exists a canonical homomorphism of -algebras sending to  We define   microdifferential operators intermediate  1  |   By definition  is the -adic completion of and is  When possesses a local coordinate we may write  Gamma  mathrin gT    X   Ecomp Qm m    m sX    cong Biggl   sum  k in mb Z  a k tial  k  Bigg arrowvert a k in m cO    ms X   m bQ    sum  k<0 a k tial  k   in Ecom pm    m sX   m bQ     sum  k q0 a k tial  k  in Ecom pm   m sX   m bQ   Biggr   We note that the last condition is equivalent to  Moreover  by construction of the expansion satisfying the above conditions is unique  once the local coordinate is fixed  and so is  For an integer we put  We have canonical homomorphisms and  cf    We call these sheaves the intermediate rings of microdifferential operators  We also recall the following definitions   microdifferential operators    where the transition maps are induced by the canonical homomorphisms above  cf  for more details 

 Now  let us explain the relation between the supports of the microlocalizations of a -module with respect to intermediate rings and the characteristic variety  Let be a formal curve as in the last paragraph  and let be a coherent -module  One might expect that  for integers This does not hold in general as we can see by the counter-example  However  the statement holds for large enough  The following is one of main results of Abe        There exists an integer such that   normalfont charintemicro   holds for
Setup and preliminaries
 In this paragraph  we introduce some situations and notation  In this paper  especially in the first two sections  we often consider the following setting  which is called   Situation  L    Let be an affine formal curve over  Recall the convention defRmsX especially and  Suppose that there exists a local coordinate in and fix it  We denote the corresponding differential operator by  If moreover we assume the following  we say we are in   Situation  Ls    Let be a closed point in and we fix it  We suppose that there exists a local parameter at denoted by on  We use the following notation  Let be a formal curve over and be an open affine formal subscheme of  We denote by as usual  Let be non-negative integers   newcounte renumipp  em We put 	 	 	 	   microdifferential operators  2     microdifferential operators intermediate  2    em Let be one of  For a coherent 	 -module we denote by 	 or the -module 	  em Let be a closed point in  Take a point in 	 which is not in the zero 	section  Let be one of sheaves of rings 	 or  By the construction of the fiber 	 does not depend on the choice of and 	we denote it by  	Let a pair be one of the four pairs 	 	 	 	  For a coherent 	 or -module we 	write for 	  This does not depend either on the choice of 	  	We warn the reader that even if is complete with respect to some topology we do not complete when we take the fiber at   microdifferential operators intermediate  1  |    microdifferential operators  3     setcounte renumipp   heenumi  Moreover  assume that we are in Situation  L    setcounte renumi   heenumipp  em We denote by the subring of whose elements are   horizontal with respect to     More precisely  we define  C R ms X    tial    m m      Bigl P  sum  n in mb Z   a n tial  n  in Ecomp bm m    m sX   Big arrowvert  mbo x for any   Bigr   We put and  We note that by the hypothesis of Situation  L   the coordinate is fixed  and so is   microdifferential operators intermediate  3     i  Let be a sheaf of rings on a topological space  Then an -module is said to be   globally finitely presented  if there exist integers and an exact sequence on the topological space  By when is affine  there exists an equivalence of categories between the category of globally finitely presented -modules  resp   -modules  on and that of -modules  resp   -modules   We remind here that if there exists a coherent -module such that then is globally finitely presented  and the same for -modules   ii  Let be the natural projection  A sheaf on is called conic if the natural morphism is an isomorphism  In particular  the support of such a sheaf is a conic subset of   i e  if then  By construction the sheaves of microdifferentials are conic  where stands for any of the sheaves etc  introduced before   Since this is clearly a local property  it follows that any coherent -module is also conic   iii  Every element in the ring can be written uniquely as with in a finite étale extension of  cf   K Xnotdef fieldconstmicdif   which coincides with if and only if is geo -metrically connected  The rings and are subrings of and respectively  We remind that they   do  depend on the choice of local coordinate and in particular  we are not able to globalize the construction 

 Let be an affine formal curve over and let be one of the rings or  We finish this subsection by introducing some useful topologies on and on finitely generated -modules  Let s start with  For integers we define a sub- -module of by U  k l     Ecomp bm m    m sX     -k   varpi l Ecomp bm m    m sX    We endow with the topology denoted by where the base of neighborhoods of zero is given by the system  With this topology  is a complete topological ring  Let us see that it is complete with respect to this topology  Let be a Cauchy sequence in  Then we may write such that  for any integers and there exists an integer such that and for any  By the definition of the topology and the construction of the ring the limits and exist  and they are denoted by and respectively  Then we see that by definition  Now  let us define topologies and for any integer on  Let be an integer  For integers we can consider as a sub- -module of and we denote by the topology on generated by the open basis  This topology makes it a locally convex topological space  and moreover a Fréchet space by  The identity map is continuous by construction  By taking the inductive limit  of locally convex spaces   we define a topology  denoted by on  It makes an LF-space in the sense of  The separateness can be seen from the fact that the convex subset in is open in the -topology for any and thus in the -topology  Let be a finitely generate -module  We denote the -module topology on  cf   nottop  by  Let us prove that the topology is separated  Let be a surjective homomorphism  and put  Consider the quotient topology on using the topology on  It suffices to show that is separated  Indeed  take such that  There exists an integer such that  If is separated  there exists such that  Since we get the claim  Let us show that is separated  Since is a noetherian complete -adic ring  cf     is also -adically complete  and in particular  -adically separated  Thus  it suffices to show that is separated for any using the quotient topology from  Consider the topology defined by the filtration by order on  The topology coincides with the quotient topology via induced by  Since is a noetherian complete filtered ring by we get that is separated  and thus the topology on is separated  This shows that  is a closed sub- -module  Thus the topological vector space is a Fréchet space  Of course  the identity map is continuous  We define the inductive limit topology  of locally convex spaces  on which is called the   natural topology  on  If the natural topology is separated  then is an LF-space  When it is separated  the open mapping theorem implies that coincides with the -module topology  In the same way  we define topologies and on and on finitely generated -modules when we are in Situation  L  of setup  Suppose we are in Situation   normalfont L   of   normalfontsetup    Let be a finitely generated -module  We assume that it is also finite as -module  Then the natural topology as -module and the natural topology as -module are equivalent  In particular  if moreover is a free -module  then the topologies are separated  and becomes an LF-space  Let us see the equivalence  Let be a surjection  This surjection induces the surjection and the quotient topology is defined  Let be the Fréchet topology defined using the surjection and the -module structure  as done above in topologyonring for  Since is a topological -module by the definition  the homomorphism defines a continuous surjective homomorphism of topological modules  By the open mapping theorem of Fréchet spaces  we see that this homomorphism is strict  which implies that and are equivalent  The first claim follows by taking the inductive limit over  When is free as a -module  then it is obvious that it is separated 
Relations between microlocalizations at different levels
 In this subsection  we investigate the behavior of microlocalizations when we raise levels  In general  this is very difficult  However  once we know that the supports of the microlocalizations are stable  cf   stabledef   the behavior is very simple at least in the case of a curve  Suppose we are in Situation   normalfont Ls   of   normalfontsetup    Let be non-negative integers  and be a left ideal of   we put  Let be the -module associated to  cf   Remark   normalfontsetup  i    on and assume  m rSupp   m sM     pi  -1  s  cap mathrin gT   X  Then for any integer there exists a positive integer and such that y s N- varpi R-S in I  Since is a noetherian ring  cf     there exist operators for such that is generated by  Let and be its special fiber  Then by the assumption on the support  there exists for each such that For we denote by the image of in and define  We put  Since for any there exists an integer such that where the overlines denote the images in or thus  This shows that there exists an integer such that for any we can write y s NQ i Q  i  varpi R i S i  where and  Then by  sumequ1qp   there exist and such that y s N  sum Q  i cdot P i  varpi R  S   Let us show that for any integer It is evident that the right hand side is included in the left one  let us prove the opposite inclusion  Take elements and such that  Write with and put and  Then we get and in particular contained in which is thanks to uniqueness of the expansion considered in def intermediate microdiff  By assumption we have which implies the equality  relationincl  Since we get  by using  relationincl   that  varpi R  S  in varpi Ecomp bm m    m sX     Ecomp bm m     ms X    k  Thus the lemma follows  Suppose we are in Situation   normalfont Ls   of   normalfontsetup    Let be non-negative integers  and be a globally finitely presented -module such that  m rSupp   m sM   cap mathrin gT   X  pi  -1  s  cap mathrin gT   X  We denote by  Then we have the following   i  The module is finite over  Moreover  if it is monogenic as an -module  there exists a -torsion free -module such that and is finitely generated over   ii  There exists a finite set of elements in such that for any open affine neighborhood of in is generated by these elements over  If is generated by then there exists an integer such that we can take this set to be  Let be a coherent sub- -module of  Let be either or  Then by the additivity of supports we know that  m rSupp   m sN    cap mathrin gT   X  pi  -1  s  cap mathrin gT   X mbo x or   ptyset  If it is then and in particular  is finite over  By induction on the number of generators of we reduce the verification of both  i  and  ii  to the monogenic case  From now on  we assume that is a monogenic module  Fix a generator  Let be the sub- -module of generated by  Let be the kernel of the homomorphism of left -modules sending to  We note that  by definition   Since is -torsion free  we get that where denotes the -module associated to  which is equal to by setup   and the same for  Thus by Lemma lemmaexspope for there exists a positive integer and such that  To conclude  it suffices to show that is generated over by where since there is a surjection  Since and are -adically complete and -torsion free  the conditions of are fulfilled  and thus  it suffices to see that is generated by over  It remains to show that is generated over by where  Since and are complete with respect to the filtrations by order  it is enough to prove the claim after taking by  Since the order of is less than this amounts to prove that the commutative algebra is generated over by  This is a straightforward verification which is left to the reader  We assume that we are in Situation   normalfont L     i  Let  Then we have a canonical isomorphism  EcompQ bm 1 m    m sX   cong  C K ms X    tial    m 1 m     wideha t otimes    CK  ms X    tial    m m      EcompQ bm m    m sX   of bi- -modules  Here the complete tensor product is taken with respect to the -adic topology   ii  Let  Then we have a canonical isomorphism  Ecomp bm m    m sX   cong C R ms X    tial    m m     wideha t otimes  f   CR  ms X    tial    m m  1     Ecomp bm m  1   m sX   of bi- -modules  Here the complete tensor product is taken with respect to the filtration by order   iii  Let  For any we have a canonical isomorphism  Emod bm m   X i  cong  C RX i   tial    m m    wideha t otimes  f    CR X i   tial    m m  1    Emod bm m  1  X i  of bi- -modules  Here the complete tensor product is taken with respect to the filtration by order  Let us see  i   There exists a canonical homomorphism  varphi colon EcompQ bm m    m sX   arrow C K ms X    tial     m 1 m    wideha t otimes    CK  ms X    tial    m m      EcompQ bm m    m sX    sending to  For short  we denote by which is considered to be a subring of using the canonical inclusion  We know that where denotes the -adic completion  The image is contained in the image of  linebreak  Indeed  let  We denote by  Then we may write where and  For we can write where  Since this is a finite sum  is the image of and the claim follows  This implies that the homomorphism induces the canonical homomorphism  wideha t varphi  colon EcompQ bm 1 m    m sX   arrow  C K ms X    tial    m 1 m    wideha t otimes     CK  ms X    tial    m m     EcompQ bm m    m sX    On the other hand  we have the canonical homomorphism  wideha t psi  colon C K ms X    tial    m 1 m    wideha t otimes     CK  ms X    tial    m m     EcompQ bm m    m sX   arrow  EcompQ bm 1 m    m sX    To conclude the proof  it suffices to see that  Since and are continuous  to see the former equality  it suffices to show the identity on which is obvious  Let  To see the latter equality  it suffices to see after restricting to  Since this is straightforward  we leave the argument to the reader  Now let us prove  ii   We have a canonical homomorphism  wideha t psi  colon C R ms X    tial    m m    wideha t otimes   f   CR  ms X    tial    m m  1    Ecomp bm m  1   m sX   arrow Ecomp bm m    m sX    On the other hand  we also have the homomorphism  iota colon Ecomp bm m  1   m sX   arrow  C R ms X    tial     m m     otimes    CR  ms X    tial    m m  1     Ecomp bm m  1   m sX    sending to  Since is the canonical inclusion  we get that is injective  We define which is filtered by the tensor product filtration denoted by  Let and take in  Then there exists such that  sum  i P i otimes Q i equiv tial   angles m   n   otimes f  bmod B  n-1   Suppose  Then  There exists an integer such that  Thus for we get  If we would get which is impossible  Thus  we get  This shows that for any large enough  Thus  is -torsion free  In particular  the canonical homomorphism i colon C R ms X    tial    m m    wideha t otimes  f    CR  ms X    tial    m m  1    Ecom pm m  1   m sX   arrow  C R ms X    tial    m m    wideha t otimes   f   CR  ms X    tial    m m  1    Ecom pm m  1   m sX     otimes m bQ  is injective  Now  let where is the canonical inclusion  cf    Consider the following diagram   xymatrix C 60p tE   m m      ms X   ar r  <>  5 j ar   >  rd  	   C R ms X    tial    m m    wideha t otimes  f    CR  ms X    tial     m m  1    Ecomp bm m  1   m sX    otimes m bQ
	  C R ms X    tial    m m    wideha t otimes  f    CR  ms X    tial     m m  1    Ecomp bm m  1   m sX   ar u  i   Let us construct the dotted arrow making the diagram commutative  It suffices to see that  Let where  Since there exists an integer such that it suffices to show that for any integer which is easy  Thus induces the canonical homomorphism E   m m      ms X   arrow  C R ms X    tial    m m    widehat   otimes  f   CR  ms X    tial    m m  1    Ecomp bm m  1   m sX   of filtered rings since is injective  By taking the completion with respect to the filtration by order  we get the canonical homomorphism  wideha t varphi  colon Ecomp bm m    m sX   arrow  C R ms X    tial    m m    wideha t otimes  f    CR  ms X    tial    m m  1    Ecomp bm m  1   m sX    We see easily that as in the proof of  i   which concludes the proof  Let us see  iii   The above argument shows that is -torsion free for any  Since is -torsion free and the inverse system satisfies the Mittag-Leffler condition  we get for any  Let be the completion with respect to the filtration by order  We get 	 wideha tB  otimes R i cong  invlim nB B n   otimes R i cong invlim n B B n otimes R i 
 	 qquad cong invlim n  B otimes R i   m rIm  B n   cong  C RX i   tial    m m    wideha t otimes  f   CR X i    tial    m m  1    Emod bm m  1  X i   By using  ii   the claim follows  Let be a smooth formal curve over and as usual  Then the algebra is flat over  By and we know that is flat over  It suffices to show that  This amounts to prove  m rTor  2   pi  -1  Dcomp Qm   m sX     Ecomp Qm    m sX     Ecomp Qm m    m sX    bullet  0 by the flatness of  However  by this is equivalent to showing that  m rTor  2   pi  -1  Dcomp Qm   m sX     pi  -1  Dcomp Qm    m sX     Dcomp Qm   m sX    bullet  0  which follows from the flatness of over  We do not know if is flat over when the dimension of is greater than and

 Let be a connected smooth formal scheme over  Let be the generic point of and denote by the integral closure of in the field  The ring is a discrete valuation ring as well since it is finite over and connected  Thus by is étale over  Moreover is the separable closure of in and is geometrically connected over by  Put  This is an unramified field extension of  The field is called the field of local constants of  The reason for this naming comes from the next lemma  Suppose is affine and possesses a system of local coordinates  We denote the corresponding differential operators by  Then we get K  m sX    l f in m cO    ms X   m bQ   mid tial i f  0  mbo x for   r      miscellaneous KX    For this  we may assume that  There exists a finite étale extension of such that is a discrete valuation ring and has a -rational point  Note that is also connected and  By Galois descent  it suffices to show the lemma for  In this case the lemma follows from

 Let be a finite field extension of  Let be a connected interval in  We denote by the ring of analytic functions  lim  i arrow pm infty | alpha i| rho i 0  rho in I  For short  we often denote this by  For real numbers we put  m cA   x L   a b       sum  i in mb Z   alpha ix i 			 Bigg arrowvert  alpha i in L   sup  i in mb Z   			 l | alpha i|a i r  			< infty     Similarly  we define   rings of analytical functions    For a series in and a real number we put   clearly we have  Let and  Note that if we get  Then by the definition of we get the following explicit description  Suppose we are in Situation   normalfont L   of   normalfontsetup    Let be the field of constant of  Then for any non-negative integers we have an isomorphism  C K ms X    tial    m m    xrightarro w sim  m cA   x L     omega  omega  m    omega  omega m   sending to  Suppose we are in Situation   normalfont L    For any non-negative integers the commutative ring is a principal ideal domain  Moreover  is a field  Let us show that is a PID  We use the notation of  Sfieldconstmicdif  Let be the field of constants of  It suffices to show that is a PID for any in  Let and set where is the usual  real  natural logarithm  The Newton function is defined by  By construction we have  For every compact interval the restriction of to is continuous  convex and piecewise linear with slopes in cf    therefore the function enjoys the same properties on with  a priori an infinite number of slopes  We denote by the set of the critical points of in the interval i e    the set of points in where the slope changes  We claim that is finite  Since and this claim is stable under finite extensions of we may assume  Take such that  By a coordinate change from to we may assume  The properties of recalled above imply that is discrete in so it is enough to prove that it is finite in a right neighborhood of  The valuation of is discrete and by hypothesis  so there exists an integer such that  On the other hand  take  There exists such that is affine on of slope  By convexity of we have  Put  By construction  we have for and the claim follows  Therefore  there exists a polynomial and such that  Since there are no zero points of on there are no critical points of the function on which implies  In the same way  we get and thus  This shows that any ideal is generated by polynomials  Since is a principal ideal domain  the ideal of generated by the polynomials is also principal  hence is a PID  To see the latter statement of the lemma  it suffices to show that is a field for any  The verification is left to the reader  By this lemma  we get that any finitely generated -module with a connection is a free -module by

 Let be a formal curve  and be a coherent -module  We say that is   holonomic   holonomic  -module  if the dimension of is or if  For an integer let  We say is   stable   stable -module  if for any we have  m rSupp   Ecomp Qm  m     m sX   otimes   pi  -1  Dcomp Qm    ms X    pi  -1  m sM    m rChar    m    m sM    In particular  we have  By Theorem mainabe any coherent -module is stable after raising the level sufficiently  We say that a point is a   singular point of   if   singular point  From now on  to avoid too heavy notation  we sometimes denote by just   characteristic variety and cycle Chara    For a coherent -module there exists a stable coherent -module for some such that  We define and we say that   is holonomic  if is  We define the set of singularities of as that of  Note that when is a coherent - -module  cf   setupFrob   the definition of holonomicity is equivalent to that of Berthelot as written in  For the later use  we remind here the following lemma  Suppose we are in Situation   normalfont L   of   normalfontsetup    Let be a monogenic stable holonomic -module  and be a generator  Let be the set of singular points of  Take and let be a local parameter of  Then for any integers there exists an integer such that generate over  We may shrink so that we are in Situation  Ls  and  Then this is just a direct consequence of Lemma finiteness  ii  

 In this paragraph  we will consider Situation  L  of setup and we will follow the notation fixed there  Let be a stable holonomic -module and be a closed point of such that  We consider the -module cf   Notation not3 in setup  It can be seen as a -module  When we are especially interested in this -module structure  we denote this module by    We caution here that this definition is only for this section  and from   normalfont eqref changing not    we use the same notation for a slightly different object    microlocalisation of     In the same way  for a -module we put and the same for -modules etc  By the condition on the characteristic variety and Lemma generators we get that is finitely gene -rated over  Let be the field of constants of  We have the isomorphism of Lemma fieldconstmicdif  m cA   x  L    m m      m cA   x  L    omega  omega  m    omega   omega m   xrightarro w sim  C K ms X    tial    m m    sending to  We consider as a finitely generated -module using this isomorphism  and equip it with the following connection  for we put  EcompQ m m   s  m sM   is free   nabla  alpha    -x alpha  otimes dx   The -module is finite free and is a connection  We denote its rank by  Let us check that defines a connection  The additivity is evident and Leibniz rule follows from the relation in the ring of microdifferentials  The -module is finitely generated by generators and it is endowed with a connection  hence it is torsion free by  Since the ring is principal by Kringpid it follows that is finite free  Suppose we are in Situation   normalfont L   of   normalfontsetup    Let be a stable holonomic -module  Let be the set of singular points of   i  For an integer and we get an isomorphism  Ecomp Qm 1 m   s  otimes   EcompQ m m   s   Ecomp Qm m   s   m sM    cong  C K ms X    tial    m 1 m     otimes    CK  ms X     tial    m m     Ecomp Qm m   s   m sM    In particular    ii  For and we get an isomorphism  Ecomp Qm m   s  otimes   EcompQ m m  1  s   Ecomp Qm m  1  s    m sM   cong C K ms X    tial    m m    otimes   CK  ms X     tial    m m  1    Ecomp Qm m  1  s   m sM    In particular   Let us see  i   Let be an open affine neighborhood of such that  We put where denotes the special fiber of  Since tensor products commute with direct limits  it suffices to show that  EcompQ bm 1 m    m sU   otimes   EcompQb m m    m sU   M   cong C K ms X    tial    m 1 m     otimes     CK  ms X    tial    m m    M   By Lemma tesorcalc  i   we get  EcompQ bm 1 m    m sU   otimes   EcompQb m m    m sU   M  	 cong  EcompQ bm 1 m    m sU   wideha t otimes    EcompQb m m    m sU   M 
 	 cong  C K ms X    tial    m 1 m    wideha t otimes     CK  ms X    tial    m m      EcompQ bm m    m sU    wideha t otimes    EcompQb m m    m sU   M 
 	 cong  C K ms X    tial    m 1 m    wideha t otimes    CK  ms X     tial    m m    M 
 	 cong  C K ms X    tial    m 1 m     otimes    CK  ms X     tial    m m    M   The last isomorphism follows from the fact that is finite over  Since moreover is free over the claim for the rank follows from the preceding isomorphism  Let us prove  ii   Since we know that is flat over by we may suppose that is a monogenic module using an extension argument  Let be an open affine neighborhood of such that and be its special fiber  As in the proof of  i   it suffices to show the claim over  By using Lemma finiteness there exists a -torsion free -module such that and which is finitely generated as an -module  Now  we get  Ecomp bm m    m sU   otimes   Ecompb m m  1   m sU    M   	 cong  invlim i Emod bm m   U i  otimes   Emodb m m  1  U i   M   i
  nota g	 cong invlim Emod bm m   U i  wideha t otimes  f    Emodb m m  1  U i   M   i  Indeed  the first isomorphism holds since is -adically complete  To see the second isomorphism  take a good filtration on  The tensor filtration is good by  Thus is complete by since is a noetherian filtered complete ring by  Now by Lemma tesorcalc  iii   we get  Emod bm m   U i  wideha t otimes  f   Emodb m m  1  U i    M   i cong C RX i   tial    m m    wideha t otimes  f    CR X i   tial    m m  1    M  i by the same calculation as in the proof of  i    For careful readers  we note here that the same statement of holds for filtered rings by exactly the same arguments  The detail is left to the reader   Thus by the same calculation as  calctens   we get  Ecomp bm m    m sU   otimes   Ecompb m m  1   m sU    M   cong  C R ms X    tial    m m    otimes   CR  ms X     tial    m m  1    M    By tensoring with we get what we wanted 
Characteristic cycles and microlocalizations
 We will see how we can compute the multiplicities of holonomic modules from its microlocalizations  In general  it is very difficult to calculate the characteristic cycles in terms of intermediate microlocalizations  However  the construction of the rings of   naive  microdifferential operators are simple and formal  therefore we can calculate the multiplicities easier 

 For a graded ring and a finite graded -module the graded length of is the length of in the category of graded -modules  and we denote it by  When we say that is gr-simple  We say that is gr-Artinian if   gr-Artinian  gr-simple    Let be a positively graded commutative ring  and be a finite graded -module  Let and S   mf p     1  cup l f in A setminus A 0 mid mbo x is a homogeneous element which is not contained in   r   We denote by the localization and by  We note that since consists of homogeneous elements  these are respectively a graded ring and a graded module  Let  The schemes and are schemes over and there exists a canonical section  We put  Let us denote by the canonical surjection defined in  Now we get the following  Let be the quasi-coherent -module associated to  Let be a generic point of  Then we get  m rg lg   A   widetilde  mf p     M   widetilde  mf p       m rlg   A   mf p    M   mf p     By we get that the fiber of at is  Since the support of the sheaf in is contained in and there exists an integer such that  Thus is a graded -module  Let be a graded -module such that  Then by the definition of  This shows that given a chain of graded sub- -modules  we can attach a chain of sub- -modules  Thus we see that  To see the opposite inequality  it suffices to show that given a -module such that then  Since is the only gr-simple -module  it suffices to show that which is obvious 

 Let be a noetherian filtered ring  and be a finite -module  Let be a good filtration on  Then consider  Exactly as in the classical way  e g     we are able to show that this does not depend on the choice of good filtrations  Recall we say that an increasingly filtered ring is Zariskian if it is noetherian filtered and is contained in the Jacobson radical of  Let be a Zariskian filtered ring such that is a gr-Artinian ring  Suppose moreover that is finite and  m rlg  A A   m rg lg    mr gr  A    m rgr  A    Then for any good filtered -module we get  m rlg  A M   m rg lg    mr gr  A    m rgr  M    The field of formal Laurent series in is Zariskian filtered by the filtration given by the degree in  We have that is gr-Artinian  of graded length and  First  let be a good filtered -module and take a sequence of sub- -modules M supsetneq M   1   supsetneq ots supsetneq M   l   0  We equip with the induced filtration  These filtrations are good by since is a Zariskian filtered ring  Since the filtration on is good and is a Zariskian filtered ring  the filtration is separated  and  Thus we get the strictly decreasing sequence  m rgr  M  supsetneq m rgr  M   1    supsetneq ots supsetneq  m rgr  M   l    0  This shows that  It suffices to show that if is a good filtered -module such that is a simple -module  then is a gr-simple -module  Let A  I   0   supsetneq I   1   supsetneq ots supsetneq I   l   0 be a composition series  The hypothesis and the above observation imply that  m rgr  A  supsetneq m rgr  I   1    supsetneq ots supsetneq  m rgr  I   l    0 is also a composition series in the category of graded modules  Since any simple graded -module is appearing in the series  we get that for any simple -module there exists a good filtration on such that the -module is gr-simple  Indeed  there exists such that  We put the good filtration induced by that of on  Then since is a gr-simple -module  we get the claim  Since for any good filtrations and on we know that and have the same gr-length  we get that is gr-simple for any good filtration  This concludes the proof of the lemma 

 Let us consider Situation  L  of setup  Recall the notation of localsetting  Let be a holonomic -module  not necessarily stable   Let be the characteristic cycle of  cf    We note that  by construction  is additive on short exact sequences of -modules  The integer is called the   vertical multiplicity  of at and the integer is called the generic rank  or horizontal multiplicity  of   characteristic variety and cycle Cycl  |    characteristic variety and cycle multiplicity vertical multiplicity   characteristic variety and cycle multiplicity generic rank  horizontal multiplicity   We get p m cdot m rrk    CK  ms X    tial    m     Ecomp Qm  s    m sM     eg L s  cdot m s  where and  We may assume that is a monogenic module by an extension argument using the flatness of over cf   flatness  Let be a monogenic -module without -torsion such that  Since is flat over by we note that is also -torsion free  Let be the subring of topologically generated by over  Then we get p m cdot m rrk    CK  ms X    tial    m     Ecomp Qm  s    m sM      m rrk   L  tial   angles m  p m      0      Ecomp Qm  s   m sM     We know that is finite over by Lemma finiteness and in particular  finite over  Since is a discrete valuation ring whose uniformizer is and is -torsion free  we get that is free over  Thus  we get  m rrk   L  tial   angles m  p m      0     Ecomp Qm  s    m sM   	  m rrk   R L  tial   angles m  p m      0      Ecom pm  s   m sM    
	  eg L K   -1  cdot m rrk   k  cc  tial   angles m  -p m     tial   angles m  p m       Ecom pm  s   m sM   varpi    Here is considered as a subring of  It is the ring given in Example exemple gr-artinian with and so it satisfies the hypotheses of Lemma Zarmularitw  Now  we put  Take a good filtration of  Let be the generic point of the fiber  Then is an Artinian -module  Note that possesses a natural filtration induced by the good filtration of  cf   or  Thus  we get m s  m rlg     mc O   T   m   X     xi s    m rgr  F   m sN     xi s  	  m rg lg    mr gr   Emo dm  X  xi s    r  m rgr   Emo dm  s   m sN    l  by using Lemma grlglg  Since the injection induces the isomorphism where denotes the class of in we get  m rg lg    mr gr   Emo dm  X  xi s    r  m rgr   Emo dm  s   m sN    l 	   m rg lg    mc O   X s   tial   angles m   pm p m     r  m rgr   Emo dm  s   m sN    l 
 	  eg s    -1  cdot m rg lg   k  tial   angles m    pm p m     r  m rgr   Emo dm  s   m sN    l   By using Lemma Zarmularitw we get the proposition 
Stability theorem
 We summarize what we have got  and get the following characteristic cycle version of Theorem mainabe which is one of main theorems of this paper  Recall the notation of paragraph localsetting   Stability theorem for curves  Let be an affine formal curve over in Situation   normalfont L   of   normalfontsetup    and be a stable holonomic -module  Let be the set of singular points of and suppose that is a convergent isocrystal  Let be the generic rank of   i  For any we get  m rrk    CK  ms X    tial    m    l  Ecomp Qm  s    m sM   r    m rrk    CK  ms X    tial    m  m      l   Ecomp Qm  m    s   m sM   r    m rrk    CK  ms X    tial    m     l   Ecomp Qm   s   m sM   r   This number is denoted by   ii  For any we get  m rCycl    m     Dcomp Qm    m sX   otimes   DcompQ m   m sX     m sM   r cdot X  p  m     K  m sX   K  cdot sum  s in S  eg s   -1  cdot r s  cdot  pi  -1  s    Since is stable  we get for any  m rrk   Ecomp Qm    s   m sM     m rrk   Ecomp Qm  m    s    m sM     m rrk   Ecomp Qm   s   m sM    by Proposition rankcompat  Thus  i  follows  Let us see  ii   For this  the vertical multiplicities are the only problem  By Proposition levmcharcycle we get for any p  m   cdot m rrk    CK  ms X    tial    m       Ecomp Qm   s   m sM     m rdeg  s  cdot K  m sX   K   -1  cdot m s  m sM    m      Thus combining with  i   we get  ii   Thanks to Theorem stabilitytheoremcy we can now define the characteristic cycle of holonomic -modules  cf   defCycl and prove Corollary cor noeth art  These were already know for the category of holonomic - -modules  cf    The main point is to give  for a -module a definition of the characteristic cycle independent on the level  i e    independent on the choice of a -module such that  In loc   cit  Berthelot used his Frobenius descent theorem  whereas here we can take  thanks to Theorem stabilitytheoremcy an integer big enough  so that is stable    characteristic variety and cycle Cycl  |   Let be a formal curve  and let be a holonomic -module  Let is a stable coherent -module such that  Let be the set of singular points of  We define  m rCycl   m sM   r cdot X   K  m sX   K  cdot sum  s in S   m rdeg  s   -1  cdot r s cdot  pi  -1  s    where is the generic rank of and which do not depend on the choice of by Theorem stabilitytheoremcy   i  When possesses a Frobenius structure  the characteristic cycle here coincides with that of Berthelot  or   ii  By Theorem stabilitytheoremcy - ii  and  Sdef cycl Dm is additive on short exact sequences of holonomic -modules   iii  The characteristic cycle has integral coefficients  To prove this we may first assume geometrically connected  indeed does not change if we consider as a smooth formal scheme over   secondly we note that if we base change by a finite extension  then the multiplicities will not change  by construction   therefore we may assume rational over and the integrality of is evident  Let be a formal curve over  The category of holonomic -modules is both noetherian and artinian  The argument of the proof is the same as that of  We recall it for the convenience of the reader  We can prove the ascending chain condition as follows  let be an ascending filtration by holonomic sub-modules  We may assume  The support of has dimension one because is holonomic  By additivity of cf   Remark defCycl - ii   we have  for all Since is a noetherian space and the coefficients  and  appearing in belong to we get  for big enough    therefore  We can prove the descending chain condition in a similar way 
Local Fourier transform
 The aim of this section is to define the local Fourier transform  We note that the definition itself is not difficult anymore thanks to works of Huyghe and Matsuda  we can take the canonical extension  the geometric Fourier transform  and take the differential module around as presented in  However  with this definition  we are not able to prove the stationary phase formula in the way used in the complex case  In this section  we instead define the local Fourier transform using microlocalizations following the classical techniques  and prove some basic properties 
Local theory of arithmetic -modules
 Since the main goal of this paper  Theorem Product formula  is to prove a theorem connecting local and global invariants  it is indispensable to work in local situations  In the -adic case  this was the theory of étale sheaves on traits  in other words Galois representations of local fields  In our setting  the theory of arithmetic -modules on a formal disk by Crew Cr3 Cr which can be seen as a generalization of the theory of solvable -adic differential equations  should be the corresponding theory  We briefly review the theory in this subsection 

 Let be as usual  cf   defRmsX   we recall that denotes a uniformizer of  The field will be assumed perfect in all  Ssection2 with exception of Crewconstan -- diffmoddef and analye  Denote by    miscellaneous W    a Cohen ring with residue field  ring of Witt vectors if is perfect   For any commutative local ring we will denote by  or  its maximal ideal  If is an -adic ring  for an ideal of we will denote it by when we want to specify the ideal of definition explicitly  Let be a -dimensional formally smooth local noetherian -algebra complete with respect to the -adic topology  such that whose residue field is finite over  In this situation  is complete with respect to the -adic topology by  Let and     miscellaneous K    Note that is a discrete valuation ring  Now we get the following  The -algebra is isomorphic to  By we get  Moreover  the ring is a complete noetherian local ring  formally smooth over such that its reduction over is isomorphic to  Thus by we get the lemma  The situation we have in mind is the following  the -algebra is the completion of the local ring of a formal curve at a closed point with respect to the filtration by the powers of its maximal ideal  denoted by  In this case we will put and denotes by the field of fractions of     miscellaneous Ox2    We simply denote by  The formal scheme    miscellaneous S    is called a   formal disk   formal disk  and it consists of two points  an open point and a closed point  We put which consists of only one point  Note that Crew in Cr used the notation for     miscellaneous S    The reason why we introduced and will be clarified in Remark Rem on S tilde

 In Cr3 Cr Crew checked that on the theory of arithmetic -modules can be constructed in the same manner  He constructed the ring  resp    of Berthelot differential operators  resp   overconvergent at   cf     differential operators D    He also constructed analytic variants and  differential operators Dan  |   of these rings by   analytifying   and where  Here analytification roughly means to tensor with and take the completion with respect to a suitable topology  Let us briefly review the constructions of  Choose an isomorphism by Lemma existconcdesc  For a positive integer and a non-negative integer we define    miscellaneous Ori    to be as defined in  When is divided by possesses a -module structure  cf    We define a   ring    Dcomp Qm  x     mr an     invlim  n  l   invlim i  m cO   np  m 1  i  otimes   mc O   X i   Dmo dm  X i    otimes m bQ  r   Although it is not defined explicitly in   loc   cit    this ring is used to define as inductive limit of over   differential operators Dan  |   By the remark below this ring depends only on and not on the parameter used to define it  so we denote it by  The construction of is analogous  by using in place of  In the construction of the rings and one uses the parameter  Thus    shape a priori  the construction depends on this choice  However  if we use another such that its image in is a uniformizer to construct the rings  the resulting rings are canonically isomorphic to those constructed using the uniformizer  Indeed  using the notation of let be the ring using the uniformizer  Let be another uniformizer  Then there exists a canonical isomorphism  Moreover  in there exists an inclusion and  Thus the claim follows from the definition of and  Moreover Crew generalize these constructions to define analytification functors  cf    -    mr an   colon m rCoh   Ddag Q widetilde  ms S     arrow  m rMod   Da n widetilde  ms S    m bQ      qquad  -    mr an   colon m rCoh   Ddag Q widetilde  ms S    0   arrow  m rMod   Da n widetilde  ms S    m bQ   0     functors  1    where denotes the category of coherent modules and denotes the category of modules  They send to and to respectively  and for every coherent -module  resp   -module  there exists a natural monomorphism  Finally  the morphisms and are flat  both left and right   the analytification functors are exact  and we have  resp     for any coherent -module  resp   -module  cf    We define the sheaves  differential operators Ddag    by  Gamma  m sS   Ddag Q ms S   	    Ddag Q widetilde  ms S    	 qquad  Gamma  eta   ms S     Ddag Q ms S   	    Ddag Q widetilde  ms S    0  
  Gamma  m sS   Da n ms S   m bQ   	    Da n widetilde  ms S    m bQ   	 qquad Gamma  eta   ms S     Da n ms S   m bQ   	   Da n  widetilde  ms S    m bQ   0   By the Remark above  these sheaves are well-defined  For any -module we can define a sheaf on by  Gamma  m sS   m sM    riangle  	   m sM   	 qquad Gamma  eta   ms S     m sM    riangle   	    Ddag Q widetilde  ms S    0  otimes   DdagQ  widetilde  ms S      m sM     and similarly we can associate a sheaf on to any -module  by replacing with in the definition above  By construction  the fibers of any sheaf of -modules  resp   -modules  are given by and  Hence the functors and are equivalence of categories  quasi-inverse each other  between the category of coherent sheaves of -modules  resp   -modules  and coherent -modules  resp   -modules   We will often abusively use the same symbol to denote a sheaf of coherent -modules  resp   -modules  and its global sections on

 Put define the bounded Robba ring  in fact a field  by and the Robba ring by  Robba s rings  1     cf   fieldconstmicdif  By Remark rem indipendec par the rings and depend on the choice of the coordinate of only up to a canonical isomorphism  indeed they are the sub-rings of order zero differential operators in and respectively  we denote these rings by and  We often omit the subscripts and write simply and   rings of analytical functions    Let us fix our conventions on the definition of differential modules   differential module  In this paper  we will adopt the definition of Kedlaya  Namely  we define a differential -module to be a locally free sheaf of finite rank on the rigid analytic annulus over with a connection  In other words  it is a collection where is a finite differential -module equipped with isomorphisms for of differential modules  compatible with each other in the obvious sense  Let us define the category of differential -modules  An object consists of a differential -modules for some  Let be a differential -module  and be a differential -module where  Then we define the set of homomorphisms by  m rHom    mc C    M   N     indlim  s arrow 1 -   m rHom    tial  l  m cA  the natural map is an isomorphism for any and the functor of global sections is an equivalence on its essential image   loc   cit   Cor   3 3   Let be a differential -module which is defined by a differential -module also denoted by  We define  Gamma  M     indlim  s arrow1 -  Gamma l  m cA  this defines a homomorphism inducing  Taking the inductive limit  we get what we want  For any differential ideal of we can define a differential -module by  However is not equal to in general  For example take a differential ideal of of infinite type  cf    Since is differentially simple  cf     loc   cit   Rem   3 1    the ideal is equal to and the differential module is free of rank

 Starting from here  with the exception of analye we assume that is perfect  Let be a lifting of the -th absolute Frobenius morphism     miscellaneous sigma    An - -module  resp   - -module  is a -module  resp   -module  endowed with an isomorphism  For - -modules the definition of holonomy is the same than that for formal smooth schemes  cf    An - -module  resp   - -module  is said holonomic if there exists a holonomic  holonomic  - -module  - -module  - -module such that cf        We denote by -  resp   - resp   -  the category of holonomic - -modules  resp   holonomic - -modules  resp  the category of differential module on with Frobenius structure    categories FHol  - - -   The category of free differential -modules with Frobenius structure is equivalent to the category of holonomic - -modules  By we get that given a free differential -module with Frobenius structure  there exists a free differential -module with Frobenius structure such that  Thus  by can be viewed as a holonomic -module  By construction this induces the equivalence of categories  The scalar extension defines a functor denoted by from the category of holonomic - -modules to -  Let and be formal disks  If we are given a finite étale morphism this induces a functor and also the pull-back  In the same way  if we are given a finite étale morphism of generic points this defines a functor and the pull-back and the same for etc  We note here that consists of a single point  There is no problem as long as we only consider finite étale morphisms of like above  but in this paper  we need to use push-forwards and pull-backs in the situation where only morphisms on like are defined  Under this situation  adding the generic point by considering instead of makes descriptions much simpler 

 Let us anticipate here some definitions for - -modules on a formal disk  that are used in rest of this section  for more details cf   or defvanishcycle  For any -module we put    functors six operations j    conversely for any -module we define the -module obtained from by restriction of scalars via   functors six operations j    Similar definitions hold for -modules and -modules  The - -module  punctual  type  the - -module   is by definition the holonomic - -module elta   Ddag Q widetilde  ms S     Ddag Q widetilde  ms S     cdot t  m cR  b  m cO    ms S   m bQ    Rob  m cO    mr an    By construction is holonomic and  We say that a -module is punctual  or punctual type   punctual  type   if there exists a finite dimensional -vector space such that   functors six operations i    By construction a punctual - -module is automatically holonomic  We say that a -module is connection type  connection type  if there exists a -module such that  For connection type - -modules holonomicity is equivalent to coherence  and if is a coherent - -module  then is connection type if and only if the natural map of -modules is an isomorphism  We have similar definitions of punctual and connection type hold for -modules 

 Let us recall more notation and definitions from Cr see   loc   cit    S1  for details  The bounded Robba ring is a discrete valuation field with respect to the 1-Gauss norm  Let us denote by  Robba s rings  2  |   its integer ring and by its residue field  where is the class of  Choose a separable closure    miscellaneous K     We set and let    miscellaneous G    be the inertia subgroup  Since is henselian  given a finite separable extension of there exists a unique finite unramified extension  Robba s rings  2  |   of whose residue field  of its integer ring  is  Put  Let be a positive integer  and we put  We fix a lifting of -th Frobenius of on which induces the Frobenius homomorphism on and also denoted by  This extends canonically to  Now  we put  padic  -adic hyperfunctions and microfunctions  |   where runs through finite separable extensions of inside  Then this ring is naturally equipped with a -action  and a Frobenius homomorphism  We formally add       to get the ring of hyperfunctions  we define  The action of extends canonically to   so does   and we also have the monodromy operator  which is the derivation by   cf     loc   cit    S1 4   We put  In he defined to be but this should be a typo   where denotes the maximal unramified field extension of and is cf   diffmoddef   rings of analytical functions      Crew defined an -module by  padic  -adic hyperfunctions and microfunctions  |   cf    loc   cit    6 1 1    The action of the endomorphism and the nilpotent operator induce  by quotient  analogous structures on  We denote by the canonical projection  By definition  the derivation factors through and we get  These homomorphisms satisfy the relations and cf     loc   cit    S6 1    padic  -adic hyperfunctions and microfunctions 

 Let  categories Del    denote the category of Deligne  Deligne module  modules   This terminology was first introduced by Fontaine in  These are also called -modules  and this terminology is used more widely  especially in -adic Hodge theory  However  in our context  we believe that   Deligne module   is more suitable      shape i e    finite dimensional -vector spaces  endowed with a semi-linear action of  which acts on the constants via its residual action   a Frobenius isomorphism and a mo -no -dromy operator satisfying where in notationofCrint  See for more details  In the following  for simplicity  we denote by   differential operators Dan    Crew classifies holonomic - -modules in terms of linear data  cf    To do this  let be a holonomic - -module  He defined in   loc   cit     m bV   M     m rHom    ms D    mr an     M   m cB    qquad  m bW   M     m rHom    ms D    mr an     M   m cC     functors  V    These are Deligne modules  and define  contravariant  functors  There are the canonical homomorphism induced by and the variation homomorphism induced by  These satisfy many compatibilities  they are endowed with an extra structure  the   Galois variation    which we do not recall here   These kind of objects are called Solution data they form an artinian category  denoted  categories S    and we have an exact functor -   for the details see   loc   cit   The main point is that we can retrieve the original module from these linear data  indeed Crew constructs a quasi-inverse functor - factorizing through the category of holonomic - -modules  cf      loc   cit   7 1    functors  S    We can characterize some properties of in terms of these linear data  For example is connection type if and only if the canonical map is an isomorphism  cf    The most important property for us is the existence of the following exact sequence of Deligne modules  cf      loc   cit    Cor  6 1 1  Lemma 6 1 2    	0 arrow m rHom    ms D    mr an     M   m cO    mr an     K   mr ur     arrow m bV   M   arrow m bW   M   arrow m rExt  1   ms D    mr an     M   m cO   K   mr ur       mr an    arrow 0 
 	 forall i q 2  quad  m rExt  i   ms D    mr an     M   m cO   K   mr ur      mr an      m rExt  i   ms D    mr an     M   m cB     m rExt  i   ms D    mr an     M   m cC   0  Let us mention another property which will be useful later  Let be an holonomic - -module  If then is free as differential -module  cf     normalfont def free mod    By  eqre fvanishexact  it follows that is geometrically constant  which means that we have an isomorphism of Deligne modules  By the construction of the functor it follows immediately that natural evaluation map is an isomorphism of -modules  here denotes homomorphisms of -vector spaces   We have isomorphisms -modules   m rHom   K nr    mb V  M     m cO   K   mr ur      mr an       G   mc K     	 cong  m rHom   K nr    mb V  M    G   mc K    otimes K K nr   m cO   K   mr ur      mr an       G   mc K     cong  m rHom   K    mb V  M    G   mc K      m cO   K   mr ur      mr an       G   mc K    
 	 cong  m rHom   K    mb V  M    G   mc K      m cO    mr an     ms S    cong   m cO    mr an     ms S      oplus mr rk  M    which concludes the proof 

 Let be a formal curve over and let be a holonomic -module  Let be a closed point  We denote by    miscellaneous Si    where is the completion of for the -topology  Let be a coherent -module on  Take an open affine neighborhood of and we denote by the coherent -module on   l  DdagQ  widetilde  ms S  x   otimes   Gamma  ms U    Ddag Q ms X     Gamma  m sU   m sM   r     riangle   cf   Cr recall1  This does not depend on the choice of and we will also denote by its global sections on  For a holonomic - -module  cf   setupFrob   we put  m sM |  S x     Ddag Q ms S  x  otimes m sM     mr an    qquad  m sM |   eta x     m sD   ag   ms S  x  m bQ   0   otimes m sM     mr an     functors  3    which are defined in - and - respectively  For example we have and  The notation  resp   is slightly abusive  indeed  resp   depends  up to an isomorphism  on the choice of a local parameter of at cf   Remark rem indipendec par  The following lemma combined with shows that the functors and are exact  The functor from the category of coherent -modules to that of coherent -modules is exact  Let be  In this proof  we denote by  It suffices to show that the canonical homomorphism is flat  For this  it suffices to show that is flat where the is taken with respect to the filtration by order  This follows from the flatness of where the completion is taken with respect to the -topology 

 Let us recall the canonical extension  which is one of key tools in this paper  For the detailed argument  one can refer to  Let and     miscellaneous P    Then there exists a functor F mbo x-  m rHol   m sS  0  arrow F mbo x-  m rHol   Ddag Q Pone   infty    qquad  M  mapst oM    mathrm can   notag  functors  2    where - denotes the category of holonomic - -modules  By construction  this functor is fully faithful  exact  and it commutes with tensor products and duals  Moreover  we have the following properties  cf   loc   cit   Th   8 2 1 and paragraph after its proof   1   is a   special   convergent isocrystal  2     3   regular at  for the definition of regularity cf   def regularity  This is called the canonical extension of  By these properties  we remind that when is a free differential module  coincides with the canonical extension of Matsuda in and in this case  it sends unit-root objects to unit-root objects 

 In characterisation of Dan0 hol mod we have characterized holonomic - -modules  Let us conclude this subsection with a lemma characterizing holonomic - -modules  Let be an - -module  Assume that is a free differential -module  and the kernel and cokernel of the canonical homomorphism are punctual -modules  Then is a holonomic - -module  In particular  if there exists a holonomic - -module such that as -modules   without Frobenius structures   then is a holonomic - -module  We denote by the full subcategory of the category of -modules with Frobenius structure consisting of objects considered in the statement of the lemma  We define functors and in the same way as or especially    loc   cit     6 1 9    cf   also mainresultscrewrev  We first claim that and are exact functors  To see this  consider the following exact sequences 0 arrow  N  1 arrow  M  arrow  M   arrow 0 
 0 arrow  M   arrow  M  0  arrow  N  2 arrow0  where and are the kernel and cokernel of respectively  and thus punctual -modules by assumption  By hypothesis and Proposition characterisation of Dan0 hol mod we know that and are holonomic - -modules  and thus by considering the canonical extensions  cf   intcanext   we get that is a holonomic - -module as well  Thus  we get for  Considering the long exact sequence induced by the first short exact sequence above  we get for cf    Repeating the same construction of   loc   cit    6 1 10   and arguments of   loc   cit   Th  6 1 1   we get an exact functor from to the category of solution data  It suffices to construct a canonical isomorphism  This can be shown in the same way as   loc   cit   Th  7 1 1   The last claim of the lemma follows from the first because the analytification functor is exact  cf    loc   cit   Prop  5 1 1   for any holonomic - -module we have cf     loc   cit   Th   4 1 1     loc   cit   Lemma 4 1 4   and the analytification of a punctual module is punctual  cf     loc   cit   Prop  5 1 1  
Analytification
 In  Ssecdefforloc we will define a local Fourier transform  The local Fourier transform should be local not only in the scheme theoretic sense  but also   rigid analytically    In this subsection  we will prove a crucial tool  cf   Proposition analytifcisom  which is indispensable to prove such properties 

 In this subsection  we do not assume to be perfect  Let be a formal curve  and take a closed point in  Choose an isomorphism where cf   existconcdesc  We will define a ring  microdifferential operators analytic  |   in the following way  Let us use the notation of Cr recall1  To construct the analytification of we follow exactly the same way as in Abe   there are several steps  For the first step  we take the microlocalization of with respect to the filtration by order  cf    and denote it by  Second step  take the inverse limit over namely and denote it by  We put and we take the inverse limit over to define  Now  for an integer we want to define the analytification of  Also for this  we follow the same way as   loc   cit   Put  Let be either or  Then we define to be the subring of consisting of the finite order operators  Then we may prove in the same way as   loc   cit    that there exists a canonical homomorphism  psi  m m   colon Emo dm   nc x  otimes m bQ  arrow Emo dm  nc x   otimes m bQ   We define to be the -adic completion of  This ring is noetherian by the same argument as  We define  Finally we define   Ecomp Qm m   x     mr an     invlim  n  Ecom pm m    nc x  mb Q    Obviously  there exists the canonical inclusion  In the same way as for we define   Emo dm  ag  x  m bQ      mr an     invlim k   Ecomp Qm m k  x      mr an    qquad m sE   x  mb Q     mr an     indlim m   m sE     m  ag    x  mb Q      mr an    We point out that the rings does not depend on the choice of the isomorphism  cf   Remark Crewconstan  As an example  we have the following explicit description whose verification is left to the reader  We recall  cf   fieldconstmicdif that  for denotes the -Gauss norm on we have   Ecomp Qm m   x     mr an      sum  k<0 a k tial    angles m   k    sum  k q0 b k tial   angles m  k    Bigg arrowvert bo x7 5cm   and for any there exists such that for any and       microdifferential operators analytic  |   At last  let us fix a few notation  Let be a coherent -module  Let and be one of  We denote by or  This notation goes together with Notation setup

 We put a topologies for and on in exactly the same way as in topologyonring  Precisely  we put and we define a topology on as the topology generated by as a base of neighborhoods of zero  The topology on is the locally convex topology generated by as a base of neighborhoods of zero  and is the inductive limit topology  We get that is dense in where the intersection is taken in  Indeed putting the intersection is dense in  In the same way as topologyonring for any finitely generated -module  the -module topology is separated  Suppose we are in Situation   normalfont Ls   of   normalfontsetup    Moreover  we assume  Let be non-negative integers  and be a holonomic -module  not necessarily stable   We assume that  m rSupp   Ecomp Qm m  1   m sX   otimes   DcompQ m   m sX    m sM    cap mathrin gT   X  pi  -1  s  cap mathrin gT   X  Then the canonical homomorphism is an isomorphism  Suppose that is empty  In this case  the source of the homomorphism  EtoEan  is  Thanks to the following isomorphism   Ecomp Qm m   s     mr an   otimes   Dcomp m     m sM  cong   Ecomp Qm m   s     mr an   otimes   EcompQb m m    m sX     EcompQ bm m    m sX   otimes   Dcomp m     m sM   the target of the homomorphism is also and we get the lemma  Thus we may assume that  First  we will see that the source of the homomorphism has an -module structure for some integer  For this  let us start by remarking that is monogenic  Indeed  since is affine  the -th relative Frobenius homomorphism can be lifted  Let us denote this lifting by and  Let the -module be the Frobenius descent of  cf    Then by there exists a surjection  Apply to both sides  By composing with the canonical surjection we get a surjective morphism  Denote by the induced isomorphism  and put  By Lemma lemmaexspope there exist and a positive integer such that  Since the order of is less than there exists such that and we get that where  By increasing the integer we may assume that is divisible by  For any element in we get  Thus for any operator we also get  This implies that for any integer there exists such that Let be the absolute ramification index of and take which is divisible by  Let  We claim the following  For any sequence in which converges to seen as a sequence in the sequence in converges to using the -module topology  In particular the sequence converges to using the natural topology which makes the module an LF-space by Lemma topology and Lemma finiteness  Let us admit this claim first  and see that there exists a canonical -module structure on  For we may write with and the sequence converges to in  Then the claim says that converges to in  So we may define by and we get the action of on since the latter space is separated  Let us verify the claim  By  divreseachn  and the choice of we get  Bigl  fra cx r  p  Bigr  n equiv varpi nT n bmod  EcompQ bm m    m sX   cdot I   where    e g     when  We denote by the order of the image of in  Put  Let be an element of for some integers and  We may write Q  sum  n q 0 Q n Bigl  fra cx r  p  Bigr  n  where  Then for any  Thus  for any we get Q n Bigl  fra cx r  p  Bigr  n in  Ecomp bm m    m sX     M N    varpi  N    Ecomp bm m    m sX     EcompQ bm m    m sX   cdot I   where  Summing up  there exists an increasing sequence of integers such that if then  We can find a sequence of integers such that the sequence is strictly decreasing  Back to the claim  for any integer there exists such that for any  Then  we have and we get the claim  There are two natural homomorphisms  alpha colon EcompQ bm m    m sX   otimes   Dcomp m     m sM  arrow Ecomp Qm m   r s  otimes   Dcomp m     m sM   qquad  beta colon Ecomp Qm m   r s  otimes m sM  arrow  EcompQ bm m    m sX   otimes m sM   where is induced by the inclusion and is defined by extending linearly the canonical homomorphism using the -module structure on defined above  We can check easily that  Thus is injective  Let us see that is surjective  It suffices to show that is a homomorphism of -modules  Take an element  It suffices to show that for any  By density  cf   deftopoean   there exists an integer such that is contained in the closure of in  Consider the -module topologies on the both sides of  Since the both sides of are finitely generated over they are Fréchet spaces by deftopoean and by the open mapping theorem  the topology on the source of is equivalent to the -module topology  Since is -linear  it is continuous  Since the target of is separated  we get that  compatidisp  holds by the continuity of  We conclude that is an isomorphism  Let us finish the proof  It suffices to see that is an isomorphism where  When is a finite projective -module  the equality is obvious  By the same argument as Lemma flatness is flat over for any positive integer  Since is of finite homological dimension  there is a finite projective resolution whose length is by   If fact we can take to be   We have the following diagram where the bottom sequence is exact   xymatri x 0 ar r  	  EcompQ m m   s     mr an   otimes m sP  l ar r  ar d  	 ots ar r  	  Ecomp Qm m   s     mr an   otimes m sP  0 ar r  ar d  	   Ecomp Qm m   s     mr an   otimes m sM  ar r  ar d        	0
 0 ar r  	 Ecomp Qm m   nc s  otimes m sP  l ar r  	 ots ar r  	 Ecomp Qm m   nc s  otimes m sP  0 ar r  	  Ecomp Qm m   nc s  otimes m sM  ar r  	0   Let us show that for any  This is equivalent to saying since is finite projective  Let be the -adic norm on  Let be the closure of in with respect to -norm  Then  cf   the proof of  Now  apply to the system with respect to the -adic norm  and the claim follows  By applying to the bottom sequence of the diagram above  we get that the sequence  invlim  n  Ecomp Qm m   nc s  otimes m sP  1 arrow  invlim  n  Ecomp Qm m   nc s  otimes m sP  0 arrow  invlim  n  Ecomp Qm m   nc s  otimes m sM  arrow0 is exact  Since  isomwantanalyif  is an isomorphism for projective modules  by using the right exactness of tensor product   isomwantanalyif  is an isomorphism in general  and we conclude the proof of the proposition  Moreover  when we apply to the bottom sequence of the above diagram  we get that the vertical homomorphisms are isomorphisms  and thus the top sequence is also exact  This implies the flatness of over  Under the hypothesis of Proposition   normalfontanalytifcisom    suppose moreover that is stable  Then for the canonical homomorphisms  Emod bm   ag   m sX   m bQ   otimes   Dcomp m     m sM  arrow  Emo dm   ag  s  m bQ      mr an    otimes   Dcomp m     m sM   qquad E  ag   ms X   m bQ   otimes   Dcomp m     m sM  arrow  m sE    mr an    s  mb Q   otimes   Dcomp m     m sM  are isomorphisms  Clearly the first equality implies the second one  To prove the first one  it suffices to show that since is a Fréchet-Stein algebra  cf    For this we only need to repeat the argument of the last part of the proof of the previous proposition  Namely  we prove that using  The detail is left to the reader 

 Let be a formal curve over  Let be a stable holonomic -module  and let be a singular point of  Then by the Proposition analytifcisom for any integers the module  cf   localsetting  possesses a canonical -module structure  and in particular  we get a canonical homomorphism  psi colon  Dcomp Qm   s     mr an   otimes m sM  arrow Ecomp Qm  m    s  otimes m sM   Taking the inductive limit over we get a canonical homomorphism  m sM |  S s  arrow Edag Qs  otimes m sM   By an abuse of language  we sometimes denote the image of where is either or by  Let be an open affine neighborhood of such that there exists a local parameter at and is the unique singularity of in  Then by the proposition  we get  Now we define topologies as follows   i  We equip with the natural topology as an -module which makes it an LF-space by Lemma topology and Lemma finiteness  Note that this topology does not depend on the choice of by the same lemma   ii  We equip with the projective limit topology of the projective system of Banach spaces  This makes a Fréchet space   i  The topology on is also equivalent to the -module topology by Lemma topology   ii  The homomorphism is continuous by the claim in the proof of Proposition analytifcisom  In particular  if a sequence converges to in we get that converges to in

 The following corollary of Proposition analytifcisom plays an important role when we prove a fundamental properties of local Fourier transforms  cf   Lemma nongeometpt and locFourrel  Let and be two formal curves  and take points and  Assume that there exists an isomorphism of formal disks over   i  Let and be holonomic and -module respectively  and assume that  iota   l   Dcomp Qm  x     mr an   otimes m sM  r   xrightarro w sim   Dcomp Qm  x      mr an   otimes m sM   as -modules  Then there exists canonical isomorphisms  iota   l  Ecomp Qm m   x  otimes m sM  r  cong  Ecomp Qm m   x   otimes m sM    qquad  iota   l  Emo dm  ag  x  m bQ   otimes m sM  r   cong Emo dm  ag  x   m bQ    otimes m sM   for   ii  Let and be holonomic and -module respectively  and assume that  iota   m sM |  S x  cong m sM  |  S  x    as -modules  Then there exists a canonical isomorphism  First  let us prove  i   We get 	 iota   Ecomp Qm m   x  otimes m sM   xrightarrow       sim  iota    Ecomp Qm m   x      mr an   otimes m sM  xleftarro w sim  iota     Ecomp Qm m   x     mr an   otimes   Dcomp Qm   m sX      mr an    otimes m sM  
 	 qquad xrightarrow  iota    sim   Ecomp Qm m   x       mr an   otimes   Dcomp Qm   m sX       mr an   otimes m sM    xrightarro w sim   Ecomp Qm m   x      mr an   otimes m sM   xleftarrow       sim  Ecomp Qm m   x   otimes m sM    Here we used Proposition analytifcisom two times at and denotes the isomorphism induced by  To show the equality for it suffices to use Proposition analytifcisom Corollary ananddag and the Fréchet-Stein property of where is an affine neighborhood of  Now  let us prove  ii   Let be a -module  Let be a coherent -module such that and the same for  Then since these are coherent  there exists such that  m sS   x   otimes   ms S  x   Dcomp QN   m sX      mr an    otimes m sM    m   xrightarro w sim   Dcomp QN   m sX        mr an   otimes m sM     m    Thus  ii  follows from  i  
Equality between two definitions of irregularity 
 Another important corollary of Proposition analytifcisom is a comparison result of multiplicities of characteristic cycles  irregularity of Garnier  and irregularity of Christol-Mebkhout  cf   Corollary compCMGAR

 Let us review the definitions first  We assume that is perfect and that there exists a lifting of -th absolute Frobenius  Let be a solvable differential -module  cf   or  By a result of Christol and Mebkhout  cf   for free differential modules  or in general  there exists a canonical decomposition where is a differential -module purely of differential slope  slope differential slope   The irregularity of is defined by   irregularity |   We say that is regular  differential module  regular free differential module  if or equivalently  Let be a formal curve over and be a closed subset of such that its complement is dense in  Let be a convergent isocrystal on overconvergent along  For in we define the irregularity of Christol-Mebkhout  m rirr    mr CM   x  m sM     m rirr   m sM |   eta x    when we say that is regular at or that is a regular singularity for   Fi  -isocrystal  overconvergent isocrystal  regular singular point of  We also have the irregularity of Garnier  For simplicity  we assume moreover that possesses a Frobenius structure  Let us denote by the underlying -module of which is   a priori  a coherent -module  This is a holonomic module  and Garnier defined  In   loc   cit    he defined only in the case where is a -rational point  but we do not think we need this assumption here  In   loc   cit    is denoted by    for in  m rirr    mr Gar   x  m sM     chi l R shom   DdagQ  ms X     j   m sM    m cO    ms X   m bQ  |  S x  	  r  - m   xi x 0  j   m sM  -m x j   m sM      irregularity |   where  resp    denotes the vertical multiplicity at  resp   the generic rank  of cf   def cycl Dm and defCycl  Since is an isocrystal we have cf    The finiteness of was not known at the time Garnier defined the irregularity  now  using some results of Crew  based on the local monodromy theorem  this finiteness is easy  and this is also proven in the next corollary 

 The following corollary has already been announced  See A  Marmora    About p-adic Local Fourier Transform   Poster 2 at Journées de Géométrie Arithmétique de Rennes  available at   http   perso univ-rennes1 fr ahmed abbes Conference posters html    by the second author using a local computation  which is different from our method here  Let be a convergent -isocrystal on overconvergent along  Then we have Moreover  we have First of all  let us show the equality  garinv0  The ring has a canonical -module structure and identifies with cf   preisouadsf   let us denote it simply by  Let be a   flat  homomorphism of sheaves of rings on a topological space  For and we have  Using this  we have R n shom   DdagQ  ms X    j   m sM   m cO    ms X   m bQ  |  S x    cong R n shom   DdagQ  ms S  x     Ddag Q ms S  x  otimes j   m sM   m cO    mr an   
  cong R n m rHom    DdagQ  ms S  x     Ddag Q ms S  x  otimes j   m sM   m cO    mr an     cong R n m rHom    Dan  ms S  x  m bQ      Da n ms S  x  m bQ   otimes j   m sM   m cO    mr an    where the first and the last isomorphism follow by Lemma exactforloc and and the second is obtained by taking global sections  cf   Cr recall1 and also preisouadsf  Since is clearly of connection type  the canonical map  m rcan  colon  m bV   j   m sM  |   S  x   arrow m bW   j   m sM  |   S  x   is an isomorphism  cf    We have by  eqre fvanishexact  and  eqre fvanishexact2   from which it follows  The first claim is proven  Now  let us start the proof of the equality of the irregularities  The irregularity only depends on by definition  By Corollary analyticstructure combined with Theorem stabilitytheoremcy we get that only depends on its analytification as well  This says that we may assume and that is the canonical extension of  Note that  thanks to  garinv0   satisfies Grothendieck-Ogg-Shafarevich type formula  GOS-type formula  by  By we know that also satisfies GOS-type formula  The equality  equaliirrgarcm  holds when is regular singular at  Indeed  by the definition of regularity we have and it suffices to show that  Now  by using the structure theorem of regular -adic differential equation and the additivity of  cf     we may assume that is of rank  For this case we refer to  Finally  let us prove the general case  By GOS-type formulas  we get  chi  wideha t mb P    m sM  	  m rrk   m sM    cdot chi  wideha t mb P   - m rirr  x   mr CM    m sM  -  m rirr    infty    mr CM    m sM   
  chi  wideha t mb P    m sM  	  m rrk   m sM    cdot chi  wideha t mb P   - m rirr  x   mr Gar    m sM  -  m rirr    infty    mr Gar    m sM    By using the regular case we have proven  we get since is regular at  Thus comparing these two equalities  we get what we want 
Definition of local Fourier transform
 In this subsection  we define the local Fourier transform  We only define the so called -local Fourier transforms  In a later section  we will define an analog of -local Fourier transform in very special cases  and we do not deal with -local Fourier transform in this paper 

 Let us fix a situation under which we use the Fourier transforms  Let be a positive integer  and put  We assume that the residue field of is perfect  We moreover assume that the absolute -th Frobenius automorphism of lifts to an automorphism  We assume that the field contains a root of the equation  so that it contains all of them      miscellaneous pi  Dwork s  The Dwork exponential series in has a radius of convergence strictly greater than and it converges for to a -th root of unity  The choice of determines a non-trivial additive character    miscellaneous psi    by sending to  Conversely if is a non-trivial additive character  then is a -th root of unity in and the polynomial splits completely in  There exists a unique root of such that modulo and then we have  For the details see  We denote by  resp    the affine  resp   projective     miscellaneous A  |      miscellaneous P       miscellaneous P  |   line over with the fixed coordinate and we denote by  resp    its dual line  To lighten the notation we often put and     miscellaneous A  |   We denote by and  or and if we want to clarify the coordinates  the differential operators corresponding to and   differential operators delta    We denote by  resp    the point at infinity of  resp    Let and     miscellaneous P  |   To summarize notation once and for all  we use terminologies of the next section  and consider the following diagram of   couples   where and are the projections  These morphisms are not used till the next section  If we take to be  resp     we are in Situation  L  of setup using the fixed coordinate  We use freely the notation of setup especially  For a smooth formal scheme over we put  We denote by  resp    the coordinate of  resp    induced by  resp    The relative Frobenius of lifts to the morphism sending to  We have a similar morphism for and denote it by
 Let us introduce some notation for a formal disk around a closed point of  We put    miscellaneous S    and     miscellaneous S    We denote and by and respectively  Let be a finite unramified extension of and the ring of integers of  We put and denote by  Let be a closed point of the maximal ideal of associated to  We denote by the monic generator of and by a lifting of in which is a local parameter of at cf   coordinates   we denote also by its image in the completion of the local ring of at  We define    miscellaneous tau  |   by sending to  We note that if we take another lifting then there exists a canonical equivalence of functors and since and are congruent modulo  We denote and by and respectively  For let be the closed point of defined by  Let be the residue field of be the unique finite étale extension of corresponding to namely and be its field of fractions  Let be the closed point of defined by and  The rational point corresponds to an element of also denoted by and take a lifting of in  We have the homomorphism sending to  The functors and do not depend on the choice of up to a canonical equivalence  We denote and by and respectively  By the étaleness of over there is a canonical inclusion  We define by sending to  Also in this case  and do not depend on the choice of up to a canonical equivalence and we denote them by and respectively  Let be the finite étale morphism induced by sending to  Summing up  we defined the following morphisms   vcente r  xymatrix R 20pt C 30pt   widehat  mb A   1  R s  	  m sS    widetilde s    ar drrr  <>  8   sigma   widetilde  mf s     	  	  m sS   K s  ar d    iota
  wideha t mb A   1  R	  m sS   s  ar rrr    au s  ar urrr  <>  2   widetilde  au     widetilde  mf s     	  	 m sS     au  colon eta   infty   arrow eta  Here is the base change morphism     miscellaneous tau  |   Now  we recall that and we get the following isomorphism where the first isomorphism sends to and the second is that of Lemma fieldconstmicdif and thus

 Let be a stable holonomic -module and let be the set of its singular points    shape i e    closed points such that cf  stabledef  We follow the notation of setup  In particular  for non-negative integers and we consider the microlocalization cf  Notation not3 in setup  It is a finite -module by Lemma finiteness and using this can be seen as a finite -module  We put  microlocalisation of     which is considered as a differential -module  The fact that defines a connection follows formally from the relation in and the verification is like that for formal microlocalisation  cf   We warn the reader that the same notation has been used in localsetting but from now on  we refer only to  eqre fchanging not   The difference between the connections defined in localsetting and  eqre fchanging not  is due to the change of variable from to via the isomorphism  For a fixed the projective system defines a differential module on by Proposition rankcompat which is denoted by  microlocalisation of      This defines a differential -module which does not depend on the choice of up to a canonical isomorphism by the same proposition   i  Let be a holonomic -module  Let in be a singular point of  Take a stable coherent -module such that  Then defines the differential -module which does not depend on the choice of up to a canonical isomorphism  We see easily that this does not depend on the choice of as well in the category of differential -modules  We denote this differential -module by or if we want to indicate the base   functors local Fourier transform  |   and we call it   the local Fourier transform of at    When is not a singular point of we put  This defines a functor  m sF   pi   s  infty    colon m rHol   Ddag Q Pone   infty   arrow mbo xHol    eta    functors local Fourier transform  |   for any closed point  Here denotes the category of holonomic modules  and denotes the category of differential -modules  not necessarily free   cf   def Hol   If no confusion can arise  we omit the subscript   ii  Let be a holonomic - -module  and let  Take the canonical extension of at   this is an - -module on overconvergent along we have and is a regular singular point  cf   intcanext  We define   the local Fourier transform of at   to be  We denote it by or if we want to indicate the base  This defines the functor  Phi  pi    mf s   infty    colon F mbo x-Hol   m sS   arrow  mbo xHol    eta   K s     functors local Fourier transform    If no confusion can arise  we omit the subscript  We sometimes denote by  As in anyelem any defines an element in  We denote this element by   i  By using the stationary phase theorem SPT we may prove that the local Fourier transforms are   free  differential -modules  Moreover  we can also prove that the local Fourier transform coincides with that defined by Crew  cf   Corollary coinccrew  Using this  we will endow local Fourier transforms with a Frobenius structure later in  SendowFrob   ii  In Definition deflocFour  ii  above  we can also construct in a purely local way  i e   without using canonical extensions   For a holonomic -module with Frobenius structure  we define the local Fourier transform to be and put a connection in the same manner as in  eqre fchanging not  above  A problem of this construction is to see that this is a free differential -module  For this  we need to compare with Definition deflocFour  ii   and this is why we did not adopt this definition  Namely  the module coincides with by Lemma globalsectcalc below  As written in  i   we will prove that is a free differential -module  This shows that defines a free differential -module  which is what we wanted  By this comparison  once we have the stationary phase formula  the functor from the category of holonomic -modules   with Frobenius structure  to the category of -modules  is exact by Proposition exactness below  However  we do not know if is flat over or not  Here some basic examples to illustrate Definition deflocFour more properties will be proven in the sections  Ssection4 and  Ssection5   i  Consider the holonomic - -module  with the trivial Frobenius structure   The point is not singular  hence by definition    shape A posteriori  this can be also computed by the point  ii  of Remark locFordfnrem tensoring the presentation with   ii  Consider the - -module cf   coh op formal disk  The canonical extension at has the following presentation on   The -module is free of rank  the easiest way to prove this is to use Corollary irrandfotrans   the connection is trivial  it follows immediately by the definition   and the Frobenius it is also trivial  it follows using global Fourier transform and the stationary phase theorem  cf   stationaryfrobcom   iii  Consider the connection type holonomic - -module  Again we can compute globally  or locally  with exception of Frobenius   To proceed locally  we can consider the presentation of as -module  Crew s solution data functor permits to show that this is a presentation  cf   mainresultscrewrev   then tensoring with we reduce to the case LFTex2 above and so endowed with the trivial connection  To proceed globally we consider and use the global Fourier transform and the stationary phase  We obtain the trivial Frobenius structure on  The details are left to the reader   iv  For any the -module is stable but not holonomic  For any closed point of and we have which is of infinite type as -module  Let be a stable holonomic -module  and let in be a singular point of  We get an isomorphism  In particular  for a holonomic -module and its singularity we get  Using Proposition analytifcisom and Corollary ananddag there exists an affine open neighborhood of such that for  EcompQ bm m    m sU   otimes m sM  cong  Ecomp Qm m   s  otimes   Dcomp m     m sM   qquad  Emod bm  ag   m sU   m bQ   otimes m sM  cong  Emo dm  ag  s  m bQ   otimes   Dcomp m     m sM   Thus we get the lemma by the fact that is a Fréchet-Stein algebra  cf  

 Let be an unramified finite extension of  Then there exists a finite étale morphism sending to  This defines a functor   functors  Res    Then the following diagram of functors  xymatrix C 50p t F mbox -Hol   m sS  E  ar r    mr Res  E K  ar d    Phi E   0  infty     	F mbo x-Hol   m sS  K  ar d    Phi   0  infty    K 
 F mbo x-Hol    eta  E  ar r    mr Res   E   K   	 F mbo x-Hol    eta  K    is commutative up to a canonical isomorphism  The verification is straightforward  The functors and are exact  For it follows from Lemma flatness  For use the fact that taking canonical extension is exact  For we define a free differential -module  differential module  Dwork s|   in the following way  the underlying module is  The connection is defined as follows   nabla 1   widetild es  cdot pi u  -2  otimes du  Let be an element of whose class in is equal to that of  Then there exists a canonical isomorphism sending to  This shows that the differential module only depends on the class of in  Now  take an element  Let be a lifting of in  Then we get a differential -module  As proven above  this does not depend on the choice of liftings up to an isomorphism  We denote this abusively by  This is called the   Dwork differential module    differential module  Dwork s| 

 Using the notation of setupFour we have two lemmas  The definition of - -modules is recalled in setupFrob  Let be a holonomic - -module  and  Then there exists a canonical isomorphism  m sF     widetilde s   infty     K s   m sM  otimes K s   xrightarro w sim  Phi    mf s   infty     K s    widetild e au    mf s    m sM |  S  s    in the category  Here denotes the pull-back of to  There exists a canonical isomorphism  Using Corollary analyticstructure it suffices to show that there exists a canonical isomorphism  The verification is straightforward  Let be a holonomic - -module  and  Then we have a canonical isomorphism  m sF    s  infty     m sM   cong m rRes   K s  K   Phi   0  infty     widetild e au    mf s    m sM |  S s    otimes   mc R   K s   DwL  m fs     When is a -rational point  the verification consists into checking the definition using Corollary analyticstructure  When is not a rational point  we need to check that by using the notation and result of Lemma nongeometpt above  The verification is easy 
Complements to cohomological operations
 In this section  we review some known results of six functors which are indispensable in this paper  and give complements to properties of geometric Fourier transforms defined by Noot-Huyghe  The proofs for the properties of geometric Fourier transforms are almost the same as that of Lau so we content ourselves by pointing out the differences 
Cohomological operations
 In this section  we assume to be perfect  Let be an integer  and we put    miscellaneous hq    as usual  We assume that there exists an automorphism    miscellaneous sigma    which is a lifting of the absolute -th Frobenius on  Let be a smooth formal scheme over  We define by the following cartesian diagram   xymatri x  ms X   ar r  ar d  ar    rd  | square  	 m sX  ar d 
 m rSpf  R   ar r   sigm a	 m rSpf  R   For a -module we denote by the -module defined by changing base by  Note that even when there are no lifting of the relative Frobenius    miscellaneous F  |   to a morphism of formal schemes we are able to define the pull-back functor    miscellaneous F  |   from the category of -modules to that of -modules  cf    Recall that an - -module is a pair of a -module and an isomorphism  We often abbreviate by if there is nothing to be confused  Let  categories Dbc    be the derived category of -modules with bounded coherent cohomology  We define a complex of - -modules as a complex in endowed with an isomorphism in  We say that such complex is holonomic if its cohomology sheaves are holonomic - -modules  and we will denote by -  categories FhDbh  -   the category of holonomic - -complexes with bounded cohomology  cf    Let be a divisor of the of  We denote by -  categories FhDbh  -   the full subcategory of - of complexes such that the canonical homomorphism is an isomorphism  cf    We call them holonomic  complex of  - -modules 

 Let be a discrete valuation ring finite étale over and let be an object of -  Let be the Frobenius structure of  There exists a canonical -semi-linear homomorphism sending to  The composition where the first homomorphism is the canonical homomorphism  makes the complex a - -vector spaces  We note that this homomorphism is in fact an isomorphism since is  This correspondence induces an equivalence between - and the category of finite - -complexes  and we identify them 

 Let us fix notation for Dieudonné-Manin slopes  slope Dieudonne-Manin slope  and Tate twists  Recall that we denote by the absolute ramification index of  We denote by the ring of non-commutative polynomials defined by the relation for every  For any and integer we put K    alpha  seh     Ct ngle t  rangle  Ct ngle t  rangle t s- alpha    Fi  -isocrystal  overconvergent isocrystal    endowed with the Frobenius action given by the multiplication on the left by  It is a - -module of rank  When we normalize the Dieudonne-Manin slope so that it is purely of slope  For any smooth formal scheme over we denote by the pull-back of by the structural morphism of  Let us define Tate twists  For any -module and integer we put  m sM  n    m sM  otimes   mc O    ms X   m bQ     m cO    ms X   m bQ     p  -hn   eh     slope Dieudonne-Manin slope  -th Tate twist   This is called the -th Tate twist of  Let us define the twist by a Dieudonne-Manin slope  There is a unique way to write where and are coprime integers and  if by convention we put and  Let be a uniformizer  for any coherent -module and we put  m sM    mbda     m sM  otimes   mc O    ms X   m bQ     m cO    ms X   m bQ      varpi  -r   seh     slope Dieudonne-Manin slope twist by   which is usually called the twist  This is called   shape d  ecal  e  in French   of by the slope  When its Dieudonne-Manin slope is indeed shifted by  The notation is slightly abusive because it depends on the choice of the uniformizer whereas that for Tate twists is intrinsic  We give analogous definitions for overconvergent -isocrystals and free differentials modules with Frobenius structure over the the Robba ring 

 To fix notation  let us review the theory of arithmetic -modules concerning this paper  We say that is a d-couple  d-couple  if is a smooth formal scheme and is a divisor of its special fiber  Here  can be empty  Let be another d-couple  A morphism of d-couples is a morphism such that and is a divisor  The morphism is called the realization of and if it is unlikely to be confused  we often denote by  Let be a property of morphisms  We say that the morphism of d-couples satisfies the property if satisfies the property  Let be a smooth formal scheme over be its special fiber  and be its Raynaud generic fiber  Then we have the specialization map of topoi  Recall that  we say that a -module is a convergent  - isocrystal if is a convergent  - isocrystal  and the same for overconvergent  - isocrystals  cf   conventionocisoc  Let be a d-couple  and we denote by the dual functor with respect to -modules  If it is unlikely to cause any confusion  we often denote this by   functors six operations D    Let be a morphism of d-couples  We have the extraordinary pull-back functor from the category of coherent -modules to that of -modules  cf    Let be a bounded coherent  -  -complex  When is coherent  we define  functors six operations f  |  to be  Suppose in turn that is a bounded coherent  -  -complex  In this case  we put f   m sM    l  m bD    ms X  Z  circ f   circ  m bD    ms Y  W  r    m sM     functors six operations f  |   Now  suppose that the morphism of d-couples is a proper morphism  We have the push-forward functor from the category of coherent -modules to that of coherent -modules  Let be a  -  -module  Suppose is coherent as a -module  Then we denote by  functors six operations j    this coherent module  We define  functors six operations f  |   to be the coherent -module  Assume in turn that is coherent as a -module  We define f   m sN    l  m bD    ms Y  W  circ f   circ m bD    ms X  Z  r    m sN     functors six operations f  |   When we are given and in  categories LD     cf   for the notation when is empty  but the construction is the same   we denote the object in by   functors six operations t  | 

  newcounte renumip  In this paragraph  let us summarize some properties of the cohomological functors defined in the previous paragraph which will be used later in this paper  Let be a morphism of d-couples  We denote respectively by the dimension of and  Then we get the following  em If is smooth and of constant relative dimension  we get  cf    If is a closed immersion of connected formal schemes and is an overconvergent -isocrystal  we get  cf    For conventions on brackets and parenthesis see  eqre fconvention-Tatetwist-shifts   em If is proper and is also proper  we get  cf    em Let be an object of and be an object of  There exists a canonical isomorphism  cf    The compatibility with Frobenius pull-back can be seen easily from the definition of the homomorphism     setcounte renumip   heenumi  By using smoothpoin above  we get  Now  we define the twisted tensor product  functors six operations t  |   on to be  We note that the definition is slightly different from that of NH  The main reason we introduce this new tensor product is the following   setcounte renumi   heenumip  em Assume that is a morphism of connected formal schemes  There exists a canonical isomorphism  Similarly  we also have  cf     setcounte renumip   heenumi  The following result enables us to compare these two tensor products in special cases   setcounte renumi   heenumip  em Assume is connected  If be an overconvergent -isocrystal  and be a coherent - -module  Then we get  cf     setcounte renumip   heenumi 

 Now  let us see the proper base change theorem  Consider the following cartesian diagrams of d-couples   xymatri x   ms X   Z   ar r   i   ar d   f   ar    rd  | square  	  m sX  Z   ar d   f
  m sY   W   ar r   i	  m sY  W    Here  we say that the diagram of d-couples is cartesian if it is cartesian for the underlying smooth formal schemes  and  Then we get  cf    This isomorphism is compatible with Frobenius structures by the same theorem  We call this the proper base change isomorphism  Assume that is proper  In this case  for a bounded coherent  - -complex we get if the both sides are defined  This follows by using  This is also called the proper base change isomorphism 

 We also have the K   u nneth formula  Namely  let and be smooth morphisms between smooth formal schemes over a smooth formal scheme  Let be a divisor of the special fiber of  We denote by  resp    be the divisor of the special fiber of  resp    which is the pull-back of  Let  resp    be an element of  resp    Then we get  f mes g     m sM  boxtimes   mc O    ms T   D     mb L   m sN    cong f   m sM   boxtimes   mc O    ms T   D     mb L   g   m sN   in  To see this  we apply the K   u nneth formula to the diagram  xymatrix R 10pt C 30p t 	 ms X  mes   ms T   m sY  ar dr   f mes mr id   ar dl     mr id  mes g  ar dd   f mes g
 m sX  mes   ms T    m sY   ar dr   f mes mr id   	  m sX   mes   ms T   m sY  ar dl    mr id  mes g 
	  m sX   mes   ms T   m sY   	  and on and on

 In this paragraph  let us see the relation between the rigid cohomology and the push-forward of arithmetic -modules  Let be a   proper  smooth formal scheme of dimension  Let be a divisor of the special fiber of be the complement  and be its special fiber  We denote by the specialization map where denotes the Raynaud generic fiber of  Let be the structural morphism  Let be a coherent -module which is overconvergent along  Suppose that it is coherent as a -module  In prop6func we noted that  For an isocrystal we denote by the dual as isocrystal  This isomorphism leads us to the following comparison of dual functors  cf     We get the following relation with the rigid cohomology  where  For the details of the proof  see  To see the relation for cohomologies with compact support  we use the Poincaré duality of rigid cohomology to get For the detailed account  one can refer to  When is a curve  and for a holonomic -module we get that the following pairing is perfect  This can be seen from

 For the later use  we review the cohomological functors and in the theory of formal disks  Let be the formal disk over  For an object in - is by definition  functors six operations j    the underlying - -module  For an object in - we denote in - by  We denote by the closed immersion  The definitions of the functors are essentially the  functors six operations i  |    functors six operations i    same as in the global case  and are used frequently in Cr so for the details see    loc   cit   3 4    etc     Now  we denote by  resp    the dual  functors six operations D    functor with respect to  resp    These define functors from -  resp   -  to itself by  For an object in - we define  functors six operations j    and for an object in - we put where denotes the  functors six operations i  |    functors  4    dual of - -vector spaces  By using facts of prop6func we get isomorphisms and  By using these isomorphisms  the localization triangle induces the following distinguished triangle  For a holonomic - -module we put and and call them the nearby cycles and the vanishing cycles respectively  These define functors  Psi  Phi colon F mbo x-  m rHol   Da n ms S   m bQ    arrow De l Ct nr  G   mc K      functors  Psi    We note here that when is a free differential module on with Frobenius structure  we get where denotes the dual as a -module by  carodualfrob  For example  On the other hand  if is of punctual type such that where is a -vector space with Frobenius structure  we get that  Let be an object of -  Then we get the following exact sequence  0 arrow  M    tial 0  1  otimes K elta arrow j   M  arrow j   M  arrow  M   tial  M  1  otimes K elta arrow0  Since we get by  We also get  Thus   vanishexact  induces the following exact sequence  0 arrow m rHom    ms D    mr an     m bD  j   M     m cO    mr an    K   mr ur     arrow Phi j     M   arrow Phi j     M   arrow m rExt  1   ms D    mr an      m bD  j   M    m cO    mr an    K   mr ur     arrow0  We get isomorphisms R m rHom    ms D    mr an     m bD    ms S   j   M     m cO    mr an    cong R m rHom    ms D    mr an     m cO    mr an   -1  j   M   cong R m rHom    ms D    mr an   0    m cR   M   1   Here the first isomorphism follows from the fact that gives an anti-equivalence of categories combined with the isomorphism and the second by adjoint  Thus the lemma follows  We note that the dimension of and over are the same by the index theorem of Christol-Mebkhout
Geometric Fourier transforms
 We briefly review the definition of geometric Fourier transform due to Noot-Huyghe NH  For simplicity  we only review under the situation of setupFour  To define Fourier transforms  we need to define an integral kernel of the transform   Fi  -isocrystal  overconvergent isocrystal  Dwork s|   We define a convergent -isocrystal on overconvergent along denoted by in the following way  Let be the coordinate  As an -module  it is  We denote the element corresponding to by  We define its connection by  nabla e  - pi e otimes dt  This module is equipped with Frobenius structure  The Frobenius structure is defined by  Phi 1 otimes e    exp  pi t-t q  e   Fi  -isocrystal  overconvergent isocrystal  Dwork s|   Now  let us consider the situation in setupFour  There exists the canonical coupling sending to     miscellaneous mu  canonical coupling  By the general theory of overconvergent -isocrystals  the pull-back is a convergent -isocrystal on overconvergent along in  This is a coherent -module  and its restriction to is nothing but  By abuse of language  we denote this -module by or sometimes by  In the same way  there exists a unique coherent complex of -modules whose restriction to is  We also denote this by

 Now  let us recall the definition of the geometric Fourier transform  We continuously use the notation of setupFour  Recall the diagram  fourierdiagtwo  Let be a coherent -module  Noot-Huyghe defined the geometric Fourier transform of to be  m sF    pi   m sM  	  p     m sL    pi  mu  otimes   mc O     Poneoned  mb Q    infty     mb L   p   m sM  -2  
  nota g	 l  p     mu   m sL    pi  otimes   mc O     Poneoned  mb Q    infty     mb L   p   m sM  -3   r    functors geometric  global  Fourier transform    She also proved that is well-defined  and also showed an analog of the result of Katz and Laumon Huy2  see for a proof   Namely  the canonical homomorphism is an isomorphism  Since Fourier transform is defined using three cohomological functors and there is a canonical Frobenius structure on Fourier transform commutes with Frobenius pull-backs  In particular  if is a coherent - -complex  there exists a canonical Frobenius structure on the complex  We have a canonical isomorphism  mu   m sL   pi 1  2  cong mu   m sL   pi  Note that is smooth  This shows that and are generically isomorphic by prop6func smoothpoin  The module is concentrated at degree and it is finite over  This implies that it is an overconvergent isocrystal along  Since the dual of an isocrystal is also an isocrystal  is also an overconvergent isocrystal along  Moreover  both sides are overconvergent -isocrystals  Thus  the two modules in the statement are isomorphic by using Kedful and

 Let be a closed point of  Let be the residue field and be the corresponding unramified extension of its valuation ring  Then there exists a closed immersion sending to  We define   Fi  -isocrystal  overconvergent isocrystal  Dwork s  In the same way  given a closed point in we define on  When is a rational point  we can check that where is the Dwork differential module locASdiffmod on

 Finally  let us review a fundamental property of Fourier transform shown by Noot-Huyghe  There exists an isomorphism of rings  iota colon Gamma  Poned  Ddag Q Poned   infty    xrightarro w sim   Gamma  Pone  Ddag Q Pone   infty   sending to and to  It is also shown by Huyghe that coherent -modules corresponds to -modules by taking global sections  Given a coherent -module we denote by  functors naive  global  Fourier transform  |   the coherent -module obtained from via transport of structure by  For we denote by the corresponding element of  Let be a coherent -module  We denote by the coherent -module corresponding to  We call this the   naive Fourier transform  of  Then Noot-Huyghe showed in that there exists a canonical isomorphism We often denote by to mean  For simplicity  we will often omit the index in the notation or   functors naive  global  Fourier transform  | 

 Standard properties of -adic geometric Fourier transform explained in hold also for -adic Fourier transform with suitable changes  Since the proof works well with little change  we leave the reader to formulate and verify these properties  Although the most of these properties are not used in this paper  we still need a few analogous results  We will write the statements of these results with short comments of the proofs        Let be a coherent - -module    i e    a finite dimensional - -vector space   Then  we have a canonical isomorphism  m sF  q   V   cong i  0    V  1   where denotes the structural morphisms  and is the closed immersion defined by in  When is trivial  another calculation for this Fourier transform was carried out by Baldassarri and Berthelot in BB  In their calculation  there are no Tate twist contrary to our calculation here  This is because the definitions of the Frobenius structures on the geometric Fourier transform are slightly different  For the precise argument  see

 Let be the dual geometric Fourier transform  the functor defined in the same way as except for reversing the role of and  We get the following inversion formula        Let be a coherent - -module  Then  there exists a functorial isomorphism  m sF   circ m sF   m sM   2  cong m sM  1   We may also prove the theorem in more general cases  let be a smooth formal scheme over and let be a locally free sheaf of finite rank on  Consider the projective bundle to define the geometric Fourier transform  cf    Then the theorem is reformulated as  Let be the divisor at infinity of  For the proof  we need to show that there exists an isomorphism  This can be seen from and

 Let  We define a convergent -isocrystal on overconvergent along in the following way  As an -module  it is isomorphic to  We denote the global section corresponding to by  We define its connection by  nabla e    alpha x  -1   cdot e otimes dx  The Frobenius structure is defined by  Phi 1 otimes e   x   alpha q-1   cdot e  We often use the same notation for the underlying coherent -module  This is called the   Kummer isocrystal    Fi  -isocrystal  overconvergent isocrystal  Kummer s        Let be the canonical morphism of couples  Assume  Then we get that the canonical homomorphism j  j   m sK   alpha arrow m sK   alpha is an isomorphism  Moreover  let be the following -vector space with Frobenius structure  G  alpha  pi   H 1   mr rig    m bA  k 1 setminus 0   m sK    alpha otimes m sL   pi    Fi  -isocrystal  overconvergent isocrystal    Then  we have  m sF   pi  m sK   alpha  1  cong m sK   1- alpha  otimes G  alpha  pi  1   The first statement follows from Lemma calcofdiff  For the latter claim  the proof works essentially the same as in Lau by replacing by and using the K   u nneth formula kunnethformual  The Tate twist appearing here comes from the isomorphism  rigDmodpush
Stationary Phase
 In this section  we will prove the stationary phase formula when the differential slope at infinity is less than or equal to  However  in this section  we do not consider Frobenius structures on the local Fourier transforms  so the stationary phase in this section is still temporary  This will be completed in the next section  Throughout this section  we continuously use the assumptions and notation of paragraph setupFour
Geometric calculations
 Following we will define several invariants which will be used throughout this section  Let be a solvable differential module on the Robba ring  cf   or  We denote by the rank  by the irregularity  cf   irr   and by the greatest differential slope of as usual  By a result of Christol and Mebkhout  cf   or in general   we get the differential slope decomposition where is purely of slope  For any interval we put  Let be a holonomic - -module  For any closed point in we put r  m sM  	  - m rrk   m sM |   eta z   q 0 	 qquad s x  m sM  	  - m rirr   m sM |   eta x   q 0 
 r x  m sM  	   m rdim   K x  i x   m sM   	 qquad a x  m sM  	  r  m sM   s x  m sM  -r x  m sM     local constants    where can be taken to be any closed point in and is the closed immersion for  The following lemma compare these invariants to the generic rank and the vertical multiplicity  cf   def cycl Dm and defCycl  We preserve the notation  Let    m rCycl   m sM |   Aone   r cdot  m bA  1   sum  x in | mb A  1|   m x cdot  pi  -1  x    Recall that is the canonical projection and is the set of closed points  Then we have and  for any closed point  This follows from Corollary compCMGAR  Let be a complex of where the latter category is the derived category of complexes of -vector spaces whose cohomology is finite dimensional  We put  Let be the structural morphism  Let be a coherent - -module  We define     miscellaneous chi    We know that the Grothendieck-Ogg-Shafarevich type formula holds by or  Using the above lemma  we can write the formula as follows  Let be a holonomic -module  and let be a singular point of  Then we get  m rrk   m sF    x  infty     m sM    - eg x  cdot a x  m sM    This follows from the definition of the local Fourier transform  cf   deflocFour   using the stability theorem  cf   stabilitytheoremcy -i   combined with Proposition levmcharcycle and Lemma lemcyclecalc  Using the notation of Lemma   normalfontlemcyclecalc    we get if and only if  When we know that is a convergent isocrystal on an open neighborhood of and the lemma follows easily  Let us see the   only if   part  We know that by  By we get i x   m sM  cong R m rHom   m sM |  S x   m cO    mr an       1   where denotes the dual in the derived category  The exact sequence  vanishexact  implies and thus  By Lemma W 0 we get that is a free differential -module  and in particular  Let be a solvable free differential module on the Robba ring over  We further assume that is purely of differential slope  Let be the Dwork differential module  for cf     normalfontlocASdiffmod    We consider the tensor product as a differential -module  Then we get the following   i  For almost all we get  m rirr   K s   M  otimes   mc R   DwL  m fs     m rrk   M    where denotes the irregularity as an -module   ii  There exists an in such that the irregularity is less than  Let us prove  i   We use the induction on the rank of over  Suppose there exists a geometric point such that  m rirr   M  otimes DwL  m fs   < m rrk   M    qquad  m rpt   M  otimes DwL  m fs    1  These conditions show that has at least two slopes including  Thus  there exists the canonical decomposition where is purely of slope and is purely of slope less than and these modules are non-zero  Thus  we get the decomposition  M  otimes KK s  M   1 otimes DwL - m fs   oplu sM    <1   otimes DwL - m fs    Since is purely of slope both and are purely of slope as well  Thus by the induction hypothesis  the lemma holds for these two modules  This implies that the lemma also holds for  If for any we get the lemma by the above argument  Suppose for some  Then for any we get  If there exists such that then we may use the above argument  Otherwise  the lemma is trivial  Now  let us move to  ii   By using there exists a number in whose absolute value is and an integer such that the irregularity of is less than  Here we are using the notation of   loc   cit   We remind that in   loc   cit    there is an assumption on the spherically completeness of  However  as mentioned in    loc   cit    2 0-4   this hypothesis is used only to use a result of Robba  and when the assumption was removed by Matsuda as written there  This result was extended also to the case by Pulita and we no longer need to assume the spherically completeness here  Arguing as the proof of using  In   loc   cit    is assumed extensively  However  the proof of Lemma 1 5 works also for without any change    there exists a number in whose absolute value is such that is isomorphic to as differential -modules  and the latter is isomorphic to where the overline denotes the residue class 

 Let be a coherent - -module  We denote by the geometric Fourier transform  We have the following analog of   i    i    ii  For we get r  s    m sE    r  m sE     m rrk    m sE |   eta  infty    1   - m rirr    m sE |   eta  infty    1  otimes m sL  x cdot s  |    eta  infty     ii   For we get r  s   m sE   r  m sE    m rrk    m sE  |   eta  infty    1   - m rirr    m sE  |   eta  infty    1  otimes m sL  s cdot x  |    eta  infty     iii   iii   The idea of the proof is the same as that of   loc   cit   We sketch the proof  By the proper base change theorem properbasech we get r  s    m sE     chi  Aone  m sE  otimes m sL  x cdot s     Let us prove  i   Since both sides of the equality are invariant under base extension  we may assume that consists of rational points  We have for since has no singular points in  Using  GOSformula   it remains to show -r  m sE  - m rirr   m sE |   eta  infty  otimes m sL  x cdot s  |    eta  infty    m rrk    m sE |   eta  infty       1  infty 1  infty 1  infty 1  infty 1  infty 1  infty Let be a holonomic - -module whose   differential slopes at infinity are less than or equal to    Let be the set of singular points of in  Then the canonical homomorphism is an isomorphism  First of all  we will reduce to the case where consists of rational points  There exists an unramified Galois extension of such that consists of -rational points where denotes the residue field of as usual  Note that  n F ms M  |   eta   infty    otimes K E cong  n F ms M  otimes K E |   eta   infty     qquad  m sF    s  infty     m sM   otimes K E xrightarro w sim  oplus   s  mapsto s  m sF    s   infty    m sM  otimes K E   where the direct sum in the second isomorphism runs over the set of closed points of which map to  Indeed  the first isomorphism follows since the cohomological operators used in the definition of geometric Fourier transform are compatible with base change  The second isomorphism follows from Lemma locFourrel and nongeometpt  Since the left hand sides of these two isomorphisms have the action of we define a -action on the right hands sides by transport of structure  Note that the -invariant parts are isomorphic to and respectively  By definition  the following diagram is commutative  xymatrix C 50p t  nF  ms M  |   eta   infty    ar r  <>  5   alpha s  ar d  	 au    m sF    s  infty     m sM   ar d 
  n F ms M  otimes K E |   eta   infty    ar r  <>  5    oplus alpha  s    	 oplus  s  mapsto s  au     E  m sF     s   infty    m sM  otimes K E     where denotes over  Thus  if the theorem holds for then it also holds for by taking -invariant parts  and the claim follows  From now on  we assume that consists of rational points  Now  we will see that is surjective for any  By the exactness of Fourier transforms and local Fourier transforms  cf   Lemma exactness and  compgeomnaive    it suffices to show the claim when is monogenic  Suppose it is generated by  Let be a differential -module  where satisfying the following  em where 	   em there exists an element which is mapped to 	 in 	by the canonical injective homomorphism 	  Now  let be a stable coherent -module generated by a single element in such that and is sent to via this isomorphism  Then there exists an integer such that and is induced by a homomorphism sending to  To see that this is surjective  it suffices to show that the canonical homomorphism heta colon m cA   <>  5  F   ms F    mr naive    rho    ar d    silon   Ddag     	 F    n F ms M    ar d    silon   ms M   
  n FF   DdagQ  Pone   1     infty   ar r  <>  5    ms F    mr naive  F    rho   	 n FF   ms M      Thus the lemma follows  Let be a holonomic - -module  Let  We denote by the canonical extension of at  Recall the notation of setupFour  Let  widetild e alpha  s  colon au    n F ms M  |   eta  infty  xrightarro w sim   Phi    mf s   infty     M   be the isomorphism given by the stationary phase theorem  Here we used abusively the notation and on  Since and commute  the isomorphisms and induce an isomorphism as follows    miscellaneous eps    silon   M   m fs   colon F   l  Phi    mf s   infty    M  r   xrightarrow  sim  F    widetilde  alpha  s  -1    	 F   l au    n F ms M  |   eta  infty  r   xrightarro w sim  au    l F   n F ms M  |   eta  infty  r 
 	 xrightarro w au    silon   ms M   |   eta  infty   au    l  n F ms F  M  |   eta  infty  r   xrightarrow  sim  F    widetilde  alpha  s    Phi    mf s   infty    F   M    We define the Frobenius structure on by composing this isomorphism with the isomorphism of functoriality induced by the Frobenius structure of  Let be a holonomic - -module  Let be a -rational point of and be the translation isomorphism of sending to  Then we have an isomorphism compatible with Frobenius structures  m sF   pi mma   s m sM   cong m sF   pi  m sM    otimes m sL  -s cdot x    The proof is formally the same as that of using the K   u nneth formula kunnethformual so we leave the details to the reader  Let be a holonomic - -module  and be a -rational point of  Then we have the following isomorphism compatible with Frobenius structures   Phi   s  infty     M   cong Phi   0  infty     M    otimes DwL s   Let denotes the canonical extension of at  By the previous lemma  we know that  By definition  the stationary phase isomorphism  m sF  mma s   m sM  s |   eta   infty    xrightarro w sim   m sF    0  infty    mma s   m sM  s  cong au    Phi   0  infty     M   is compatible with the Frobenius structures  Tensoring both sides with we get the lemma  Let be a holonomic - -module  and  Recall the isomorphism silon   M   m fs   colon F    Phi    mf s   infty      M    xrightarro w sim  Phi    mf s   infty     F   M   in Definition   normalfontdfnlocalfrobfou    Then for any we have silon 1 otimes wideha tm    au     Upsilon  cdot  wideha t1 otimes m   Here  is the operator of Lemma   normalfontglobalfourier    Since Frobenius structures are compatible with base changes and does not depend on a base as well  we may suppose that is a -rational point by Lemma nongeometpt  From now on  we assume that is a rational point  Let be the canonical extension of at  Let be the unique homomorphism making the following diagram commutative   xymatrix C 70p t F    ms F    s  infty     M    mr can     ar r    sim   ar   >  d    silon   M    mr can     	 F    Phi   s  infty     M    ar d    silon   M  s  
  m sF    s  infty    F   M    mr can     ar r    sim   a  	  Phi   s  infty    F   M     Here the horizontal isomorphisms are induced by the canonical isomorphism  For any we get by Lemma globalfourier  Let be a differential -module with Frobenius structure such that and let be a stable -module such that  We note that  There exist an integer and isomorphisms  m cA     sim  	 F   Emo d underline n   ag  s   m sM    m    ar   >  d    silon    underline n      ar      ->  r  	 F    m sF    s  infty     M    mr can     ar d    silon    M    mr can    
  m cA    b  	  m sF    s  infty    F   M    mr can      is commutative  Let be the unique isomorphism making the above diagram commutative  We have for any by the injectivity and  comingfromglob  We put  By changing we may take  Let  We may assume that by increasing if necessary  This element can be seen as an element of with some integer  By Remark anyelem  ii   there exists a sequence in with which converges to in using the topology induced by the -module structure  Consider the topology induced by the finite -module structure  By Lemma topology these topologies are equivalent  and we get that the same sequence converges to also in this topology  Since F   Ecomp Qm m   s   m sM    m    cong C K Aone   tial     m  fr m   fr   otimes   CK  Aone   1     tial    m m      Ecomp Qm m   s   m sM    m    by definition  the sequence in converges to the element using the -module topology  Since is a homomorphism of finite -modules  it is in particular a continuous homomorphism of topological modules over the noetherian Banach algebra  Since the topology is separated  we get silon   m   1 otimes wideha tx    lim   i arrow infty  silon   m   	 1 otimes wideha tx i     lim  i arrow infty  au     Upsilon  cdot 1 otimes x i    wedge
	  au     Upsilon  cdot lim  i arrow infty   1 otimes x i    wedge   au     Upsilon  cdot 1 otimes x    wedge   Now  we get silon   M  s  1 otimes wideha tx    c silon   m   1 otimes wideha tx    c au     Upsilon  1 otimes x    wedge    au     Upsilon   1 otimes x    wedge   and the proposition follows  Let be a holonomic - -module  Let be a singularity of in  Take a geometric point sitting over  We define the Frobenius structure on by using the canonical isomorphism of Lemma locFourrel  m sF    s  infty     m sM   cong m rRes   K s  K l  Phi     mf s   infty      au   s   m sM |  S  s    r   The Frobenius structure is well-defined since it does not depend on the choice of by Proposition frobstruccalcabsw  The regular stationary phase isomorphism   normalfont stationaryhom   is compatible with Frobenius structures  To show this  it suffices to show that the following diagram is commutative   xymatrix C 80p t F   nF  ms M  |   eta  infty  ar r  <>  5   sim   ar d    sim  	 oplus  s in S  au   F   m sF    s  infty    m sM    ar d    sim
  n FF   ms M  |   eta  infty  ar r  <>  5   sim  	 oplus  s in S  au    m sF    s  infty   F   m sM     The left vertical arrow is defined by the Frobenius structure of geometric Fourier transform  and the right vertical arrow by Definition dfnlocFourFrob  To show that it is commutative  it suffices to show the commutativity for for any  This follows from the description of the vertical isomorphisms in terms of the operator given in Lemma globalfourier and Proposition frobstruccalcabsw
Explicit calculations of the Frobenius structures on Fourier transforms
 To calculate the Frobenius structure of Fourier transforms concretely  the results of the last subsection imply that all we need to do is to determine the differential operator  To calculate this  it suffices to calculate the isomorphism  Phi   silon   DdagQ  Pone   infty   colon F    n F DdagQ  Pone   1     infty    xrightarro w sim   n FF   DdagQ  Pone   1     infty   concretely  which is the goal of this subsection 

 Recall the notation of setupFour and consider the following diagram   xy  xymatrix C 40pt R 10p t 	  Poneoned  ar dr  ar dl  ar dd  |F   Poneoned   
  Pone ar dd   F   Pone   	  Poned ar dd   F   Poned  
 	 Poneoned   1   ar dr  ar dl  
  Pone   1   	  Poned   1    ef objectstyl e scriptstyle  ef styl e scriptstyle   xymatrix C 40pt R 10p t 	 
    -1 4  x  	    -7 4  x 
 	 
    -1 -1  y  	    -7 -1  y     xy Here  means and small letters denote the coordinates  The middle vertical morphism is defined by sending and to and respectively  By the definition of the morphisms  we note that the diagram is commutative  To proceed  we will review the construction of the fundamental isomorphism  m sH   1  m sF    pi   Ddag Q Pone   infty   xrightarro w sim   n F DdagQ  Pone   infty   of Noot-Huyghe  compgeomnaive  First  we recall that cf   allows to compute direct images and we consider consider the Spencer resolution    Ddag Q Poneoned  Z  otimes wedge   bullet  m sT    Poneoned  Pone  arrow Ddag Q Poneoned arrow Pone  Z   Here denotes the relative tangent bundle of over  She showed that we can calculate using this resolution  namely  there exists an isomorphism  m sF   Ddag Q Pone   infty   cong p        Ddag Q Poned arrow Poneoned  Z   otimes   DdagQ  Poneoned  Z    m sL    pi  mu  otimes   mc O     Poneoned  mb Q   Z   Ddag Q Poneoned  Z   otimes wedge   bullet  m sT    Poneoned  Pone     Then  she defined a homomorphism and showed that this factors through the geometric Fourier transform  Let us recall how  fourierlast  is defined  We identify The homomorphism sends to where is the canonical section of  cf   defoflofdw  To verify that this defines a homomorphism  see  Before starting the calculation  we introduce the Dwork operator  Let be a smooth formal scheme possessing a system of local coordinates  Let be the system of local coordinates of induced by pulling-back  We uniquely have a lifting of the relative Frobenius morphism sending to  Then we put H   ms X     fra c1  q d  prod  1 q i q d  sum   zeta q 1  sum  k q 0    zeta-1  kx i k tial i   k   in  If there is nothing to be confused  we denote by  We note that even if the operator is defined over and do not need to extend to define this operator  For the details  we refer to Gar3  By applying to  fourierlast   we get the homomorphism F     Poned p    l  Ddag Q Poned   1   arrow Poneoned   1    Z   otimes   DdagQ  Poneoned   1    Z    m sL    1     pi  mu  otimes    mc O    Poneoned   1    m bQ   Z   Ddag Q Poneoned   1     r  arrow F     Poned  n F DdagQ  Pone   1      where on denotes the base change of  From the next paragraph  we will calculate the Frobenius commutation homomorphism on the source of the homomorphism  For this  we always use the identification  identify

 In this paragraph  we calculate the canonical homomorphism of sheaves on  phi colo n	F     Poned p    l  Ddag Q Poned   1   arrow  Poneoned   1    Z  otimes   DdagQ  Poneoned   1    Z    m sL    1      pi  mu  otimes   mc O    Poneoned   1    m bQ   Z    Ddag Q Poneoned   1    Z   r 
 	 qquad arrow p    Ddag Q Poned arrow Poneoned  Z   otimes   DdagQ  Poneoned  Z   l  m sL    pi  mu  otimes    mc O    Poneoned  mb Q   Z   Ddag Q Poneoned arrow Pone  Z   otimes F     Pone  Ddag Q Pone   infty  r   In this paragraph  for simplicity  we denote   etc    by   etc    and we identify sheaves and its global sections  In the following  we will compute where is a global section of the source of  First  we get an isomorphism F     Poned  l  m sD    Poned   1   arrow Poneoned   1     otimes   ms D    Poneoned   1      m sL    1     pi  mu  otimes    mc O    Poneoned   1     m sD    Poneoned   1     r  xrightarro w sim   m sD    Poned arrow Poneoned  otimes    ms D    Poneoned  F     Poneoned  l  m sL    1     pi  mu  otimes    mc O    Poneoned   1     m sD    Poneoned   1    r   By the element is sent to  alpha 1   l  dx     vee  otimes1 otimes Hx   - q-1   otimes dx wedge dx   r  otimes x  q-1 x   q-1  e otimes1   Now  we get an isomorphism  m sD    Poned arrow Poneoned  otimes    ms D    Poneoned  F     Poneoned  l  m sL    1     pi  mu  otimes    mc O    Poneoned   1     m sD    Poneoned   1    r  xrightarro w sim   m sD    Poned arrow Poneoned  otimes    ms D    Poneoned   l  m sL    pi  mu  otimes    mc O    Poneoned  F     Poneoned  m sD    Poneoned   1    r  using the Frobenius structure of  This Frobenius structure sends to as written in  Note that in   loc   cit    our is equal to in their notation  and this is why we get instead of    Using this  is sent by this isomorphism to  alpha 2   l  underbrac e dx    bullet     vee  otimes1 otimes Hx   - q-1   otimes dx   bullet  wedge dx   bullet      A  r   otimes x  q-1 x   q-1  l  underbrac e exp  pi  xx  - xx   q   cdot e     E   otimes 1 otimes1  r   Then we get a homomorphism  m sD    Poned arrow Poneoned  otimes    ms D    Poneoned   l  m sL    pi  mu  otimes    mc O    Poneoned  F     Poneoned  m sD    Poneoned   1    r  arrow m sD    Poned arrow Poneoned  otimes    ms D    Poneoned   l  m sL    pi  mu  otimes    mc O    Poneoned  F     Poneoned  m sD    Poneoned   1   arrow  Pone   1    r   which sends to  Then we have an isomorphism  m sD    Poned arrow Poneoned  otimes    ms D    Poneoned   l  m sL    pi  mu  otimes    mc O    Poneoned  F     Poneoned  m sD    Poneoned   1   arrow  Pone   1    r   xrightarro w sim  m sD    Poned arrow Poneoned  otimes    ms D    Poneoned   l  m sL    pi  mu  otimes    mc O    Poneoned   m sD    Poneoned arrow Pone  otimes F     Pone  m sD    Poned  r   which sends to  Summing up  we have that the homomorphism sends 1 otimes l  dx    bullet     vee  otimes1 otimes1 otimes  dx   bullet  wedge dx   bullet  r  otimes e otimes1  mapsto A otimes x  q-1 x   q-1  E otimes 1 otimes1  otimes 1 otimes1   

 Let us finish the calculation of  Consider the following commutative diagram  xymatri x p    Ddag  Poned arrow Poneoned  otimes    Ddag  Poneoned   l  m sL    pi  mu  otimes    mc O    Poneoned   Dda g Poneoned arrow Pone  r   ar r  <>  5   beta  ar d    alpha  	 n F Ddag  Pone   infty   ar d    elta
 p    Dda g Poned arrow Poneoned   otimes   Ddag  Poneoned   l  m sL    pi  mu  otimes    mc O    Poneoned   Dda g Poneoned arrow Pone  otimes F     Pone  Dda g Pone   1     infty  r  ar r  <>  5   mma  	  n FF     Pone  Dda g Pone   1     infty      where we have omitted in subscripts and to save space  The homomorphisms and are the canonical homomorphisms induced by the homomorphism is nothing but  fourierlast   and is the homomorphism of Huyghe  compgeomnaive  By the computation of the last paragraph  we have  Phi 1 otimes wideha t1    mma  alpha 4   Since these sheaves are -modules  we identify the sheaves with their global sections  Since all we have to calculate is  Let  exp  pi t-t q    sum  n q 0  alpha nt n  Then we get 	 beta Bigl l  dx     vee  otimes1 otimes Hx   - q-1   otimes dx wedge dx   r  otimes x  q-1 x   q-1  l  exp  pi  xx  - xx   q   cdot e otimes  1 otimes1  r  Bigr 
 	 qquad  beta Bigl l  dx     vee  otimes1 otimes Hx   - q-1   otimes dx wedge dx   r  otimes l  sum  n q 0  alpha n xx   nx  q-1 x   q-1  r  l e otimes  1 otimes1  r  Bigr 
 	 qquad  beta Bigl  sum  n q 0  l  dx     vee   otimes1 otimes x   q-1 x  n alpha nHx   - q-1    otimes dx wedge dx   r  otimes l e otimes 1 otimes x nx  q-1   r  Bigr 
 	 qquad  Bigl l x   q-1 Hx   - q-1   r  t cdot sum  n q 0   alpha nx  n Bigr  cdot beta Bigl l  dx     vee   otimes1 otimes1 otimes dx wedge dx   r  otimes l e otimes 1 otimes x nx  q-1   r  Bigr 
 	 qquad  Bigl l x   q-1 Hx   - q-1   r  t cdot sum  n q 0   alpha nx  n Bigr  cdot x nx  q-1     wedge
 	 qquad  l x   q-1 Hx   - q-1   r  t cdot sum  n q 0   alpha nx  n Bigl  fra c- tial    pi  Bigr  n Bigl  fra c- tial     pi  Bigr   q-1  cdot wideha t1   Summing up  we get the following theorem  Let be a coherent -module  We write  exp  pi t-t q    sum  n q 0  alpha nt n with  The canonical isomorphism can be described as follows  for any we have  Phi 1 otimes wideha tm    l x   q-1  cdot H   Poned  cdot x   - q-1   r  t cdot sum  n q 0  alpha nx  n Bigl  fra c- tial    pi  Bigr  n Bigl  fra c- tial     pi  Bigr   q-1  cdot 1 otimes m   wedge 
A key exact sequence
 To show Laumon s formulas  one of the key point was to use the exact sequence appearing in the proof of  This exact sequence was deduced from an exact sequence connecting nearby cycles and vanishing cycles  Since our definition of local Fourier transforms does not use vanishing cycles  we need some arguments to acquire an analogous exact sequence  which is the main goal of this section 
Commutation of Frobenius
 In this subsection  we show a commutativity result of Frobenius pull-back and microlocalization  This result is used to define a Frobenius structure on microlocalizations defined in the next subsection 

 Let be an affine formal curve over  We consider the situation in paragraph setupFrob  We moreover suppose that and possess a global coordinate denoted by and respectively  and that the relative Frobenius homomorphism sends to  For any smooth formal scheme  we can choose such and locally  with the same property  We denote by and the differential operators corresponding to and respectively  We denote by and the reduction of and over as usual  Let and be non-negative integers  Let be the canonical homomorphism of Berthelot   normalfont    Then there exists a positive integer such that is in the center of and  for any positive integer To have lighter notation we will put  for every and  The case of the first statement is proven in  we have   and the general case goes similarly  is enough   see also  To finish the proof we proceed by induction on  Suppose that the statement is true for and let us prove it for  By induction hypothesis  there exists such that for every we may write in for some  By changing by a multiple  we can assume it divisible by so that is contained in the center of  For any integer we get 	 tial   angles m  fr  p  m  fr    lN i   cdot l 1 otimes tial    angles m  p m   lN ij   j varpi  i  sum rf r   l   otimes tial    angles m  r   tial    angles m  p m   lN i j-1    r 
  notag 	 qquad  l 1 otimes tial    angles m  p m   lN i    varpi  i  sum rf r   l   otimes tial    angles m  r   r  	 l 1 otimes tial    angles m  p m   lN ij   j varpi  i  sum rf r   l   otimes tial    angles m  r   tial    angles m  p m   lN i j-1    r 
  notag 	 	 qquad 1 otimes tial    angles m  p m   lN i j 1    	  j 1   varpi  i  sum rf r   l   otimes tial    angles m  r   tial    angles m  p m   lN ij    where in the first line stand for the left action of on and in the second equality we are using that is central  Thus  we get  Phi tial   angles m  fr  p  m  fr    plN i    	  tial   angles m  fr  p  m  fr     p-1 lN i    cdot 1 otimes tial    angles m  p m   lN i     varpi  i   sum rf r   l   otimes tial    angles m  r   
 	  l 1 otimes tial    angles m  p m   plN i    p varpi  i  sum rf r   l   otimes tial    angles m  r   tial    angles m  p m    p-1 lN i   r 
 	 1 otimes tial    angles m  p m   plN i    where for the second equality  we used  calberfrob  -times  By taking to be the equality  genber2 2 4  holds for and the lemma follows 

 We keep previous notation  Let and be non-negative integers  First  let us construct a canonical homomorphism compatible with where denotes  Let be the integer in Lemma frobcenter  Let be the multiplicative system of generated by and be that of generated by which is also contained in the center of  For a  non-commutative  ring we denote by the ring of polynomials in the variable such that is in the center  We know that  Define a -module structure on by putting  zeta f otimes tial    angles m  i     f otimes tial    angles m  i   tial    angles m  p m     -N   This structure defines a homomorphism of left -modules by sending to  Since the homomorphism factors through and defines a well-defined homomorphism  alpha colon S  -1   m  fr  Dmo dm  fr  X i  arrow F  S m  -1  Dmo dm  X  i  compatible with and sending to  For an integer we denote by  By the choice of local coordinates  cf   frobcenter    This implies that  for any integer we get  alpha l  S  -1   m  fr  Dmo dm  fr  X i    k  r  subset  F  S m  -1  Dmo dm  X  i     kp  - fr   Np  m  fr      Thus by taking the completion with respect to the filtration by order  induces  frobforE  Let be an integer  The homomorphism  frobforE  induces a canonical homomorphism  Emo dm   fr  X i  otimes   Dmod m  fr  X i   F   Dmo dm  X  i  arrow F   Emo dm   X  i   This is an isomorphism  Indeed  since is flat over cf   we get that the canonical homomorphism induced by the injective homomorphism  varpi Emo dm   fr  X i  otimes   Dmod m  fr  X i   F   Dmo dm  X  i  arrow Emo dm   fr  X i   otimes   Dmod m  fr  X i  F   Dmo dm  X  i  is injective  Since is an isomorphism  by a finite induction on it remains to prove the claim for  In this case the verification is straightforward  and left to the reader  Since is free of rank over commutes with taking inverse limit over  Thus by taking the inverse limit  we get a homomorphism  For an integer this induces a canonical homomorphism  beta  m   colon Ecom pm   fr   m sX   otimes   Dcomp m  fr    ms X   F   Dcom pm   m sX   arrow F   Ecom pm    m sX    This is an isomorphism since both sides are complete with respect to the -adic filtrations and its reduction over is an isomorphism for any

 We keep using notation of F cent and FrobE  Let be integers  We will first define a homomorphism compatible with and  Let be either or considered as a subgroup of  For non-negative integers we consider as a subring of or using the canonical inclusions  Then we claim that where is or and  For the claim is nothing but the compatibility of and  Let us see the claim for  By definition  we get for large enough integer and thus holds for any positive integer  By a standard continuity argument  we get the claim  Since is equal to in we get the desired homomorphism  Now we get the following  The canonical homomorphism is an isomorphism  Since is locally projective over the canonical homomorphism  Ecom pm   fr m    fr   m sX   otimes   Dcomp m  fr   m sX    F   Dcom pm   m sX    arrow Ecom pm   fr   m sX    otimes   Dcomp m  fr   m sX   F   Dcom pm   m sX     xrightarro w sim F   Ecomp Qm    m sX    is injective  Thus we get the injectivity of  intfrobisod  Let us see the surjectivity  Since it suffices to show that the image of  intfrobisod  contains  This follows from the fact that and the surjectivity of the homomorphism  Let be a coherent -module  Then there exists a canonical isomorphism  Edag Q ms X   otimes F   m sM  arrow F    Edag Q ms X     otimes m sM    Since tensor product is right exact and is exact  it suffices to prove the lemma for by the coherence of  Since inductive limit commutes with tensor product  it suffices to see that the homomorphism is an isomorphism  Since is locally projective over this claim follows from Lemma canhomm m  above by taking the inverse limit over and we conclude the proof  The construction does not depend on the choice of and and Lemma EcommFrob holds for any smooth formal curve  Since is determined uniquely when is determined  it suffices to see that the construction only depends on  This verification is left to the reader 
An exact sequence
 In this subsection  we construct a key exact sequence  We consider the situation in paragraph setupFour  First  we use a result of the previous subsection in the following definition  Let be a holonomic - -module  and consider  cf   Notation not3 in setup  This module is naturally a -module by Corollary ananddag  Now  we get the following isomorphism  Eda g0  mb Q   otimes m sM  xrightarrow 1 otimes Phi   sim   Eda g0  mb Q   otimes F   m sM  xrightarro w sim  F    Eda g0  mb Q   otimes m sM    where the first isomorphism is induced by the Frobenius structure and the second by Lemma EcommFrob  This defines a Frobenius structure on  We denote this - -module by   functors  mu 

 Let us recall that in setup we put   shape etc    We claim that the ring isomorphism of the naive Fourier transform  cf   NFT   extends to a ring homomorphism which fits into the following commutative diagram  xymatrix C 50p t  Gamma  Pone  DdagQ  Pone   infty   ar      ->  d  ar r   - iota   - sim  	  Gamma  Poned  Ddag Q Poned   infty    ar      ->  d 
  m sD    mr an     ms S   infty  m bQ   0  ar  -->  r    iota   	 E   ag    Aoned  mb Q     where the right vertical injection is  Gamma  Poned  Ddag Q Poned   infty    xrightarro w mathrm restriction    Gamma  Aoned  Ddag Q Aoned    xrightarro w sim  Gamma  mathrin gT    Aoned  pi  -1  Ddag Q Aoned    hookrightarrow  Gamma  mathrin gT    Aoned  m sE    ag     Aoned  mb Q     E   ag    Aoned  mb Q      and the left one is the natural injection  sending to and to with local parameter of  Such a morphism should send to and to  Let us construct  We recall that  for every the integers and are defined by  We begin by defining a homomorphism  for every  iota   m   colon R c cu  arrow  EcompQ bm m    Aoned  sending to  To see this is well defined  it is enough to note that the sequence goes to when goes to infinity  By construction  is independent of compatible with natural morphisms changing the level and continuous for the -adic topology of and -topology  cf   topologyonring  for on  Now we are going to extend this morphism to three different kind of rings  First  for any integer with the morphism extends by continuity to a morphism sending to  Second  for the morphism extends by continuity to a morphism sending to  Third  for and the morphism extends to a continuous morphisms sending to  To verify this  it is enough to prove that the sequence is sent to a sequence converging to zero  We have tial u   angles m    n      fra cq n   m       n   tial u n  longmapsto Q n   m       fra cq n   m       n    fra c   tial   2x   n   pi n   in Dcomp Qm   Aoned   subset  EcompQ bm m    Aoned   We consider the spectral norm of cf   we want to compute  Recall that where   and  For every integer is divisible by in more precisely we can prove by induction the relation where  Using  eqre feq claim   and denoting by the sum of -adic digits  we get and finally we have  | Q n   m      |    m     | fra cq n   m       n    fra c   tial   2 x   n   pi n   |    m   	 q 	 omega 0   q n   m    - sigma q n   m      - sigma n - fra c2n  p m     	 	 For and this is converging to zero when goes to  Now  since is complete  combining morphisms  eqre fmorph1    eqre fmorph2   and  eqre fmorph3   we get  for any  m cO   p  m  1   wideha t otimes   R cc u    m cB   p  m 1   wideha t otimes   R cc u    Dcom pm-2   m sS    infty   arrow  EcompQ bm m    Aoned   Taking the inverse limit on and tensoring with we have   Dcomp Qm-2   m sS    infty   0     mr an     Bigl  invlim  m   l  m cO   p  m  1   wideha t otimes   R cc u    m cB   p  m 1   wideha t otimes   R cc u    Dcom pm-2   m sS    infty   r  Bigr    mb Q   arrow  Emod bm  ag   Aoned  m bQ    and finally by a direct limit on we get the homomorphism we wanted  Let be a holonomic - -module  Then the - -module only depends on  First  we note here that as modules  we have  m sM |   eta  infty  cong m sD    mr an     ms S   infty  m bQ   0   otimes   DdagQ  Pone   infty   m sM   Since possesses a Frobenius structure  we know that is a coherent -module  Thus  we get  m sD    ms S   infty  m bQ     mr an   otimes   DdagQ  Pone    m sM  xrightarro w sim  m sD    ms S   infty  m bQ     mr an   0   otimes   DdagQ  Pone   infty   m sM  by  We denote still by the composition  m sD    mr an     ms S   infty  m bQ   0   xrightarro w iota   E   ag    Aone  mb Q    hookrightarrow m sE    mr an     ms S   0    m bQ    of the homomorphism constructed above and the natural injection  We have 	 mu  n F ms M    cong m sE    mr an     ms S   0    m bQ    otimes   DdagQ  Poned   infty   n F ms M   cong  m sE    ms S   0    m bQ     mr an   otimes   DdagQ  Poned   infty     Ddag Q Poned   infty  otimes   iota  DdagQ  Pone   infty   m sM  
 	 qquad cong m sE    mr an     ms S   0    m bQ   otimes   iota    ms D    ms S   infty  m bQ     mr an   0   m sM |    eta   infty    To see that it is compatible with Frobenius isomorphisms  it suffices to apply Proposition frobstruccalcabsw

 We use the notation of paragraph setupFour  Let be a holonomic - -module  Let us define an LF-topology on  Let be the canonical extension of at  By Corollary ananddag we know that  m sE    mr an   otimes  M  cong E  ag   Aone  mb Q    otimes m sM  Let be a stable coherent -module such that  For since is a Fréchet-Stein algebra  any finitely presented module becomes a Fréchet space  By taking to be sufficiently large  we may suppose that is finite free over by Corollary coinccrew  There exist two topologies on   the Fréchet topology induced from -module structure denoted by and topology induced from the finite free -module structure denoted by  Since becomes a topological -module as well  we get that and are equivalent by the open mapping theorem  Now  we put on the inductive limit topology  By the observation above  the inductive limit topology coincides with the -module topology  cf   Lemma fieldconstmicdif  Since is an LF-space and the module is finite free over we get that the inductive limit-topology is separated and becomes an LF-space  Thus this defines an LF-space structure on  By using Remark anyelem  ii   we note here that this is also a topological -module  Thus  if is finite over this LF-space topology coincides with the -module topology by the open mapping theorem  Recall the notation of   normalfontdefvanishcycle    Assume that is a   holonomic  - -module  Then there exists a canonical isomorphism  Phi  m sM |  S 0   xrightarro w sim  Phi  mu  m sM     Let be a holonomic - -module such that is also a holonomic - -module  First  we will show that  Let  alpha colon  M  arrow m sE    mr an   otimes    ms D    mr an     M   qquad  beta colon m sE    mr an   otimes   ms D    mr an     M  arrow  M   be the homomorphisms mapping and respectively  Obviously  we get  It suffices to show that is surjective  Let and be the canonical extensions of and respectively  By Corollary ananddag we get  M  con gE   ag   Aone  mb Q   otimes m sN  0  qquad  m sE    mr an   otimes  M  con gE   ag   Aone  mb Q    otimes m sM  0  Using paragraph LFspacetoppartcase we endow these with the LF-space topologies  or equivalently the -module topologies   Since these are equipped with -module topologies and is -linear  is continuous with these topologies  cf    To see the surjectivity of it suffices to show that it is a homomorphism of -modules  Since is invertible in we get that  This shows that is linear with respect to the subring generated by and  Note that is dense in  Since the target of is an LF-space  it is separated  and we get the claim  Now  since the category - is abelian by we define the - -modules by the following exact sequence of - -modules  0 arrow m cK  arrow m sM |  S 0  arrow mu  m sM   arrow m cC  arrow 0  Here the middle homomorphism is induced by the scalar extension of the identity map on  By the definition of Frobenius structures  cf   dfnfrobmu   this homomorphism is a homomorphism of modules with Frobenius structures  Take and we get an exact sequence by Remark locFordfnrem and the claim above  0 arrow m sE    mr an   otimes m cK  arrow mu  m sM   arrow mu  m sM   arrow m sE    mr an   otimes m cC  arrow 0  This shows that  Let be a holonomic - -module such that  Let be the canonical extension of we have  Edag Q0  otimes  N    mr can   cong m sE    mr an    otimes  N  0  This shows that there are no singularities for at so that is a convergent isocrystal around  In particular  we get an isomorphism of differential modules for some integer  note that in the isomorphism  we are forgetting the Frobenius structures   Applying this observation to and we get that these are direct sums of trivial modules  Since and the functor is exact  we finish the proof 

 Let be a holonomic  -  -module  We define  When possesses a Frobenius structure  this is a -vector space with Frobenius structure  There exists a canonical homomorphism This homomorphism is injective  and compatible with Frobenius structures if they exist  When this injection is an isomorphism  is said to be   unramified at infinity   This is equivalent to saying that is a trivial differential module  Let be a holonomic - -module unramified at infinity  Then the linebreak - -module is holonomic  Since depends only on and the claim does not depend on the Frobenius structure by Lemma characterisation of Dan hol mod we may suppose that is isomorphic to where  In this case  we know that is equal to by Proposition calcfouriereasy  Now  and we may check directly that is generated over by  Thus the claim follows using Lemma characterisation of Dan hol mod once again  Let be a holonomic - -module which is unramified at infinity  Then we have  Phi  n F ms M  |  S  0      K   mr ur   otimes K  m sM |  s  infty   1   By Lemma conccalclocfouunr we get that is finite over  Thus by Lemma reductiontomu it suffices to calculate  Since depends only on we may assume that  Indeed  its -module around is isomorphic to as differential -modules with Frobenius structures using the isomorphism  solisom  In this case  we may use Proposition calcfouriereasy to get that  n F ms M   cong i  0     m sM |  s  infty   1   Now  using Proposition reductiontomu again  it suffices to calculate which is nothing but what we stated  and concludes the proof  We believe that is a holonomic - -module even when is not unramified at infinity  and is closely related to the local Fourier transform of Laumon  However  we do not need this generality in this paper  and we do not go into this problem further  Let be a holonomic - -module which is an overconvergent isocrystal on a dense open subscheme of and assume that it is unramified at infinity  We denote by the canonical morphism of couples  Then there exists the following exact sequence of Deligne modules  Here  by abuse of language  we denoted by and using the cohomological functors of   normalfontdefpullbackpush    By  vanishexact   there is the following exact sequence  0 	 arrow m rHom    ms D   ag   m bD  nFn p ms M   |  S  0      m cO   K  mr ur     mr an    arrow m bV   m bD   nFn p ms M   |  S  0     arrow m bW   m bD  nFn p ms M   |  S  0     arrow
 	 arrow m rExt  1   ms D   ag   m bD   nFn p ms M   |  S  0     m cO   K  mr ur     mr an    arrow 0  Consider the following cartesian diagram   xymatri x  Pone   infty    ar d   q 0  ar r  <>  5   iota 0   ar    rd  | square  	  Poneoned Z  ar d   p 
  0   ar r  <>  5  i  0    	  Poned   infty     By we get  m rExt  i   ms D   ag   m bD  nFn p ms M   |  S  0      m cO   K  mr ur     mr an    cong  m sH   i-1  i  0       m bD  m bD  nFn p ms M      otimes K  m rur  cong  m sH   i-1  i  0      nFn p ms M      otimes K   mr ur   for any  We get the following calculation  	 m sH  i i  0      nFn p ms M      xrightarrow  sim   ccirc 1    m sH  i i  0     p     mu   m sL    pi  otimes p   m sM      1  -3   xrightarrow  sim   ccirc 2    m sH  i q  0    iota 0    mu   m sL    pi   otimes p   m sM     -2 
 	 qquad xrightarrow  sim   ccirc 3    m sH  i q  0   iota 0    mu   m sL    pi  widetild e otimes  p   m sM     -2  -2  xrightarrow  sim   ccirc 4    m sH  i q  0   iota 0    mu   m sL    pi  widetild e otimes p   m sM     2 
 	 qquad xrightarrow  sim   ccirc 5    m sH  i q  0    iota   0 mu   m sL    pi  widetild e otimes   iota 0  p   m sM     -1  2  xrightarrow  sim   ccirc 6    m sH  i q  0    m cO    Pone  mb Q    infty  widetild e otimes   m sM     1 
 	 qquad xrightarrow  sim   ccirc 7   m sH  i q  0    m sM     1  1   xrightarrow  sim   ccirc 8   H  i 2    mr rig  c  U  m sM   2   Here follows from Huyghe s theorems  KatzLaumonisom  and  compgeomnaive   from the proper base change theorem properbasech from prop6func twisttensor from prop6func smoothpoin and Lemma Tsuzukicalc from prop6func raisondetretwist from and  by construction of   from prop6func twisttensor again  and from  rigDmodcompact  For the calculation of it suffices to apply Lemma kernelofexact and the fact that
The -adic epsilon factors and product formula
 In this section  we prove the product formula for -adic epsilon factors and the determinant formula relating the local epsilon factor to the local Fourier transform  We start in  Ssb Loc con by defining the epsilon factors for holonomic modules over a formal disk  then we state the main theorem  the product formula  in  Ssb main  Its proof takes the rest of this paper  We begin in  Sproof geo mod by proving it for -isocrystals with geometrically  globally  finite mo -no -dromy  this proof is slightly more technical than the -adic one and we need some generalities on scalars extension in Tannakian categories  which we collect in  Ssb scal ext  We finish the proof of the main theorem in  Ssb proof gen case where we give also the determinant formula 
Local constants for holonomic -modules
 Let us fix some assumptions for this section  Let    miscellaneous F  |   be a finite subfield of    miscellaneous hq  |   be the number of elements of so that is the subfield of fixed by the -th absolute Frobenius automorphism  Let    miscellaneous Lambda    be a finite extension of with residue field and absolute ramification index     miscellaneous efa  |   We put     miscellaneous K    It is a complete discrete valuation field with residue field and ramification index  We denote by its ring of integers  We endow with the endomorphism     miscellaneous sigma    The subfield of fixed by is  We say that is a Frobenius of of   order   Let denote the valuation of normalized by  We assume  except for  Ssb scal ext  that is finite with elements     miscellaneous hq  |   and that the order of the Frobenius divides so that    miscellaneous efa  |   for an integer  We will see later  cf   Remark remark semplification  that  in the proofs  it is not restrictive to assume and so and  We choose an algebraic closure of and we denote by its residue field     miscellaneous F  |   We choose also a root of the polynomial and we assume  We recall  cf   setupFour  that the choice of determines a non-trivial additive character  By composing with the trace map we get a non-trivial additive character that we denote also by     miscellaneous psi 

 To fix notation  we review some results collected in Marmora Facteurs epsilon  See   loc   cit    for more details  We follow the notation and the assumptions of existconcdesc and susubsection k finite  In particular denotes a formal disk  its geometric point     miscellaneous S    its special fiber  the closed point  and the generic point of  We recall  cf  Lemma existconcdesc  that for any in lifting an uniformizer of  We put and we choose a geometric algebraic generic point     miscellaneous eta    We identify with by sending any to where is the geometric Frobenius in  Let us denote by the specialization homomorphism and by  resp    the    miscellaneous W    Weil  resp   inertia  subgroup  Let  categories Rep    denote the category of Weil-Deligne representations    shape i e    the category of finite dimensional -vector spaces endowed with an action and a nilpotent endomorphism satisfying for any  On the other hand  -adic mo -no -dromy theorem gives an equivalence of Tannakian categories  nearby cycles   In    loc   cit     3 2 18   the functor was denoted by the field of constants by the category of free differential modules over by or and the field by    Psi -1  colon F -  m rHol   eta   ms S    arrow  De l Ct nr   pi 1  eta  overlin e eta     For the twist see defvanishcycle  Let be a Deligne module  We can endow with a linear action by putting for all and  In this way we obtain a Weil-Deligne representation and we denote by this functor of   Frobenius linearization    Since Weil-Deligne representations are linear  we will often implicitly extend the scalars from to  Composing the functors and and extending the scalars to we obtain a faithful exact -functor  cf     functors  WD 

 Now  let us introduce local epsilon factors  Langlands La defined local epsilon factors extending Tate s definition for rank one case  and in Del const loc Deligne simplified the construction of the epsilon factors for Weil-Deligne representations  Deligne s definition translates well to free differential -modules with Frobenius structure via the functor recalled above  Here  we extend it from to by   shape d  evissage   skip We follow the notation and the assumptions of existconcdesc defsFhol defvanishcycle susubsection k finite and WD  Let be a holonomic - -module  a non-zero meromorphic -form  and a Haar measure on the additive group of with values in  We denote by the additive character given by  cf    The next proposition allows us to define the  local  epsilon factor of the triple  There exists a unique map  varepsilon   pi   colon  M   omega  mu  mapsto varepsilon  pi   M   omega  mu  in bCt     epsilon factors local  |   satisfying the following properties  em For every exact sequence in 	 - we have 	 	  varepsilon  pi  M   omega  mu   	  varepsilon  pi  M    omega  mu  cdot 	  varepsilon  pi  M     omega  mu   	 em If is punctual    shape i e   	  for some - -module 	then 	 	  varepsilon  pi  M   omega  mu   et   Ct  -F V   -1   	 	where is the smallest linear power of the Frobenius 	 of  cf   see   normalfontsusubsection k finite   	for the definition of the integer  em If the canonical homomorphism 	is an isomorphism  then 	 	  varepsilon  pi  M   omega  mu   varepsilon 0 	  j   M  1   psi  pi  omega   mu   -1   	 	where is the local epsilon factor defined 	in   normalfont    Immediate by applying the distinguished triangle  anotherloctriag  and  In the following  we will always assume   to lighten the notation  we put   epsilon factors local  |   Moreover  for a free differential -module with Frobenius structure  we define and using the notation of   epsilon factors local    For a complex of - -modules with bounded holonomic cohomology  we put  varepsilon  m cC   omega    prod  i in ZZ  varepsilon   m sH  i m cC   omega    -1  i   Let be an object of -  We define   functors six operations j    Then we have ars  M   omega   varepsilon  pi  j       M  1    omega   -1   This follows from Lemma calcofdiff and  For intermediate extensions in a wider context see
Statement of the main result
 Let us begin by fixing notation and definitions of global objects  We follow the notation and assumptions of  Ssusubsection k finite  Let be a  smooth  curve over  We denote by the number of connected components of and by the genus of any of them  Let be the generic point of and we choose a geometric point over     miscellaneous eta    We denote by the set of closed points of  For any let    miscellaneous Ox3    be the maximal ideal of its residue field  the canonical morphism and  Let be the completion of for the -adic topology  the field of fractions of the generic point of  resp    a geometric point over  resp       miscellaneous S    Let us denote by the field of functions of and by the module of meromorphic differential -forms on  For every non-zero and we denote by the germ of at the order of at

 Let be the smooth compactification of over and  There exists a smooth formal scheme over such that by  SGA I  Exp   III  7 4   The category -  cf   setupFrob  does not depend on the choice of up to canonical equivalence of categories using  We denote this category by -  categories FhDbh  -   and call it the category of   bounded holonomic - -complexes   Now let and be the structural morphisms  The functors and  cf   defpullbackpush  do not depend on the choice of up to equivalences  By abuse of language  these are denoted by and  functors six operations D     functors six operations f    respectively  We note that can also be used  and in the same way  we can consider the functor for an open immersion   functors six operations j    Let be a discrete valuation ring finite étale over and let be an object of -  The associated -semi-linear automorphism  cf  frobstrcor  is denoted by  From now on we denote the   -linear  automorphism by  cf   susubsection k finite for the definition of     miscellaneous F 

 In Caro courbes Caro defines the -function of a complex in -  Let us recall the definition  We set L X  m sC  t 	     prod  x in |X|  et   Ct x  1-t   eg x   F   eg x    i x   m sC    -1
 	     prod  x in |X|  prod  r in ZZ  et   Ct x  1-t   eg x  F   eg x     m sH  r i x   m sC      -1   r 1          L  -function   Recall that is the smallest linear power of the Frobenius  Using a result of Etesse-LeStum  Caro gave the following cohomological interpretation of his -function  cf     L X  m sC  t     prod  r in ZZ  et   Ct  1-tF  m sH  r f   m sC       -1   r 1    For careful readers  we remind that in   loc   cit    the definition of Frobenius structure of push-forward is re-defined so that it is compatible with adjoints  cf      loc   cit    1 2 11    However  this coincides with the usual definition  see  Now  assume that is proper  Then can be replaced by  By Poincaré duality  poincaredual   we get the following functional equation  L X  m sC  t   varepsilon  m sC   cdot t  - chi f   ms C     cdot L X  mathb bD  X  m sC   t  -1    where  varepsilon  m sC     et -F f   m sC    -1    prod  r in mb Z   et -F  m sH   r  f   m sC      -1   r 1    epsilon factors global    and is the smallest linear power of the Frobenius  This invariant is called the    global  epsilon factor of    Finally  for in - we put using the notation of geomnotlau  We call it the   generic rank of     local constants    Let be a non-empty open subscheme of a proper curve and be an overconvergent -isocrystal on over  Etesse-LeStum LE defined the -function for by L   mr EL   U M t    prod  x in |U|  et   Ct x  1-t   eg x  F   eg x   i x  M   -1   We are able to interpret this global invariant in terms of the global invariant we have just defined in the following way  Let be the open immersion and be the structural morphism  Put  Then the -function coincides with that given by Etesse-LeStum  namely  we get  The easiest way to see this might be to use the cohomological interpretation of the two -functions  and the fact that  m sH  i f   m sC   cong  m sH  i f  U    m rsp   M -1  -1    cong H i   mr rig  c  U M   where the second isomorphism holds by  rigDmodcompact  See also for some account   Product formula  Let be a proper  smooth  curve over a complex in - and a non-zero meromorphic form on  We have the following relation between the global and local factors  where denotes the number of elements of is the generic rank of denotes the number of geometrically connected components of and is the genus of any of them  We recall that denotes the complex of modules defined by restriction  cf     normalfontpreisouadsf    from to its complete   trait  at  The proof of the product formula will be given in  Ssb proof gen case        Let be an non-empty open subscheme of a proper curve an overconvergent -isocrystal on over and a non-zero meromorphic form on  For any let us denote by the free differential -module associated to at  We have where and denotes the order of at  Let us prove that  PF  implies  PF-iso   we need only to specialize all the factors  Let be the open immersion  We replace in  PF  Then for we get  varepsilon  m sC |  S x   omega x   ar  M|    eta x   omega x  cdot et   Ct x  - Fro   a eg x   i   xM   -1  	   ars  M|    eta x   omega x 
 	   q  x   val x   omega  mathrm rk  M     et  M   x     val x   omega    where the first equality follows from the localization triangle  anotherloctriag  and prop6func smoothpoin and the second  resp   third  from  resp    Finally  for every by definition  we have  Considering Remark ocisoccaseinv we get the corollary   i  Note that in   loc   cit    the curve was assumed to be geometrically connected for simplicity  so that  Since the product formula  PF  is immediate for punctual arithmetic -modules  the two statements  PF-iso  and  PF  are equivalent by   shape d  evissage    ii  By definition  the global factor appearing in  PF  and  PF-iso  does not change if we replace the Frobenius of by its smallest linear power  The same is true for the Weil-Deligne representation and   a fortiori  for the local factors  Replacing by is equivalent to assuming thus and in susubsection k finite
Interlude on scalar extensions
 In this subsection  we recall a formal way to extend scalars  cf    in a general Tannakian category  with the intention of use in  Sproof geo mod  Most of the proofs are formal and they are only sketched  To shorten the exposition  we may implicitly assume that the objects of our categories have elements  so that they are -vector spaces endowed with some extra structures  For a general treatment  confer to   loc   cit   In this subsection the field is only assumed to be perfect  whereas in the rest of  Ssection7 it is finite  Let be a Tannakian category over  Assume that the objects of have finite length  Let be a field extension of and an object of  A -structure on is a homomorphism  Lambda  -structure  of -algebras  Let  resp    be a -structure on  resp    A morphism in is said to be compatible with the -structures if for every in we have  The couples where is a -structure on an object in form a category  whose morphisms are the morphisms in compatible with the -structures  We denote this category by  Sometimes  we denote simply by an object in

 We define an internal tensor product in as follows  Let and be two objects in  Since has finite length  there exists a smallest sub-object such that  for all in the image of factors through  We put  There are two natural -structures on given respectively by the endomorphisms and  By construction they induce the same -structure on  The couple defines an object of denoted by  It satisfies the usual universal property of the tensor product in the category which makes a Tannakian category  Let be a non-empty open subscheme of a proper curve a geometric point of  The category of representations with local finite geometric mo -no -dromy is equivalent  and even isomorphic  to as Tannakian category  Let be a field as in susubsection k finite and be a finite Galois extension  By construction  the category of overconvergent isocrystals with -structure is equivalent  as Tannakian category  to  Now assume to be a finite field with elements and that the order of the Frobenius is so that  If is totally ramified  then is equivalent to as Tannakian category  where  If is not totally ramified  an overconvergent -isocrystal with -structure on over can be identified with an overconvergent isocrystal on endowed with a   Frobenius   which is -linear although only of order

 Let be a finite dimensional -vector space and an object of  The tensor product is defined canonically in as an essentially constant ind-object  In particular  if is a finite field extension  the product can be endowed with the -structure induced by the multiplication of so it belongs to   we have a functor of   extension of scalars   If is a base of over then is non-canonically isomorphic to with an obvious meaning of the latter 

 Let be an additive functor between two categories and as in  Ssb scal ext  It extends to a functor defined by functoriality as S   Ctf   M  mbda      S M   S mbda  colon a mapsto S mbda a    By the additivity of it is clear that commutes with the extensions of scalars  Moreover  if is compatible with and right exact  then is compatible with the inner product defined in sub tens prod   this is a consequence of the construction of considered that is a finite extension and commutes with finite direct limits and  Finally  if is an equivalence of Tannakian categories so is
Proof for finite geometric monodromy
 The goal of this subsection is to prove the product formula in the case of overconvergent -isocrystals with geometrically finite mo -no -dromy  in particular for -isocrystals which are canonical extensions  see Proposition PF fgm and Corollary cor cong Fiso spec  Although the proof for overconvergent -isocrystals with finite mo -no -dromy is analogous to that of and it is given in there are some technical difficulties to show that for   geometrically  finite case  and we treat this case by using the formal scalar extension reviewed in the previous subsection 
 In subsubsec loc const Ctf  and ss glob const Ctf  we define local and global   constants   for generalized isocrystals in  They will be seen as elements of the -algebra of functions  To avoid any confusion with constant functions  we employ the term factors instead of   constants    For simplicity  we will often assume that the order of Frobenius is so that and cf   susubsection k finite   we might state the definitions and prove the lemmas in the general case  but this is not needed for proving Proposition PF fgm

 Assume and so  cf   susubsection k finite  Let be a finite Galois extension  be a non-empty open subscheme of a proper curve and  The Weil-Deligne representation is a -module with a linear action of and  For any we denote by the localization of at   it is stable under and  Let us define the local factors as functions  For any we set  em which does not depend on  em
  cf   for the equality   em Let be in and be the Haar measure on with values in normalized by as usual  and is also the additive character associated to  cf   defepsfac  As already appeared in the epsilon factors are defined by  mathfra kp  mapsto ar 	    WD M|   eta x     Ctf       mathfrak p    psi  omega x   mu x   Let us write simply instead of

 As in subsubsec loc const Ctf  assume and so  Let be in  The rigid cohomology groups  with and without supports  of inherit a -structure  so that they are -isocrystals with -structure on over   we denote them respectively by and  cf   ss Ctf  ext   functors  Hrig    They are -vector spaces endowed with linear Frobenius isomorphisms  To shorten the notation  let denote or  We define as the constant function  We denote by the product  From the long exact sequence of rigid cohomology  it follows that is multiplicative for short exact sequences and so it is defined on the Grothendieck group of  In the general case  where the group is a module over the semi-local ring and we endow it with the -linear endomorphism where  The module decompose as  For every the localization is a vector space over the field  where is a finite unramified extension of   and induces a -linear endomorphism of  We define as the composition of the canonical map induced by the inclusion and the function sending to  We are not using this remark in the following 

 Let us follow the notation of subsubsec loc const Ctf  and ss glob const Ctf   Let us state a variant of the product formula  PF-iso  for overconvergent -isocrystals in  Let be a non-empty open subscheme of be in and a non-zero element of  The product formula for is the following relation between global and local factors associated to

 Assume and so  Let be a non-empty open subscheme of and an overconvergent -isocrystal on over  For any finite Galois extension we can define an overconvergent -isocrystal with -structure  cf   scalar ext  The -isocrystal satisfies the product formula   normalfont  PF-iso   if and only if satisfies the product formula with -structure   normalfont  eq gen PF scalar ext    For an abelian category we denote by its Grothendieck group  In this proof we put  The formula  PF-iso   resp    eq gen PF scalar ext   is a relation on the Grothendieck group of  resp    with values in  resp   in the group of units of the -algebra  Each factors appearing in the equality  PF-iso   resp    eq gen PF scalar ext   are homomorphisms  resp    By the definitions of these factors  cf    subsubsec loc const Ctf  --ss glob const Ctf    it follows the commutativity of the diagram  xymatri x  Gr  mc A   ar r   - nu  ar d   - Ctf  otimes   Ct  -  	  bCt   ar d 
  G r mc A    Ctf    ar r   - nu   Ctf    	 l   bCt      Spec  Ctf  otimes   Ct   bCt   r      where the right vertical homomorphism maps each element of to the constant function of value  Since this homomorphism is injective we conclude 

 We recall that the theorem of Tsuzuki gives an equivalence  functors  G     categories Rep    between the categories of unit-root overconvergent -isocrystals on over and continuous -representations of with local geometrically finite mo -no -dromy  We say that a unit-root overconvergent -isocrystal has global finite mo -no -dromy if the associated representation factors through a finite quotient of   we say that has global geometrically finite mo -no -dromy if the restriction of to factors through a finite quotient   global  geometrically  finite monodromy  The following lemma extends to isocrystals with -structure  Assume so that and  Let be a finite Galois extension and be a non-empty open subscheme of  Let be an overconvergent -isocrystal with -structure on over  Assume is unit-root with global finite mo -no -dromy  then the formula   normalfont eq gen PF scalar ext   is satisfied  By a base change to the algebraic closure of in we may assume that is geometrically connected    shape i e      If is totally ramified  we may put   then the category identifies to cf   Example example rep  and so we finish by  Let us treat the general case  For any representation and any closed point we denote by the representation  We put and  cf   scalar ext  which will be treated as a -vector space with a linear action of  Let us start by proving the following statement  The -module is free and for any we have   renewcomman d symbol      Proof of the claim  Let us compute and  Their mo -no -dromy operators are zero  because is unit-root  Let us denote by the sub- -vector space of spanned by the finite orbits under the action of  By we have  Since has finite mo -no -dromy  we get endowed with the diagonal action of  it acts on via the residual action   Hence where the action of is nothing else than the extension by linearity of the action of  We finish by the equality  renewcomman d symbol     To establish the product formula for it remains to prove the following relation  et   Ctf   l -F   H     g c  U M     Ctf   r   -1   
   q   frac  1-g  mathrm rk  M   | Ctf   Ct|   prod limits  x in |U|   q  x   frac  val x   omega  mathrm rk  M   | Ctf   Ct|      et   Ctf     rho   eta x   F x     V   eta x      I   eta x       val x   omega   prod limits  x in X backslash U  ar V    eta x   omega x   The proof of this equation works in the same way as the proofs of by replacing  resp    with  resp    Let be a proper curve over be a non-empty open subscheme of and be an overconvergent -isocrystal on over  Assume that is unit-root with global geometrically finite mo -no -dromy  Then satisfies the product formula   normalfont PF-iso    In this proof we put for brevity  Let be the representation associated to by cf   Tsuzuki-Katz  By assumptions  has global geometrically finite mo -no -dromy    i e    the restriction of to factors through a finite quotient  In particular  the representation factors through a quotient of which is an extension of by the finite group  By Remark remark semplification we may assume that the order of the Frobenius of is so that and  Let us show how we can reduce to the case of global finite mo -no -dromy which is treated in Lemma lemma extention to lambda str  The equation  PF-iso  that we have to prove is a relation in the Grothendieck group of  By Lemma lemma PF scalar invariance we can extend scalars to any finite Galois extension  The equivalence above extends to an equivalence of Tannakian categories  cf   ss Ctf  ext  We identify with  cf   example rep   The product formula is a relation in the Grothendieck group of   we may assume that the representation is absolutely irreducible  By a classical argument using Schur s lemma  cf   for example or   the representation is isomorphic to where factors through a finite quotient and is an unramified character  Let be a quasi-inverse of  Let us put and  We have in  cf   sub tens prod  By construction  has global finite mo -no -dromy and is constant as isocrystal    i e     for and  Since is a constant isocrystal  we have  By a direct calculation analogous to that of the proof of we reduce to the case of global finite mo -no -dromy  which is proven in lemma extention to lambda str  Let be in -  Then the canonical extension satisfies the product formula   normalfont PF-iso    By Kedlaya s filtration theorem there exists a filtration  M   M  0 supset  M  1 supset  supset  M  s 0 such that the quotient is isoclinic for every  By applying the canonical extension functor intcanext we get an analogous filtration on  Considering that the equation  PF-iso  we have to prove is a relation in the Grothendieck group of we may assume to be isoclinic of Dieudonné-Manin slope  By the definition of Dieudonné-Manin slopes  belongs to the discrete subgroup  Taking a finite   totally ramified  extension of does not affect the local factors  therefore  by extending to such an extension of degree we may assume that belongs to  So the isocrystal is of rank by construction  We put  We have with unit-root  By applying to we may assume  Since is unit-root  has global geometrically finite mo -no -dromy by the very construction of the canonical extension  cf     and we finish by Proposition PF fgm
Proof of the main result
 We use the notation of setupFour  Let be an overconvergent -isocrystal on  Suppose that it is regular at infinity  Then is a constant overconvergent -isocrystal  Let denote the structural morphism of  By construction of the rigid cohomology we have and  by the GOS formula for rigid cohomology  we get  In particular  By there is an injection of -isocrystals so that and is isomorphic to the constant isocrystal

 Let  We put     miscellaneous S       miscellaneous S       miscellaneous K    Let sending to  For a free differential module with Frobenius structure on using the canonical extension  there exists a canonical overconvergent -isocrystal on denoted by such that it is tamely ramified at and  We denote by   functors  Psi1    On the other hand  suppose moreover that is of rank  Using the linearization functor  linearizationfunc   we get a character  chi   L k circ Psi   M   colon G   mc K    arrow K   mr ur     For we put  M  f      chi circ m rrec   f    in K   mr ur     where    miscellaneous rec    is the reciprocity map normalized   à la  Deligne    i e    it sends uniformizers of to elements of whose image in is the geometric Frobenius  When is regular of rank we get This can be seen in exactly the same way as and we leave the details to the reader  We need to be careful for the multiplicativity  Namely  given rank free differential modules such that we have  M  -1  f    M   -1  f   cdo tM    -1  f    See WD for an explanation        Let be an open subscheme  and we put  Let be an overconvergent -isocrystal of rank on which is unramified at infinity  Then we get et R Gamma c U  K   mr ur     m sM   1   otimes et K   mr ur    otimes K m sM |  s  infty   -r  cong otimes  s in S  Psi 1 l et l  Phi   0  infty    j   au  s   m sM |   eta s   r  - mma s-1  r  as Deligne modules  where and we used the notation of   normalfontdefvanishcycle    Using the notation of Proposition exactseq we get et  Psi  nFn p ms M   |  S 0   -2   cong et R Gamma c U  K   mr ur     m sM   1   otimes et K   mr ur   otimes K m sM |  s  infty  -1   as Deligne modules by the same proposition  Since the -action on the right hand side is unramified    i e   the action of the inertia subgroup is trivial   the left hand side is also unramified  Since is an exact functor and commutes with tensor product  we get an equivalence of functors  On the other hand  for a free differential module we get  Thus  we get We note that the singularity of in is only at by Corollary calcofirr and we showed that is unramified at  Thus there exists an overconvergent -isocrystal on such that  Now  we get  m sN |   eta  infty   et l  nFn p ms M   |   eta  infty   -1  r 	 cong otimes  s in S  au    et l   m sF    s  infty     m sM    -1  r 
	  cong otimes  s in S  et l  Phi   0  infty     j   au  s   m sM |   eta s   r  - mma s   otimes DwL elta   where by the stationary phase formula stationaryfrobcom Lemma locFourrel and Corollary locfourstricless  We note that the differential slope of is strictly less than by Corollary locfourstricless for any  Thus  the differential slope of is also strictly less than  Since the rank is the differential slope of is for any by the Hasse-Arf theorem  Thus  m sN      m sN  otimes m sL  - elta cdot x   is a convergent -isocrystal on and regular at infinity  By Lemma Hurwitz is in fact a constant overconvergent -isocrystal  By  detpsicom  and the fact that commutes with the proposition follows    -adic determinant formula  For any free differential -module with Frobenius structure we get ar  M  du   -1    mma  et  Phi   0  infty     j   M    - mma-1  u    where   i  Before proving the theorem  we remark that the right hand side of the equality is multiplicative with respect to short exact sequences by Remark intnotrecipmap   ii  Although the idea of the proof is exactly the same as   loc   cit    we include the complete proof of the proposition since there are a lot of minor differences in the quantities appearing  especially the Tate twist in the statement of the theorem   and we think that it might help the reader to understand the differences with the -adic case  Let be a - -vector space of dimension  Then the theorem holds for a free differential -module if and only if it holds for  Indeed  by we have ar  M  otimes KV du   ar  M  du  cdot et F V   mma  On the other hand  we see that  Phi   0  infty    j   M  otimes KV  cong  Phi   0  infty    j   M   otimes KV by using Proposition frobstruccalcabsw  Thus  the claim follows  First we will treat the case where is regular  Since both sides are multiplicative  we may assume that is irreducible  By Kedlaya s slope filtration theorem  we get that is isoclinic  for Dieudonné-Manin slopes   Since both sides of the equality are stable under base change by a totally ramified extension of we may assume that the Dieudonné-Manin slope of is in  Since the equality is stable under twisting and it suffices to show the proposition for and we may suppose that is unit-root  Thus  it corresponds to a geometrically finite representation of denoted by  We know that there exists a finite extension such that is the induced representation of of rank where  This shows that there exists a finite unramified extension of and a free differential -module with Frobenius structure such that where is the canonical finite étale homomorphism  By baseextcom we get  Phi   0  infty    j   M   cong f       Phi   0  infty    j   M  L    For the calculation of use  It remains to show the theorem for and thus  we may assume that is of rank  In this case we can write such that is a trivial differential module if we forget the Frobenius structure  and is the Kummer isocrystal  cf   calcKummergeom  Then we may suppose that is trivial by the observation at the beginning of this proof  It remains to show the theorem in the case  Now  first  assume that  Then by Proposition calcKummergeom  By the stationary phase formula and the same proposition  we get  Phi   0  infty     k u alpha   cong au    l  m sK   1- alpha   otimes G  alpha  pi  1  r |   eta  infty   cong k u alpha   otimes G  alpha  pi  1   Furthermore  we have  Psi  k u alpha   cong m bV    k u alpha    vee -1   cong   m cB  otimes k u alpha     tial 0  1  by definition  cf   defvanishcycle  Combining these  we get  The space is the sub- -vector space spanned by where is the canonical base of  Let and be the -th power of Teichm   u ller character  Then we get  m rtr  F   G  alpha  pi   - sum  x in k    chi  alpha x  cdot  psi k x  by using the fact that for  which can be proved by GOS-formula for example   Now  let us treat the case where and thus  In this case  we get an exact sequence 0 arrow elta 1  arrow j   m cR  arrow j   m cR  arrow elta arrow0  We get by using Proposition calcfouriereasy and Theorem involForge  Thus  we obtain  Combining all of these  we get et  Phi   0  infty    j   k u alpha    -2  u    1	 quad mbo xif
 - chi -1  cdot sum  x in k    chi  alpha x  cdot psi k x  	 quad mbo xif    On the other hand  let  By using we get  widetild e chi  x    chi  alpha  -1  x 	 quad x in k   subset m cK   
  chi  alpha -1 	 quad x u
 1	 quad x in 1  m fm   note that the image of the geometric Frobenius is different  so we need to calculate with in the notation of   loc   cit     This shows that ar  k u alpha  du   - 1	 quad mbo xif
  chi -1  cdot sum  x in k    chi  alpha x  cdot psi k x  	 quad mbo xif    Thus the theorem follows in this case  We denote by the rank of  By taking the canonical extension  there exists an overconvergent -isocrystal on   regular at    and  We put  By Corollary cor cong Fiso spec we get et -F H   c  m bA  1 setminus 0 1   m sM     -1  cdot q  r  cdot et -F  infty  m sM |  s  infty    ar  M  -du  cdot ar  m sM |   eta 1  -dx|   eta 1    On the other hand  by Proposition Laumondetformula we get 	 et -F H   c  m bA  1 setminus 0 1   m sM     -1  cdot q  r   cdot et -F  infty  m sM |  s  infty   
 	 qquad -1    mma  et  Phi   0  infty    j   M     - mma-1  -u   cdot -1   r  et  Phi   0  infty     j   m sM |   eta 1    -r-1  -u   taking  calcrecipsp  into account  which is applicable because the differential modules are regular of rank  By considering the regular case proven above  we get the theorem  Let be an open subscheme  and be an overconvergent -isocrystal of rank on which is unramified at  Let  Then we get et -F H     mr rig  c  U M    -1  cdot q r cdot et -F   infty  M   infty    prod  s in S  ar  M|   eta s  -dx|   eta s    The proof is exactly the same as using Proposition Laumondetformula and we leave the details to the reader 
Proof of Theorem
 mbo x
 The proof is essentially the same as   it is a reduction to Corollary lastcor  We point out a difference from   loc   cit    to prove that the right hand side of the product formula does not depend on the choice of the differential form we proceed by d  evissage and we use  We leave the details to the reader   clearpage  addcontentslin etoc  section  Index   addcontentslin etoc  section  Bibliography   bibitem AS  AS  	 Abbes  A   Saito  T     Local Fourier transform and 	 epsilon factors   Compositio Math     146   p 1507--1551 	  2010    bibitem Ab1  Abe2  	 Abe  T     Comparison between Swan conductors and 	 characteristic cycles   Compositio Math     146   	 p 638--682  2010    bibitem Ab2  Abe  	 Abe  T     Rings of microdifferential operators for 	 arithmetic -modules   preprint 	 arXiv 1104 1574  18 May 2011  56 pages   bibitem Ab3  Abe3  	 Abe  T     Explicit calculation of Frobenius 	 isomorphisms and Poincaré duality in the theory of 	 arithmetic -modules   preprint 	 arXiv 1105 5796  29 May 2011  54 pages   accepted in Rendiconti del Seminario Matematico di Padova   bibitem Ab4  Abe4  	 Abe  T     Langlands program for -adic coefficients and the petites camarades conjecture   preprint 	 arXiv 1111 2479v1  10 Nov 2011  9 pages   bibitem AC  AbeCaro  Abe  T   Caro  D     Theory of weights in -adic cohomology   preprint arXiv 1303 0662v2  4 Mar 2013  50 pages   bibitem AM  ArMe  	 Arabia  A D   Mebkhout Z     Sur le topos 	 infinit  esimal -adique d un sch  ema lisse I   preprint 	 arXiv 1009 3108  16 Sep 2010  193 pages   bibitem BB  BB  	 Baldassarri  F   Berthelot  P     On Dwork cohomology 	 for singular hypersurfaces   Geometric aspects of Dwork 	 theory  vol   I  p 177--244  Walter de Gruyter  2004    bibitem Be1  BerDw  	 Berthelot  P     Cohomologie rigide et théorie de 	 Dwork   Astérisque   119--120   p 17--49  1984    bibitem Be2  Ber rigD  	 Berthelot  P     Cohomolgie rigide et théorie des 	 -modules   Lecture Notes in Math     1454   	 p 80--124  Springer  1990    bibitem Be3  Berthelot prepub  	 Berthelot  P     Cohomologie rigide et cohomologie 	 rigide à supports propres  Premiére partie 	  version provisoire 1991   Prépublication IRMR 96-03 	  1996    bibitem Be4  Ber1  	 Berthelot  P     -modules arithmétiques 	 I  Opérateurs différentiels de niveau fini   	 Ann   Sci      E cole Norm   Sup   4   e me série  	   29  no 2  p 185--272  1996    bibitem Be5  BePoinc  	 Berthelot  P     Dualit  e de Poincar  e et formule de 	 K  unneth en cohomologie rigide   C  R  Acad   Sc   Paris 	   325   p 493--498  1997    bibitem Be6  Ber2  	 Berthelot  P     -modules arithmétiques 	 II  Descente par Frobenius   Mém   Soc   Math   Fr   	   81   2000    bibitem Be7  BerInt  	 Berthelot  P     Introduction à la théorie 	 arithmétique des -modules   Asterisque   	 279   p 1--80  2002    bibitem BeL  BerL  	 Berthelot  P     Letter to D  Caro   on June 22  	 2007   bibitem Bo  Bou  	 Bourbaki  N     Alg   e bre commutative   Hermann   bibitem BGR  BGR  	 Bosch  S   G   u ntzer  U   Remmert  R   	   Non-Archimedean Analysis   Grundlehren der math   	 Wissenschaften   261   Springer  1984    bibitem Bj  Bjo  	 Bj   o rk  J  E     Analytic -modules and 	 applications   Mathematics and its applications   247   	 Kluwer  1993    bibitem Ca1  Carocoh  	 Caro  D     -modules arithmétiques 	 surcohérents  Application aux fonctions    	 Ann   Inst   Fourier   54   p 1943--1996  2005    bibitem Ca2  Caro courbes  	 Caro  D     Fonctions associées aux 	 -modulles arithmétiques  Cas des courbes   	 Compos   Math     142   p 169--206  2006    bibitem CL  Chiar-LeStum F-iso unipot  	 Chiarellotto  B   Le Stum  B     -isocristaux 	 unipotents   Compositio Math     116   p 81--110 	  1999    bibitem Ch  Ch  	 Christol  G     Syst  emes diff  erentiels lin  eaires 	 -adiques  structure de Frobenius faible   Bull   Soc   	 Math   Fr     109   no 1  83--122  1981    bibitem CM  CM  	 Christol  G   Mebkhout  Z        E quations 	 différentielles -adiques et coefficients -adiques 	 sur les courbes   Astérisque   279   p 125--183 	  2002    bibitem CM4  CM4  	 Christol  G   Mebkhout  Z     Sur le théor   e me 	 de l indice des équations différentielles 	 -adiques IV   Invent   Math     143   p 629--672 	  2001    bibitem Cr1  Crew ens mon  	 Crew  R     -isocrystals and their monodromy groups   Ann   Sci      E cole 	 Norm   Sup   4   e me série    25  no 4  p 429--464 	  1992    bibitem Cr2  Crew ens  	 Crew  R     Finiteness theorems for the cohomology of an 	 overconvergent isocrystal on a curve   Ann   Sci      E cole 	 Norm   Sup   4   e me série    31  no 6  p 717--763 	  1998    bibitem Cr3  Crew irr swan  	 Crew  R     Canonical extensions  irregularities  and 	 the Swan conductor   Math   Ann     316   p 19--37 	  2000    bibitem Cr4  Cr3  	 Crew  R     Arithmetic -modules on a formal 	 curve   Math   Ann     336   no 2  p 439--448  2006    bibitem Cr5  Cr  	 Crew  R   Matsuda  S     Arithmetic -modules on the unit 	 disk  With an appendix by Shigeki Matsuda   	 Compos   Math     148   p 227--268  2012    bibitem De1  Del const loc  	 Deligne  P     Les constantes locales des   equations 	 fonctionnelles des fonctions L   	 Lecture Notes in Math     349   p 501--597  Springer 	  1973    bibitem De2  Del sem  	 Deligne  P    Les constantes des   equations 	 fonctionelles des fonctions    S  eminaire à 	 l I H E S   1980   bibitem De3  WeilII  	 Deligne  P     La conjecture de Weil II   Publ   Math   	 de I H E S    52   p 313--428  1981    bibitem DM  DeligneMilne  	 Deligne  P   Milne  J  S     Tannakian categories   	 Lecture Notes in Math     900   p 101--228  Springer 	  1982    bibitem Dw  Dw  	 Dwork  B     On exponents of -adic differential 	 modules   J  Reine Angew   Math     484   p 85--126 	  1997    bibitem EGA  EGA  	 Grothendieck  A        E léments de 	 géométrie algébrique   Publ   Math   de 	 I H E S   bibitem EL  LE  	 Etesse  J -Y   Le Stum  B     Fonctions 	 associ   e es aux -isocristaux surconvergent 	 I  Interprétation cohomologique   Math   Ann     	 296   p 557--576  1993    bibitem Fo  Fon  	 Fontaine  J  M     Représentations -adiques 	 potentiellement semi-stables   Astérisque   223   	 p 321--347  1994    bibitem Ga1  Gar  		Garnier  L     Théor   e mes de division sur 		 et applications   		Bull   Soc   Math   Fr     123   no 4  p 547--589 		 1995    bibitem Ga2  Gar2  	 Garnier  L     Cohérence sur et 	 irrégularité des isocristaux surconvergents de 	 rang    Forum Math     9   p 569--601   1997    bibitem Ga3  Gar3  	 Garnier  L     Descente par Frobenius explicite pour les 	 -modules   J  Algebra   205   p 542--577 	  1998    bibitem Ka  Katz TravauxLau  		Katz  N     Travaux de Laumon   Sem   Bourb     		691    1988    bibitem Ke1  Kedful  	 Kedlaya  K  S     Full faithfulness for overconvergent 	 F-isocrystals   in Geometric Aspects of Dwork Theory 	  Volume II   de Gruyter  p 819--835  2004    bibitem Ke2  Kedlaya Slope Rev  		Kedlaya  K  S     Slope filtration revisited   		Documenta Math     10   p 447--525  2005    bibitem Ke3  KeDuke  	 Kedlaya  K  S     Finiteness of rigid cohomology with 	 coefficients   Duke Math   J    134   p 15--97  2006    bibitem Ke4  Ke2  	 Kedlaya  K  S     -adic Differential Equations   	 Cambridge Studies in Advanced Mathematics   125   	 Cambridge Univ   Press  2010   		  bibitem La  La  	 Langlands  R     On Artin s L-function   Rice University 	 Studies   56   2   p 23-28  1970    bibitem La1  Lau2  	 Laumon  G     Transformations canoniques et 	 spécialisation pour les D-modules filtrés   	 Asterisque   130   p 56--129  1985    bibitem La2  Lau  		Laumon  G     Transformation de Fourier  constantes 		d   equations fonctionnelles et conjecture de Weil   		Publ   Math   de I H E S    65   p 131--210  1987    bibitem LO  HO  	 Li  H   van Oystaeyen  F     Zariskian Filtrations   	 -Monographs in math     2   Kluwer  1996    bibitem Lo  Lopez Microloc  		Lopez  R G     Microlocalisation and Stationary 		Phase   Asian J  Math     8  No 4  p 747--768 		 2004    bibitem Ma  Malgrange Eq diff  	 Malgrange  B       Equations diff  erentielles   a 	 coefficients polynomiaux   Birkh   a user  1991    bibitem Mr  Marmora Facteurs epsilon  	 Marmora  A     Facteurs epsilon -adiques   	 Compositio Math     144   p 439--483  2008    bibitem Mt1  Mat  	 Matsuda  S     Local indeces of -adic differential 	 operators corresponding to Artin-Schreier-Witt 	 coverings   Duke Math   J    77   no 3  p 607--625 	  1995    bibitem Mt2  Matsuda Katz corr  	 Matsuda  S     Katz Correspondence for quasi-Unipotent 	 Overconvergent Isocrystals   Compositio Math     	 134   p 1--34  2002    bibitem Me  Meb  	 Mebkhout  Z     Analogue -adique du th  eor  eme de 	 Turrittin et le th  eor  eme de la monodromie 	 -adique   Invent   Math     148   p 319--351 	  2002    bibitem MN  MeNa  	 Mebkhout  Z   Narvaez-Macarro  L     Sur les 	 coefficients de de Rham-Grothendieck des vari  et  es 	 alg  ebriques   Lecture Notes in Math     1454  	 p 267--308  1990    bibitem NH0  Huy2  	 Noot-Huyghe  C     Construction et étude de la 	 transformation de Fourier pour les -modules 	 arithmétiques   Doctor thesis  Université de 	 Rennes 1  1995    bibitem NH1  NH  	 Noot-Huyghe  C     Transformation de Fourier des 	 -modules arithmétiques I   Geometric aspects of 	 Dwork theory  vol   II  p 857--907  Walter de Gruyter 	  2004    bibitem Pe  Pet  	 Petrequin  D     Classe de Chern en cohomologie 	 rigide   Bull   Soc   Math   Fr     131   no 1  	 p 59--121  2003    bibitem Pu  Pu  	 Pulita  A     Rank one solvable -adic differential 	 equations and finite Abelian characters via Lubin-Tate 	 groups   Math   Ann     337   p 489--555  2007    bibitem Sa  Sabbah isomono  	 Sabbah  C     D  eformations isomonodromiques et 	 vari  et  es de Frobenius    CNRS Ed    Paris  2002    bibitem Se  Se  		 Serre  J -P     Corps Locaux   deuxi   e me 		 édition  Hermann  Paris  1968    bibitem ST  ST  Schneider  P   Teitelbaum  J     Algebras of -adic distributions and admissible representations   Invent   math     153   p 145--196  2003    bibitem Ti  Ti  	 van Tiel  J     Espaces localement -convexes  II   	 Indag   Math     27   p 259--272  1965    bibitem Ts1  Tsu  	 Tsuzuki  N     Morphisms of -isocrystals and the 	 finite monodromy theorem for unit-root -isocrystals   	 Duke Math   J    111   no 3  p 385--419  2002    bibitem Ts2  Tsuzuki Slope fil  	 Tsuzuki  N     Slope filtration of quasi-unipotent 	 overconvergent -isocrystals   Ann   Inst   Fourier 	   48   p 379--412  1998    bibitem Ts3  Tsuzuki FLM  	 Tsuzuki  N     Finite local monodromy of overconvergent 	 unit-root -isocrystals on a curve   Amer   J  Math   	   120   p 1165--1190  1998    bibitem Vi  Vir  	 Virrion  A     Dualité locale et holonomie pour les 	 -modules arithmétiques   Bull   Soc   Math   	 Fr     128   p 1--68  2000   Tomoyuki Abe 
 Institute for the Physics and Mathematics of the Universe  WPI 
 The University of Tokyo
 5-1-5 Kashiwanoha  Kashiwa  Chiba  277-8583  Japan
 e-mail    tomoyuki abe ipmu jp  skip Adriano Marmora 
 Institut de Recherche Math  ematique Avanc  ee
 UMR 7501  Universit  e de Strasbourg et CNRS
 7 rue Ren  e Descartes  67000 Strasbourg  France
 e-mail    marmora math unistra fr                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  